

============================== 2022-07-13 13:03:11.155597 | 269c09e0-6dde-4616-93cf-30d66a6eccc6 ==============================
13:03:11.155607 [info ] [MainThread]: Running with dbt=1.1.1
13:03:11.155966 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:03:11.156136 [debug] [MainThread]: Tracking: tracking
13:03:11.177449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac04fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abd8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abd8130>]}
13:03:11.281969 [debug] [MainThread]: Executing "git --help"
13:03:12.233745 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:03:12.234564 [debug] [MainThread]: STDERR: "b''"
13:03:12.235358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae69d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aea2730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aea2670>]}


============================== 2022-07-13 13:04:10.288517 | c0d0e7ea-c3ec-41cf-b167-46c1b4176fb4 ==============================
13:04:10.288527 [info ] [MainThread]: Running with dbt=1.1.1
13:04:10.288924 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:04:10.289101 [debug] [MainThread]: Tracking: tracking
13:04:10.308807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e060fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0609a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e060f40>]}
13:04:10.399016 [debug] [MainThread]: Executing "git --help"
13:04:10.408717 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:04:10.409825 [debug] [MainThread]: STDERR: "b''"
13:04:10.422837 [debug] [MainThread]: Acquiring new postgres connection "debug"
13:04:10.423759 [debug] [MainThread]: Using postgres connection "debug"
13:04:10.424038 [debug] [MainThread]: On debug: select 1 as id
13:04:10.424222 [debug] [MainThread]: Opening a new connection, currently in state init
13:04:13.572671 [debug] [MainThread]: SQL status: SELECT 1 in 3.15 seconds
13:04:13.576225 [debug] [MainThread]: On debug: Close
13:04:13.576933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e40c100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e40cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e40c670>]}
13:04:15.189299 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-07-13 13:04:48.239953 | d5c90724-7ee8-4b3e-bd7a-dbfd668079c4 ==============================
13:04:48.240016 [info ] [MainThread]: Running with dbt=1.1.1
13:04:48.240874 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
13:04:48.241076 [debug] [MainThread]: Tracking: tracking
13:04:48.256971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077088e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107708a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107708a30>]}
13:04:48.274808 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
13:04:48.275135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd5c90724-7ee8-4b3e-bd7a-dbfd668079c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078285e0>]}
13:04:48.304338 [debug] [MainThread]: Parsing macros/catalog.sql
13:04:48.309349 [debug] [MainThread]: Parsing macros/relations.sql
13:04:48.310931 [debug] [MainThread]: Parsing macros/adapters.sql
13:04:48.335025 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
13:04:48.336576 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
13:04:48.340782 [debug] [MainThread]: Parsing macros/materializations/configs.sql
13:04:48.343178 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
13:04:48.344954 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
13:04:48.361346 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
13:04:48.374068 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
13:04:48.384463 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
13:04:48.388925 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
13:04:48.390822 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
13:04:48.392584 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
13:04:48.396798 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
13:04:48.413464 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
13:04:48.414933 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
13:04:48.424603 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
13:04:48.439387 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
13:04:48.446700 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
13:04:48.449506 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
13:04:48.456454 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
13:04:48.457823 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
13:04:48.460392 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
13:04:48.462479 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
13:04:48.468119 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
13:04:48.484404 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
13:04:48.485794 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
13:04:48.488310 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
13:04:48.489840 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
13:04:48.490633 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
13:04:48.491452 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
13:04:48.492087 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
13:04:48.493316 [debug] [MainThread]: Parsing macros/etc/statement.sql
13:04:48.497455 [debug] [MainThread]: Parsing macros/etc/datetime.sql
13:04:48.505750 [debug] [MainThread]: Parsing macros/adapters/schema.sql
13:04:48.507983 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
13:04:48.510473 [debug] [MainThread]: Parsing macros/adapters/relation.sql
13:04:48.519493 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
13:04:48.522493 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
13:04:48.526663 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
13:04:48.533753 [debug] [MainThread]: Parsing macros/adapters/columns.sql
13:04:48.543190 [debug] [MainThread]: Parsing tests/generic/builtin.sql
13:04:48.722905 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
13:04:48.734619 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
13:04:48.829051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5c90724-7ee8-4b3e-bd7a-dbfd668079c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107708040>]}
13:04:48.834807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5c90724-7ee8-4b3e-bd7a-dbfd668079c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107828790>]}
13:04:48.835110 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:04:48.835349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5c90724-7ee8-4b3e-bd7a-dbfd668079c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10791df70>]}
13:04:48.836459 [info ] [MainThread]: 
13:04:48.836865 [debug] [MainThread]: Acquiring new postgres connection "master"
13:04:48.837572 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw"
13:04:48.847527 [debug] [ThreadPool]: Using postgres connection "list_rdw"
13:04:48.847731 [debug] [ThreadPool]: On list_rdw: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw"} */

    select distinct nspname from pg_namespace
  
13:04:48.847867 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:04:51.875427 [debug] [ThreadPool]: SQL status: SELECT 84 in 3.03 seconds
13:04:51.877488 [debug] [ThreadPool]: On list_rdw: Close
13:04:51.878277 [debug] [ThreadPool]: Acquiring new postgres connection "create_rdw_dbt_greg"
13:04:51.878576 [debug] [ThreadPool]: Acquiring new postgres connection "create_rdw_dbt_greg"
13:04:51.878786 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='rdw', schema='dbt_greg', identifier=None)"
13:04:51.884354 [debug] [ThreadPool]: Using postgres connection "create_rdw_dbt_greg"
13:04:51.884530 [debug] [ThreadPool]: On create_rdw_dbt_greg: BEGIN
13:04:51.884667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:04:54.886310 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
13:04:54.886679 [debug] [ThreadPool]: Using postgres connection "create_rdw_dbt_greg"
13:04:54.887041 [debug] [ThreadPool]: On create_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_rdw_dbt_greg"} */
create schema if not exists "dbt_greg"
13:04:55.372764 [debug] [ThreadPool]: Postgres adapter: Postgres error: permission denied for database rdw

13:04:55.373442 [debug] [ThreadPool]: On create_rdw_dbt_greg: ROLLBACK
13:04:55.687640 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
13:04:55.687959 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
13:04:55.688344 [debug] [ThreadPool]: On create_rdw_dbt_greg: Close
13:04:55.689735 [debug] [MainThread]: Connection 'master' was properly closed.
13:04:55.689963 [debug] [MainThread]: Connection 'create_rdw_dbt_greg' was properly closed.
13:04:55.690225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077088e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10746ec40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f82e0>]}


============================== 2022-07-13 13:06:38.843527 | 8e6f12c7-a432-47d9-ac49-52dbebe9a387 ==============================
13:06:38.844247 [info ] [MainThread]: Running with dbt=1.1.1
13:06:38.853408 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
13:06:38.853709 [debug] [MainThread]: Tracking: tracking
13:06:38.873104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc4c40>]}
13:06:38.929812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:06:38.930021 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:06:38.936726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e6f12c7-a432-47d9-ac49-52dbebe9a387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb10d0>]}
13:06:38.944724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e6f12c7-a432-47d9-ac49-52dbebe9a387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f8b2e0>]}
13:06:38.945069 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:06:38.945338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e6f12c7-a432-47d9-ac49-52dbebe9a387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f8b370>]}
13:06:38.946819 [info ] [MainThread]: 
13:06:38.947402 [debug] [MainThread]: Acquiring new postgres connection "master"
13:06:38.948224 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw"
13:06:38.958153 [debug] [ThreadPool]: Using postgres connection "list_rdw"
13:06:38.958399 [debug] [ThreadPool]: On list_rdw: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw"} */

    select distinct nspname from pg_namespace
  
13:06:38.958625 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:06:41.973981 [debug] [ThreadPool]: SQL status: SELECT 84 in 3.02 seconds
13:06:41.977344 [debug] [ThreadPool]: On list_rdw: Close
13:06:41.978495 [debug] [ThreadPool]: Acquiring new postgres connection "create_rdw_dbt_greg"
13:06:41.978792 [debug] [ThreadPool]: Acquiring new postgres connection "create_rdw_dbt_greg"
13:06:41.979006 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='rdw', schema='dbt_greg', identifier=None)"
13:06:41.984534 [debug] [ThreadPool]: Using postgres connection "create_rdw_dbt_greg"
13:06:41.984706 [debug] [ThreadPool]: On create_rdw_dbt_greg: BEGIN
13:06:41.984833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:06:45.124675 [debug] [ThreadPool]: SQL status: BEGIN in 3.14 seconds
13:06:45.125054 [debug] [ThreadPool]: Using postgres connection "create_rdw_dbt_greg"
13:06:45.125313 [debug] [ThreadPool]: On create_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_rdw_dbt_greg"} */
create schema if not exists "dbt_greg"
13:06:45.440075 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.31 seconds
13:06:45.441649 [debug] [ThreadPool]: On create_rdw_dbt_greg: COMMIT
13:06:45.442035 [debug] [ThreadPool]: Using postgres connection "create_rdw_dbt_greg"
13:06:45.442410 [debug] [ThreadPool]: On create_rdw_dbt_greg: COMMIT
13:06:45.755865 [debug] [ThreadPool]: SQL status: COMMIT in 0.31 seconds
13:06:45.756254 [debug] [ThreadPool]: On create_rdw_dbt_greg: Close
13:06:45.758148 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw_dbt_greg"
13:06:45.765125 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
13:06:45.765327 [debug] [ThreadPool]: On list_rdw_dbt_greg: BEGIN
13:06:45.765459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:06:48.756457 [debug] [ThreadPool]: SQL status: BEGIN in 2.99 seconds
13:06:48.756807 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
13:06:48.757021 [debug] [ThreadPool]: On list_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw_dbt_greg"} */
select
      'rdw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_greg'
    union all
    select
      'rdw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_greg'
  
13:06:49.075665 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.32 seconds
13:06:49.077443 [debug] [ThreadPool]: On list_rdw_dbt_greg: ROLLBACK
13:06:49.390777 [debug] [ThreadPool]: On list_rdw_dbt_greg: Close
13:06:49.396134 [debug] [MainThread]: Using postgres connection "master"
13:06:49.396347 [debug] [MainThread]: On master: BEGIN
13:06:49.396483 [debug] [MainThread]: Opening a new connection, currently in state init
13:06:52.547838 [debug] [MainThread]: SQL status: BEGIN in 3.15 seconds
13:06:52.548316 [debug] [MainThread]: Using postgres connection "master"
13:06:52.548534 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
13:06:53.481681 [debug] [MainThread]: SQL status: SELECT 1868 in 0.93 seconds
13:06:53.522816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e6f12c7-a432-47d9-ac49-52dbebe9a387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080364f0>]}
13:06:53.523197 [debug] [MainThread]: On master: ROLLBACK
13:06:53.795579 [debug] [MainThread]: Using postgres connection "master"
13:06:53.795862 [debug] [MainThread]: On master: BEGIN
13:06:54.581116 [debug] [MainThread]: SQL status: BEGIN in 0.79 seconds
13:06:54.581471 [debug] [MainThread]: On master: COMMIT
13:06:54.581693 [debug] [MainThread]: Using postgres connection "master"
13:06:54.581894 [debug] [MainThread]: On master: COMMIT
13:06:54.904487 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
13:06:54.905031 [debug] [MainThread]: On master: Close
13:06:54.905804 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
13:06:54.906322 [info ] [MainThread]: 
13:06:54.929505 [debug] [Thread-1  ]: Began running node model.jaffle_shop.my_first_dbt_model
13:06:54.929827 [info ] [Thread-1  ]: 1 of 2 START table model dbt_greg.my_first_dbt_model ........................... [RUN]
13:06:54.930299 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.my_first_dbt_model"
13:06:54.930466 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.my_first_dbt_model
13:06:54.930692 [debug] [Thread-1  ]: Compiling model.jaffle_shop.my_first_dbt_model
13:06:54.933231 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
13:06:54.933986 [debug] [Thread-1  ]: finished collecting timing info
13:06:54.934165 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.my_first_dbt_model
13:06:54.963647 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
13:06:54.964422 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
13:06:54.964562 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: BEGIN
13:06:54.964677 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:06:58.158975 [debug] [Thread-1  ]: SQL status: BEGIN in 3.19 seconds
13:06:58.159445 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
13:06:58.159757 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create  table "rdw"."dbt_greg"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
13:06:58.474219 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.31 seconds
13:06:58.482116 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
13:06:58.482347 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "rdw"."dbt_greg"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
13:06:58.789411 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.31 seconds
13:06:58.802197 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: COMMIT
13:06:58.802400 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
13:06:58.802525 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: COMMIT
13:06:59.104785 [debug] [Thread-1  ]: SQL status: COMMIT in 0.3 seconds
13:06:59.112254 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
13:06:59.112476 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "rdw"."dbt_greg"."my_first_dbt_model__dbt_backup" cascade
13:06:59.576401 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.46 seconds
13:06:59.578203 [debug] [Thread-1  ]: finished collecting timing info
13:06:59.578566 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: Close
13:06:59.579547 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e6f12c7-a432-47d9-ac49-52dbebe9a387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed6610>]}
13:06:59.580025 [info ] [Thread-1  ]: 1 of 2 OK created table model dbt_greg.my_first_dbt_model ...................... [[32mSELECT 2[0m in 4.65s]
13:06:59.580526 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.my_first_dbt_model
13:06:59.581965 [debug] [Thread-3  ]: Began running node model.jaffle_shop.my_second_dbt_model
13:06:59.582322 [info ] [Thread-3  ]: 2 of 2 START view model dbt_greg.my_second_dbt_model ........................... [RUN]
13:06:59.582838 [debug] [Thread-3  ]: Acquiring new postgres connection "model.jaffle_shop.my_second_dbt_model"
13:06:59.583025 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.my_second_dbt_model
13:06:59.583201 [debug] [Thread-3  ]: Compiling model.jaffle_shop.my_second_dbt_model
13:06:59.586502 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
13:06:59.586988 [debug] [Thread-3  ]: finished collecting timing info
13:06:59.587148 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.my_second_dbt_model
13:06:59.645040 [debug] [Thread-3  ]: Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
13:06:59.645729 [debug] [Thread-3  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
13:06:59.645968 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: BEGIN
13:06:59.646106 [debug] [Thread-3  ]: Opening a new connection, currently in state init
13:07:02.671037 [debug] [Thread-3  ]: SQL status: BEGIN in 3.02 seconds
13:07:02.671605 [debug] [Thread-3  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
13:07:02.671846 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "rdw"."dbt_greg"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "rdw"."dbt_greg"."my_first_dbt_model"
where id = 1
  );
13:07:02.987292 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.32 seconds
13:07:02.991068 [debug] [Thread-3  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
13:07:02.991374 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "rdw"."dbt_greg"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
13:07:03.301783 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.31 seconds
13:07:03.303852 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: COMMIT
13:07:03.304050 [debug] [Thread-3  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
13:07:03.304237 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: COMMIT
13:07:03.617188 [debug] [Thread-3  ]: SQL status: COMMIT in 0.31 seconds
13:07:03.619602 [debug] [Thread-3  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
13:07:03.619797 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "rdw"."dbt_greg"."my_second_dbt_model__dbt_backup" cascade
13:07:04.088061 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.47 seconds
13:07:04.089748 [debug] [Thread-3  ]: finished collecting timing info
13:07:04.089968 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: Close
13:07:04.090563 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e6f12c7-a432-47d9-ac49-52dbebe9a387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f7f700>]}
13:07:04.090981 [info ] [Thread-3  ]: 2 of 2 OK created view model dbt_greg.my_second_dbt_model ...................... [[32mCREATE VIEW[0m in 4.51s]
13:07:04.091656 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.my_second_dbt_model
13:07:04.092975 [debug] [MainThread]: Acquiring new postgres connection "master"
13:07:04.093177 [debug] [MainThread]: Using postgres connection "master"
13:07:04.093320 [debug] [MainThread]: On master: BEGIN
13:07:04.093449 [debug] [MainThread]: Opening a new connection, currently in state closed
13:07:07.076545 [debug] [MainThread]: SQL status: BEGIN in 2.98 seconds
13:07:07.076878 [debug] [MainThread]: On master: COMMIT
13:07:07.077098 [debug] [MainThread]: Using postgres connection "master"
13:07:07.077303 [debug] [MainThread]: On master: COMMIT
13:07:07.390628 [debug] [MainThread]: SQL status: COMMIT in 0.31 seconds
13:07:07.390946 [debug] [MainThread]: On master: Close
13:07:07.391648 [info ] [MainThread]: 
13:07:07.391992 [info ] [MainThread]: Finished running 1 table model, 1 view model in 28.44s.
13:07:07.392283 [debug] [MainThread]: Connection 'master' was properly closed.
13:07:07.392444 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
13:07:07.392763 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
13:07:07.397886 [info ] [MainThread]: 
13:07:07.398167 [info ] [MainThread]: [32mCompleted successfully[0m
13:07:07.398432 [info ] [MainThread]: 
13:07:07.398706 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
13:07:07.399005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108102f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed6940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108171a90>]}


============================== 2022-07-26 06:12:47.190005 | 30f053a4-ab97-4b76-8d39-aed849cd8727 ==============================
06:12:47.190017 [info ] [MainThread]: Running with dbt=1.1.1
06:12:47.190811 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
06:12:47.191005 [debug] [MainThread]: Tracking: tracking
06:12:47.214308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fc79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fc7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fc7a00>]}
06:12:47.351863 [debug] [MainThread]: Executing "git --help"
06:12:47.713492 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
06:12:47.714425 [debug] [MainThread]: STDERR: "b''"
06:12:47.725799 [debug] [MainThread]: Acquiring new postgres connection "debug"
06:12:47.726793 [debug] [MainThread]: Using postgres connection "debug"
06:12:47.727089 [debug] [MainThread]: On debug: select 1 as id
06:12:47.727330 [debug] [MainThread]: Opening a new connection, currently in state init
06:12:50.631417 [debug] [MainThread]: SQL status: SELECT 1 in 2.9 seconds
06:12:50.634657 [debug] [MainThread]: On debug: Close
06:12:50.635281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113227310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113227af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113227a30>]}
06:12:52.124506 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-07-26 06:13:17.868380 | 06c2547c-1e0d-4f3a-a611-290ea03430b3 ==============================
06:13:17.868442 [info ] [MainThread]: Running with dbt=1.1.1
06:13:17.869391 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
06:13:17.869610 [debug] [MainThread]: Tracking: tracking
06:13:17.889167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113abd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113abeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113abee0>]}
06:13:17.955171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
06:13:17.955426 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
06:13:17.966791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06c2547c-1e0d-4f3a-a611-290ea03430b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11159a0d0>]}
06:13:17.979898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06c2547c-1e0d-4f3a-a611-290ea03430b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111573580>]}
06:13:17.980393 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
06:13:17.980754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06c2547c-1e0d-4f3a-a611-290ea03430b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111573610>]}
06:13:17.982692 [info ] [MainThread]: 
06:13:17.983257 [debug] [MainThread]: Acquiring new postgres connection "master"
06:13:17.984212 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw"
06:13:17.996560 [debug] [ThreadPool]: Using postgres connection "list_rdw"
06:13:17.996803 [debug] [ThreadPool]: On list_rdw: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw"} */

    select distinct nspname from pg_namespace
  
06:13:17.996972 [debug] [ThreadPool]: Opening a new connection, currently in state init
06:13:21.022690 [debug] [ThreadPool]: SQL status: SELECT 85 in 3.03 seconds
06:13:21.025444 [debug] [ThreadPool]: On list_rdw: Close
06:13:21.026897 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw_dbt_greg"
06:13:21.034392 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
06:13:21.034660 [debug] [ThreadPool]: On list_rdw_dbt_greg: BEGIN
06:13:21.034833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
06:13:24.205791 [debug] [ThreadPool]: SQL status: BEGIN in 3.17 seconds
06:13:24.206334 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
06:13:24.206675 [debug] [ThreadPool]: On list_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw_dbt_greg"} */
select
      'rdw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_greg'
    union all
    select
      'rdw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_greg'
  
06:13:24.527784 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.32 seconds
06:13:24.530031 [debug] [ThreadPool]: On list_rdw_dbt_greg: ROLLBACK
06:13:24.844517 [debug] [ThreadPool]: On list_rdw_dbt_greg: Close
06:13:24.850661 [debug] [MainThread]: Using postgres connection "master"
06:13:24.850930 [debug] [MainThread]: On master: BEGIN
06:13:24.851099 [debug] [MainThread]: Opening a new connection, currently in state init
06:13:28.035258 [debug] [MainThread]: SQL status: BEGIN in 3.18 seconds
06:13:28.035735 [debug] [MainThread]: Using postgres connection "master"
06:13:28.036070 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
06:13:29.015571 [debug] [MainThread]: SQL status: SELECT 1869 in 0.98 seconds
06:13:29.060906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06c2547c-1e0d-4f3a-a611-290ea03430b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113abee0>]}
06:13:29.061331 [debug] [MainThread]: On master: ROLLBACK
06:13:29.331725 [debug] [MainThread]: Using postgres connection "master"
06:13:29.332279 [debug] [MainThread]: On master: BEGIN
06:13:30.128033 [debug] [MainThread]: SQL status: BEGIN in 0.8 seconds
06:13:30.128370 [debug] [MainThread]: On master: COMMIT
06:13:30.128577 [debug] [MainThread]: Using postgres connection "master"
06:13:30.128755 [debug] [MainThread]: On master: COMMIT
06:13:30.444576 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
06:13:30.444980 [debug] [MainThread]: On master: Close
06:13:30.445747 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
06:13:30.446172 [info ] [MainThread]: 
06:13:30.453987 [debug] [Thread-1  ]: Began running node model.jaffle_shop.my_first_dbt_model
06:13:30.454439 [info ] [Thread-1  ]: 1 of 2 START table model dbt_greg.my_first_dbt_model ........................... [RUN]
06:13:30.455102 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.my_first_dbt_model"
06:13:30.455315 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.my_first_dbt_model
06:13:30.455537 [debug] [Thread-1  ]: Compiling model.jaffle_shop.my_first_dbt_model
06:13:30.458709 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
06:13:30.459555 [debug] [Thread-1  ]: finished collecting timing info
06:13:30.459792 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.my_first_dbt_model
06:13:30.497675 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
06:13:30.498473 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
06:13:30.498666 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: BEGIN
06:13:30.498820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
06:13:33.569313 [debug] [Thread-1  ]: SQL status: BEGIN in 3.07 seconds
06:13:33.569843 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
06:13:33.570075 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create  table "rdw"."dbt_greg"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
06:13:33.888583 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.32 seconds
06:13:33.896809 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
06:13:33.897016 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "rdw"."dbt_greg"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
06:13:34.206573 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.31 seconds
06:13:34.210246 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
06:13:34.210448 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "rdw"."dbt_greg"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
06:13:34.523285 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.31 seconds
06:13:34.537737 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: COMMIT
06:13:34.537957 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
06:13:34.538119 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: COMMIT
06:13:34.848072 [debug] [Thread-1  ]: SQL status: COMMIT in 0.31 seconds
06:13:34.854952 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
06:13:34.855146 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "rdw"."dbt_greg"."my_first_dbt_model__dbt_backup" cascade
06:13:35.329505 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.47 seconds
06:13:35.331557 [debug] [Thread-1  ]: finished collecting timing info
06:13:35.331849 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: Close
06:13:35.332638 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06c2547c-1e0d-4f3a-a611-290ea03430b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11162f4c0>]}
06:13:35.333077 [info ] [Thread-1  ]: 1 of 2 OK created table model dbt_greg.my_first_dbt_model ...................... [[32mSELECT 2[0m in 4.88s]
06:13:35.333581 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.my_first_dbt_model
06:13:35.336150 [debug] [Thread-3  ]: Began running node model.jaffle_shop.my_second_dbt_model
06:13:35.336651 [info ] [Thread-3  ]: 2 of 2 START view model dbt_greg.my_second_dbt_model ........................... [RUN]
06:13:35.337259 [debug] [Thread-3  ]: Acquiring new postgres connection "model.jaffle_shop.my_second_dbt_model"
06:13:35.337447 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.my_second_dbt_model
06:13:35.337623 [debug] [Thread-3  ]: Compiling model.jaffle_shop.my_second_dbt_model
06:13:35.341346 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
06:13:35.341975 [debug] [Thread-3  ]: finished collecting timing info
06:13:35.342184 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.my_second_dbt_model
06:13:35.408484 [debug] [Thread-3  ]: Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
06:13:35.409185 [debug] [Thread-3  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
06:13:35.409363 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: BEGIN
06:13:35.409513 [debug] [Thread-3  ]: Opening a new connection, currently in state init
06:13:39.231249 [debug] [Thread-3  ]: SQL status: BEGIN in 3.82 seconds
06:13:39.231755 [debug] [Thread-3  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
06:13:39.232067 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "rdw"."dbt_greg"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "rdw"."dbt_greg"."my_first_dbt_model"
where id = 1
  );
06:13:39.550079 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.32 seconds
06:13:39.553548 [debug] [Thread-3  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
06:13:39.553743 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "rdw"."dbt_greg"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
06:13:39.866956 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.31 seconds
06:13:39.869182 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: COMMIT
06:13:39.869436 [debug] [Thread-3  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
06:13:39.869640 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: COMMIT
06:13:40.184342 [debug] [Thread-3  ]: SQL status: COMMIT in 0.31 seconds
06:13:40.187156 [debug] [Thread-3  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
06:13:40.187408 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "rdw"."dbt_greg"."my_second_dbt_model__dbt_backup" cascade
06:13:40.658327 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.47 seconds
06:13:40.660219 [debug] [Thread-3  ]: finished collecting timing info
06:13:40.660536 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: Close
06:13:40.661280 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06c2547c-1e0d-4f3a-a611-290ea03430b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111702a30>]}
06:13:40.661824 [info ] [Thread-3  ]: 2 of 2 OK created view model dbt_greg.my_second_dbt_model ...................... [[32mCREATE VIEW[0m in 5.32s]
06:13:40.662354 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.my_second_dbt_model
06:13:40.663615 [debug] [MainThread]: Acquiring new postgres connection "master"
06:13:40.663854 [debug] [MainThread]: Using postgres connection "master"
06:13:40.664023 [debug] [MainThread]: On master: BEGIN
06:13:40.664176 [debug] [MainThread]: Opening a new connection, currently in state closed
06:13:43.775786 [debug] [MainThread]: SQL status: BEGIN in 3.11 seconds
06:13:43.776332 [debug] [MainThread]: On master: COMMIT
06:13:43.776692 [debug] [MainThread]: Using postgres connection "master"
06:13:43.776894 [debug] [MainThread]: On master: COMMIT
06:13:44.092254 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
06:13:44.092650 [debug] [MainThread]: On master: Close
06:13:44.093436 [info ] [MainThread]: 
06:13:44.093832 [info ] [MainThread]: Finished running 1 table model, 1 view model in 26.11s.
06:13:44.094173 [debug] [MainThread]: Connection 'master' was properly closed.
06:13:44.094394 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
06:13:44.094583 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
06:13:44.100044 [info ] [MainThread]: 
06:13:44.100344 [info ] [MainThread]: [32mCompleted successfully[0m
06:13:44.100645 [info ] [MainThread]: 
06:13:44.100895 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
06:13:44.101220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111573040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115730a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11157fa60>]}


============================== 2022-07-27 07:21:13.705768 | 93d9ac38-f7fb-4b65-a06d-0874a3c7ebac ==============================
[0m07:21:13.705779 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:21:13.706712 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m07:21:13.706849 [debug] [MainThread]: Tracking: tracking
[0m07:21:13.721764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa7baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa7b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa8c0a0>]}
[0m07:21:13.804963 [debug] [MainThread]: Executing "git --help"
[0m07:21:13.825633 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:21:13.826301 [debug] [MainThread]: STDERR: "b''"
[0m07:21:13.833255 [debug] [MainThread]: Acquiring new postgres connection "debug"
[0m07:21:13.834431 [debug] [MainThread]: Using postgres connection "debug"
[0m07:21:13.834733 [debug] [MainThread]: On debug: select 1 as id
[0m07:21:13.834950 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:21:16.823224 [debug] [MainThread]: SQL status: SELECT 1 in 2.99 seconds
[0m07:21:16.825314 [debug] [MainThread]: On debug: Close
[0m07:21:16.825912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd2c7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd2cf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd2cfa0>]}
[0m07:21:18.190583 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-07-27 07:21:27.586814 | a87c219c-bec5-41d5-8731-b990e3817174 ==============================
[0m07:21:27.586865 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:21:27.587633 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:21:27.587817 [debug] [MainThread]: Tracking: tracking
[0m07:21:27.607179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f6d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f6e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f6eb0>]}
[0m07:21:27.637478 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.1.1. Current version: 1.2.0.
[0m07:21:27.637863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a87c219c-bec5-41d5-8731-b990e3817174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042eba30>]}
[0m07:21:27.678919 [debug] [MainThread]: Parsing macros/catalog.sql
[0m07:21:27.682687 [debug] [MainThread]: Parsing macros/relations.sql
[0m07:21:27.684373 [debug] [MainThread]: Parsing macros/adapters.sql
[0m07:21:27.715724 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m07:21:27.717612 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m07:21:27.718314 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m07:21:27.719858 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m07:21:27.728256 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m07:21:27.729485 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m07:21:27.731050 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m07:21:27.732334 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m07:21:27.737225 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m07:21:27.740024 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m07:21:27.742127 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m07:21:27.763978 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m07:21:27.779884 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m07:21:27.793621 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m07:21:27.799044 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m07:21:27.801190 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m07:21:27.803170 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m07:21:27.808057 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m07:21:27.825548 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m07:21:27.826973 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m07:21:27.836291 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m07:21:27.851247 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m07:21:27.856203 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m07:21:27.859119 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m07:21:27.864735 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m07:21:27.866014 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m07:21:27.869042 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m07:21:27.871203 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m07:21:27.878228 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m07:21:27.895897 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m07:21:27.897321 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m07:21:27.899545 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m07:21:27.900953 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m07:21:27.901743 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m07:21:27.902474 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m07:21:27.903095 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m07:21:27.904312 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m07:21:27.908440 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m07:21:27.916755 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m07:21:27.917605 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m07:21:27.918740 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m07:21:27.919640 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m07:21:27.920510 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m07:21:27.921652 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m07:21:27.922425 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m07:21:27.923514 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m07:21:27.924585 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m07:21:27.926880 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m07:21:27.928334 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m07:21:27.929386 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m07:21:27.930390 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m07:21:27.931366 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m07:21:27.932223 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m07:21:27.933240 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m07:21:27.934188 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m07:21:27.939955 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m07:21:27.941007 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m07:21:27.942925 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m07:21:27.944822 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m07:21:27.945892 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m07:21:27.948023 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m07:21:27.950599 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m07:21:27.964976 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m07:21:27.967700 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m07:21:27.981309 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m07:21:27.985562 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m07:21:27.992432 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m07:21:28.002140 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m07:21:28.282813 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m07:21:28.293235 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m07:21:28.354304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a87c219c-bec5-41d5-8731-b990e3817174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044fa0d0>]}
[0m07:21:28.364974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a87c219c-bec5-41d5-8731-b990e3817174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451fee0>]}
[0m07:21:28.365311 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m07:21:28.365566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a87c219c-bec5-41d5-8731-b990e3817174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104558610>]}
[0m07:21:28.366779 [info ] [MainThread]: 
[0m07:21:28.367230 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:21:28.367985 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw"
[0m07:21:28.378947 [debug] [ThreadPool]: Using postgres connection "list_rdw"
[0m07:21:28.379226 [debug] [ThreadPool]: On list_rdw: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw"} */

    select distinct nspname from pg_namespace
  
[0m07:21:28.379467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:21:31.232051 [debug] [ThreadPool]: SQL status: SELECT 85 in 2.85 seconds
[0m07:21:31.234353 [debug] [ThreadPool]: On list_rdw: Close
[0m07:21:31.235883 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw_dbt_greg"
[0m07:21:31.242559 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m07:21:31.242802 [debug] [ThreadPool]: On list_rdw_dbt_greg: BEGIN
[0m07:21:31.243004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:21:34.614167 [debug] [ThreadPool]: SQL status: BEGIN in 3.37 seconds
[0m07:21:34.614421 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m07:21:34.614574 [debug] [ThreadPool]: On list_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw_dbt_greg"} */
select
      'rdw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_greg'
    union all
    select
      'rdw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_greg'
  
[0m07:21:34.935184 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.32 seconds
[0m07:21:34.936581 [debug] [ThreadPool]: On list_rdw_dbt_greg: ROLLBACK
[0m07:21:35.256833 [debug] [ThreadPool]: On list_rdw_dbt_greg: Close
[0m07:21:35.262386 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:35.262622 [debug] [MainThread]: On master: BEGIN
[0m07:21:35.262765 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:21:38.407003 [debug] [MainThread]: SQL status: BEGIN in 3.14 seconds
[0m07:21:38.407637 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:38.407877 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:21:40.479824 [debug] [MainThread]: SQL status: SELECT 1869 in 2.07 seconds
[0m07:21:40.524862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a87c219c-bec5-41d5-8731-b990e3817174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045100a0>]}
[0m07:21:40.525271 [debug] [MainThread]: On master: ROLLBACK
[0m07:21:40.806882 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:40.807218 [debug] [MainThread]: On master: BEGIN
[0m07:21:41.607002 [debug] [MainThread]: SQL status: BEGIN in 0.8 seconds
[0m07:21:41.607334 [debug] [MainThread]: On master: COMMIT
[0m07:21:41.607492 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:41.607756 [debug] [MainThread]: On master: COMMIT
[0m07:21:41.923048 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m07:21:41.923442 [debug] [MainThread]: On master: Close
[0m07:21:41.924187 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:21:41.924721 [info ] [MainThread]: 
[0m07:21:41.930393 [debug] [Thread-1  ]: Began running node model.jaffle_shop.my_first_dbt_model
[0m07:21:41.930734 [info ] [Thread-1  ]: 1 of 2 START table model dbt_greg.my_first_dbt_model ........................... [RUN]
[0m07:21:41.931219 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m07:21:41.931385 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m07:21:41.931555 [debug] [Thread-1  ]: Compiling model.jaffle_shop.my_first_dbt_model
[0m07:21:41.934274 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m07:21:41.935686 [debug] [Thread-1  ]: finished collecting timing info
[0m07:21:41.935888 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m07:21:41.981315 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m07:21:41.981950 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m07:21:41.982115 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m07:21:41.982249 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:21:45.057003 [debug] [Thread-1  ]: SQL status: BEGIN in 3.07 seconds
[0m07:21:45.057453 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m07:21:45.057791 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create  table "rdw"."dbt_greg"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m07:21:45.226257 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.17 seconds
[0m07:21:45.235270 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m07:21:45.235510 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "rdw"."dbt_greg"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m07:21:45.557030 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.32 seconds
[0m07:21:45.561690 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m07:21:45.561974 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "rdw"."dbt_greg"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m07:21:45.873800 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.31 seconds
[0m07:21:45.903048 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m07:21:45.903286 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m07:21:45.903430 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m07:21:46.207166 [debug] [Thread-1  ]: SQL status: COMMIT in 0.3 seconds
[0m07:21:46.215675 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m07:21:46.215931 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "rdw"."dbt_greg"."my_first_dbt_model__dbt_backup" cascade
[0m07:21:46.682677 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.47 seconds
[0m07:21:46.684004 [debug] [Thread-1  ]: finished collecting timing info
[0m07:21:46.684203 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: Close
[0m07:21:46.684748 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a87c219c-bec5-41d5-8731-b990e3817174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046baa30>]}
[0m07:21:46.685115 [info ] [Thread-1  ]: 1 of 2 OK created table model dbt_greg.my_first_dbt_model ...................... [[32mSELECT 2[0m in 4.75s]
[0m07:21:46.685529 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m07:21:46.686059 [debug] [Thread-3  ]: Began running node model.jaffle_shop.my_second_dbt_model
[0m07:21:46.686448 [info ] [Thread-3  ]: 2 of 2 START view model dbt_greg.my_second_dbt_model ........................... [RUN]
[0m07:21:46.686919 [debug] [Thread-3  ]: Acquiring new postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m07:21:46.687078 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m07:21:46.687228 [debug] [Thread-3  ]: Compiling model.jaffle_shop.my_second_dbt_model
[0m07:21:46.689914 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m07:21:46.690468 [debug] [Thread-3  ]: finished collecting timing info
[0m07:21:46.690648 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m07:21:46.715763 [debug] [Thread-3  ]: Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m07:21:46.716519 [debug] [Thread-3  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m07:21:46.716795 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m07:21:46.716962 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:21:50.064639 [debug] [Thread-3  ]: SQL status: BEGIN in 3.35 seconds
[0m07:21:50.064910 [debug] [Thread-3  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m07:21:50.065067 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "rdw"."dbt_greg"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "rdw"."dbt_greg"."my_first_dbt_model"
where id = 1
  );
[0m07:21:50.382879 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.32 seconds
[0m07:21:50.385839 [debug] [Thread-3  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m07:21:50.386120 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "rdw"."dbt_greg"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m07:21:50.707059 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.32 seconds
[0m07:21:50.708962 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m07:21:50.709157 [debug] [Thread-3  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m07:21:50.709309 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m07:21:51.036643 [debug] [Thread-3  ]: SQL status: COMMIT in 0.33 seconds
[0m07:21:51.039452 [debug] [Thread-3  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m07:21:51.039690 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "rdw"."dbt_greg"."my_second_dbt_model__dbt_backup" cascade
[0m07:21:51.510377 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.47 seconds
[0m07:21:51.512662 [debug] [Thread-3  ]: finished collecting timing info
[0m07:21:51.513061 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: Close
[0m07:21:51.513707 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a87c219c-bec5-41d5-8731-b990e3817174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046cd5b0>]}
[0m07:21:51.514230 [info ] [Thread-3  ]: 2 of 2 OK created view model dbt_greg.my_second_dbt_model ...................... [[32mCREATE VIEW[0m in 4.83s]
[0m07:21:51.514741 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m07:21:51.515837 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:21:51.516044 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:51.516191 [debug] [MainThread]: On master: BEGIN
[0m07:21:51.516326 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:21:54.507143 [debug] [MainThread]: SQL status: BEGIN in 2.99 seconds
[0m07:21:54.507455 [debug] [MainThread]: On master: COMMIT
[0m07:21:54.507611 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:54.507741 [debug] [MainThread]: On master: COMMIT
[0m07:21:54.824709 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m07:21:54.825054 [debug] [MainThread]: On master: Close
[0m07:21:54.825583 [info ] [MainThread]: 
[0m07:21:54.825829 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 26.46 seconds (26.46s).
[0m07:21:54.826048 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:21:54.826170 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m07:21:54.826338 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m07:21:54.833264 [info ] [MainThread]: 
[0m07:21:54.833557 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:21:54.833821 [info ] [MainThread]: 
[0m07:21:54.834141 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:21:54.834516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045108e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b62e0>]}


============================== 2022-07-27 09:25:07.529765 | 7c5dce4d-7cd4-4690-a174-e4c609a0d583 ==============================
[0m09:25:07.529822 [info ] [MainThread]: Running with dbt=1.2.0
[0m09:25:07.531195 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:25:07.531434 [debug] [MainThread]: Tracking: tracking
[0m09:25:07.559264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9fae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9fa2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9fafd0>]}
[0m09:25:07.637011 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 1 files added, 0 files changed.
[0m09:25:07.637409 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customers.sql
[0m09:25:07.637656 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/example/my_second_dbt_model.sql
[0m09:25:07.637826 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/example/my_first_dbt_model.sql
[0m09:25:07.655766 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m09:25:07.674705 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example

[0m09:25:07.680539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c5dce4d-7cd4-4690-a174-e4c609a0d583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db8f0d0>]}
[0m09:25:07.689567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c5dce4d-7cd4-4690-a174-e4c609a0d583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db33e20>]}
[0m09:25:07.689907 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:25:07.690196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c5dce4d-7cd4-4690-a174-e4c609a0d583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8de250>]}
[0m09:25:07.691478 [info ] [MainThread]: 
[0m09:25:07.691949 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:25:07.692657 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw"
[0m09:25:07.704104 [debug] [ThreadPool]: Using postgres connection "list_rdw"
[0m09:25:07.704337 [debug] [ThreadPool]: On list_rdw: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw"} */

    select distinct nspname from pg_namespace
  
[0m09:25:07.704489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:25:10.763769 [debug] [ThreadPool]: SQL status: SELECT 85 in 3.06 seconds
[0m09:25:10.766090 [debug] [ThreadPool]: On list_rdw: Close
[0m09:25:10.767432 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw_dbt_greg"
[0m09:25:10.773871 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m09:25:10.774055 [debug] [ThreadPool]: On list_rdw_dbt_greg: BEGIN
[0m09:25:10.774195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:25:13.913804 [debug] [ThreadPool]: SQL status: BEGIN in 3.14 seconds
[0m09:25:13.914268 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m09:25:13.914501 [debug] [ThreadPool]: On list_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw_dbt_greg"} */
select
      'rdw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_greg'
    union all
    select
      'rdw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_greg'
  
[0m09:25:14.083802 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.17 seconds
[0m09:25:14.085648 [debug] [ThreadPool]: On list_rdw_dbt_greg: ROLLBACK
[0m09:25:14.413899 [debug] [ThreadPool]: On list_rdw_dbt_greg: Close
[0m09:25:14.420483 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:14.420720 [debug] [MainThread]: On master: BEGIN
[0m09:25:14.420893 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:25:17.763871 [debug] [MainThread]: SQL status: BEGIN in 3.34 seconds
[0m09:25:17.764209 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:17.764388 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:25:18.872505 [debug] [MainThread]: SQL status: SELECT 1869 in 1.11 seconds
[0m09:25:18.945535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c5dce4d-7cd4-4690-a174-e4c609a0d583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d87cdf0>]}
[0m09:25:18.945898 [debug] [MainThread]: On master: ROLLBACK
[0m09:25:19.188937 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:19.189460 [debug] [MainThread]: On master: BEGIN
[0m09:25:19.987771 [debug] [MainThread]: SQL status: BEGIN in 0.8 seconds
[0m09:25:19.988176 [debug] [MainThread]: On master: COMMIT
[0m09:25:19.988444 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:19.988671 [debug] [MainThread]: On master: COMMIT
[0m09:25:20.314080 [debug] [MainThread]: SQL status: COMMIT in 0.33 seconds
[0m09:25:20.314477 [debug] [MainThread]: On master: Close
[0m09:25:20.315219 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:25:20.315621 [info ] [MainThread]: 
[0m09:25:20.321601 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m09:25:20.321983 [info ] [Thread-1  ]: 1 of 1 START view model dbt_greg.customers ..................................... [RUN]
[0m09:25:20.322549 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.customers"
[0m09:25:20.322749 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m09:25:20.322944 [debug] [Thread-1  ]: Compiling model.jaffle_shop.customers
[0m09:25:20.324654 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m09:25:20.325137 [debug] [Thread-1  ]: finished collecting timing info
[0m09:25:20.325332 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m09:25:20.370256 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.customers"
[0m09:25:20.370854 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:25:20.371016 [debug] [Thread-1  ]: On model.jaffle_shop.customers: BEGIN
[0m09:25:20.371167 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:25:23.514429 [debug] [Thread-1  ]: SQL status: BEGIN in 3.14 seconds
[0m09:25:23.514991 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:25:23.515234 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "rdw"."dbt_greg"."customers__dbt_tmp" as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from dbt.jaffle_shop_customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from dbt.jaffle_shop_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m09:25:23.835703 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.32 seconds
[0m09:25:23.845103 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:25:23.845333 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "rdw"."dbt_greg"."customers__dbt_tmp" rename to "customers"
[0m09:25:24.164103 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.32 seconds
[0m09:25:24.188030 [debug] [Thread-1  ]: On model.jaffle_shop.customers: COMMIT
[0m09:25:24.188264 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:25:24.188413 [debug] [Thread-1  ]: On model.jaffle_shop.customers: COMMIT
[0m09:25:24.480716 [debug] [Thread-1  ]: SQL status: COMMIT in 0.29 seconds
[0m09:25:24.487499 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:25:24.487704 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop view if exists "rdw"."dbt_greg"."customers__dbt_backup" cascade
[0m09:25:24.964305 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.48 seconds
[0m09:25:24.966531 [debug] [Thread-1  ]: finished collecting timing info
[0m09:25:24.966833 [debug] [Thread-1  ]: On model.jaffle_shop.customers: Close
[0m09:25:24.967651 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c5dce4d-7cd4-4690-a174-e4c609a0d583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db7bf10>]}
[0m09:25:24.968069 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_greg.customers ................................ [[32mCREATE VIEW[0m in 4.65s]
[0m09:25:24.968549 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m09:25:24.969888 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:25:24.970122 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:24.970293 [debug] [MainThread]: On master: BEGIN
[0m09:25:24.970452 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:25:28.337970 [debug] [MainThread]: SQL status: BEGIN in 3.37 seconds
[0m09:25:28.338540 [debug] [MainThread]: On master: COMMIT
[0m09:25:28.338789 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:28.339001 [debug] [MainThread]: On master: COMMIT
[0m09:25:28.664435 [debug] [MainThread]: SQL status: COMMIT in 0.33 seconds
[0m09:25:28.665019 [debug] [MainThread]: On master: Close
[0m09:25:28.665908 [info ] [MainThread]: 
[0m09:25:28.666330 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 20.97 seconds (20.97s).
[0m09:25:28.666735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:25:28.666922 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m09:25:28.675321 [info ] [MainThread]: 
[0m09:25:28.675683 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:25:28.676014 [info ] [MainThread]: 
[0m09:25:28.676261 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:25:28.676593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8d3040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d887880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8cbd90>]}


============================== 2022-07-27 09:28:41.456401 | d223a38d-3c2e-43cc-a502-a9fc9af5847e ==============================
[0m09:28:41.456483 [info ] [MainThread]: Running with dbt=1.2.0
[0m09:28:41.458123 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:28:41.458361 [debug] [MainThread]: Tracking: tracking
[0m09:28:41.478567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135f1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135e6760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135e68b0>]}
[0m09:28:41.508584 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:28:41.509040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd223a38d-3c2e-43cc-a502-a9fc9af5847e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11360d730>]}
[0m09:28:41.542214 [debug] [MainThread]: Parsing macros/catalog.sql
[0m09:28:41.545997 [debug] [MainThread]: Parsing macros/relations.sql
[0m09:28:41.547528 [debug] [MainThread]: Parsing macros/adapters.sql
[0m09:28:41.576215 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m09:28:41.577827 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m09:28:41.578439 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m09:28:41.579764 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m09:28:41.585920 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m09:28:41.586356 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m09:28:41.587475 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m09:28:41.588521 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m09:28:41.592415 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m09:28:41.594548 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m09:28:41.596035 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m09:28:41.611445 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m09:28:41.623324 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m09:28:41.634199 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m09:28:41.638193 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m09:28:41.639754 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m09:28:41.641357 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m09:28:41.645309 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m09:28:41.660418 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m09:28:41.661758 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m09:28:41.670340 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m09:28:41.687040 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m09:28:41.693152 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m09:28:41.696333 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m09:28:41.701743 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m09:28:41.702940 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m09:28:41.706197 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m09:28:41.708312 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m09:28:41.714665 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m09:28:41.731551 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m09:28:41.732924 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m09:28:41.735186 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m09:28:41.736574 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m09:28:41.737458 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m09:28:41.738225 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m09:28:41.738837 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m09:28:41.740292 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m09:28:41.744174 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m09:28:41.752008 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m09:28:41.752750 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m09:28:41.753826 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m09:28:41.754780 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m09:28:41.755623 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m09:28:41.756725 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m09:28:41.757460 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m09:28:41.758440 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m09:28:41.759414 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m09:28:41.761568 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m09:28:41.762666 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m09:28:41.763639 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m09:28:41.764680 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m09:28:41.765615 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m09:28:41.766445 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m09:28:41.767401 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m09:28:41.768222 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m09:28:41.773607 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m09:28:41.774460 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m09:28:41.776084 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m09:28:41.777932 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m09:28:41.778885 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m09:28:41.781128 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m09:28:41.783477 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m09:28:41.796517 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m09:28:41.799166 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m09:28:41.811755 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m09:28:41.815789 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m09:28:41.822164 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m09:28:41.830953 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m09:28:42.090565 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m09:28:42.121392 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example

[0m09:28:42.125577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd223a38d-3c2e-43cc-a502-a9fc9af5847e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11362e0d0>]}
[0m09:28:42.130870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd223a38d-3c2e-43cc-a502-a9fc9af5847e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134a26a0>]}
[0m09:28:42.131131 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:28:42.131333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd223a38d-3c2e-43cc-a502-a9fc9af5847e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11361c610>]}
[0m09:28:42.132462 [info ] [MainThread]: 
[0m09:28:42.132837 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:28:42.133369 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw"
[0m09:28:42.142245 [debug] [ThreadPool]: Using postgres connection "list_rdw"
[0m09:28:42.142482 [debug] [ThreadPool]: On list_rdw: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw"} */

    select distinct nspname from pg_namespace
  
[0m09:28:42.142642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:45.356266 [debug] [ThreadPool]: SQL status: SELECT 85 in 3.21 seconds
[0m09:28:45.359371 [debug] [ThreadPool]: On list_rdw: Close
[0m09:28:45.361085 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw_dbt_greg"
[0m09:28:45.367582 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m09:28:45.367760 [debug] [ThreadPool]: On list_rdw_dbt_greg: BEGIN
[0m09:28:45.367904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:48.344763 [debug] [ThreadPool]: SQL status: BEGIN in 2.98 seconds
[0m09:28:48.345159 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m09:28:48.345367 [debug] [ThreadPool]: On list_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw_dbt_greg"} */
select
      'rdw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_greg'
    union all
    select
      'rdw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_greg'
  
[0m09:28:48.668869 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.32 seconds
[0m09:28:48.670947 [debug] [ThreadPool]: On list_rdw_dbt_greg: ROLLBACK
[0m09:28:48.986216 [debug] [ThreadPool]: On list_rdw_dbt_greg: Close
[0m09:28:48.993459 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:48.993733 [debug] [MainThread]: On master: BEGIN
[0m09:28:48.993912 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:28:52.007355 [debug] [MainThread]: SQL status: BEGIN in 3.01 seconds
[0m09:28:52.007988 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:52.008285 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:28:53.153899 [debug] [MainThread]: SQL status: SELECT 1871 in 1.15 seconds
[0m09:28:53.195832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd223a38d-3c2e-43cc-a502-a9fc9af5847e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113689880>]}
[0m09:28:53.196221 [debug] [MainThread]: On master: ROLLBACK
[0m09:28:53.467601 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:53.467966 [debug] [MainThread]: On master: BEGIN
[0m09:28:54.260618 [debug] [MainThread]: SQL status: BEGIN in 0.79 seconds
[0m09:28:54.261180 [debug] [MainThread]: On master: COMMIT
[0m09:28:54.261446 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:54.261658 [debug] [MainThread]: On master: COMMIT
[0m09:28:54.580693 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m09:28:54.581288 [debug] [MainThread]: On master: Close
[0m09:28:54.582133 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:28:54.582546 [info ] [MainThread]: 
[0m09:28:54.589719 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m09:28:54.590157 [info ] [Thread-1  ]: 1 of 1 START table model dbt_greg.customers .................................... [RUN]
[0m09:28:54.590736 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.customers"
[0m09:28:54.590971 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m09:28:54.591191 [debug] [Thread-1  ]: Compiling model.jaffle_shop.customers
[0m09:28:54.592970 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m09:28:54.593623 [debug] [Thread-1  ]: finished collecting timing info
[0m09:28:54.593903 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m09:28:54.637502 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.customers"
[0m09:28:54.638058 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:28:54.638208 [debug] [Thread-1  ]: On model.jaffle_shop.customers: BEGIN
[0m09:28:54.638334 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:28:57.752262 [debug] [Thread-1  ]: SQL status: BEGIN in 3.11 seconds
[0m09:28:57.752792 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:28:57.753123 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create  table "rdw"."dbt_greg"."customers__dbt_tmp"
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from dbt.jaffle_shop_customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from dbt.jaffle_shop_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m09:28:58.074872 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.32 seconds
[0m09:28:58.083499 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:28:58.083725 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "rdw"."dbt_greg"."customers" rename to "customers__dbt_backup"
[0m09:28:58.394363 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.31 seconds
[0m09:28:58.398186 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:28:58.398395 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "rdw"."dbt_greg"."customers__dbt_tmp" rename to "customers"
[0m09:28:58.710612 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.31 seconds
[0m09:28:58.737798 [debug] [Thread-1  ]: On model.jaffle_shop.customers: COMMIT
[0m09:28:58.738032 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:28:58.738180 [debug] [Thread-1  ]: On model.jaffle_shop.customers: COMMIT
[0m09:28:59.030112 [debug] [Thread-1  ]: SQL status: COMMIT in 0.29 seconds
[0m09:28:59.037214 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:28:59.037405 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop view if exists "rdw"."dbt_greg"."customers__dbt_backup" cascade
[0m09:28:59.349086 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.31 seconds
[0m09:28:59.351351 [debug] [Thread-1  ]: finished collecting timing info
[0m09:28:59.351651 [debug] [Thread-1  ]: On model.jaffle_shop.customers: Close
[0m09:28:59.352477 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd223a38d-3c2e-43cc-a502-a9fc9af5847e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113905880>]}
[0m09:28:59.352921 [info ] [Thread-1  ]: 1 of 1 OK created table model dbt_greg.customers ............................... [[32mSELECT 100[0m in 4.76s]
[0m09:28:59.353414 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m09:28:59.355948 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:28:59.356257 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:59.356433 [debug] [MainThread]: On master: BEGIN
[0m09:28:59.356593 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:29:02.681711 [debug] [MainThread]: SQL status: BEGIN in 3.33 seconds
[0m09:29:02.682183 [debug] [MainThread]: On master: COMMIT
[0m09:29:02.682597 [debug] [MainThread]: Using postgres connection "master"
[0m09:29:02.682886 [debug] [MainThread]: On master: COMMIT
[0m09:29:02.999302 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m09:29:02.999702 [debug] [MainThread]: On master: Close
[0m09:29:03.000497 [info ] [MainThread]: 
[0m09:29:03.000856 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 20.87 seconds (20.87s).
[0m09:29:03.001151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:29:03.001310 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m09:29:03.008932 [info ] [MainThread]: 
[0m09:29:03.009253 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:29:03.009558 [info ] [MainThread]: 
[0m09:29:03.009801 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:29:03.010204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113485fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113828700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113828640>]}


============================== 2022-07-27 09:32:52.841753 | 67b81559-dee1-4516-996f-ff6be56f56df ==============================
[0m09:32:52.841828 [info ] [MainThread]: Running with dbt=1.2.0
[0m09:32:52.843288 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:32:52.843595 [debug] [MainThread]: Tracking: tracking
[0m09:32:52.869369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bac4df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bac4f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bac4f40>]}
[0m09:32:52.939556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:32:52.940178 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/customers.sql
[0m09:32:52.957940 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m09:32:52.977617 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example

[0m09:32:52.983711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67b81559-dee1-4516-996f-ff6be56f56df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc650d0>]}
[0m09:32:52.991480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67b81559-dee1-4516-996f-ff6be56f56df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbc2790>]}
[0m09:32:52.991861 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:32:52.992162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67b81559-dee1-4516-996f-ff6be56f56df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbd3cd0>]}
[0m09:32:52.993521 [info ] [MainThread]: 
[0m09:32:52.994231 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:32:52.995077 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw"
[0m09:32:53.006930 [debug] [ThreadPool]: Using postgres connection "list_rdw"
[0m09:32:53.007163 [debug] [ThreadPool]: On list_rdw: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw"} */

    select distinct nspname from pg_namespace
  
[0m09:32:53.007323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:32:56.027741 [debug] [ThreadPool]: SQL status: SELECT 85 in 3.02 seconds
[0m09:32:56.030529 [debug] [ThreadPool]: On list_rdw: Close
[0m09:32:56.032360 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw_dbt_greg"
[0m09:32:56.039028 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m09:32:56.039257 [debug] [ThreadPool]: On list_rdw_dbt_greg: BEGIN
[0m09:32:56.039413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:32:59.142667 [debug] [ThreadPool]: SQL status: BEGIN in 3.1 seconds
[0m09:32:59.142942 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m09:32:59.143109 [debug] [ThreadPool]: On list_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw_dbt_greg"} */
select
      'rdw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_greg'
    union all
    select
      'rdw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_greg'
  
[0m09:32:59.470857 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.33 seconds
[0m09:32:59.473234 [debug] [ThreadPool]: On list_rdw_dbt_greg: ROLLBACK
[0m09:32:59.787173 [debug] [ThreadPool]: On list_rdw_dbt_greg: Close
[0m09:32:59.793568 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:59.793811 [debug] [MainThread]: On master: BEGIN
[0m09:32:59.793982 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:33:02.803162 [debug] [MainThread]: SQL status: BEGIN in 3.01 seconds
[0m09:33:02.803388 [debug] [MainThread]: Using postgres connection "master"
[0m09:33:02.803514 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:33:03.792712 [debug] [MainThread]: SQL status: SELECT 1869 in 0.99 seconds
[0m09:33:03.870290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67b81559-dee1-4516-996f-ff6be56f56df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc74f10>]}
[0m09:33:03.870664 [debug] [MainThread]: On master: ROLLBACK
[0m09:33:04.108295 [debug] [MainThread]: Using postgres connection "master"
[0m09:33:04.108603 [debug] [MainThread]: On master: BEGIN
[0m09:33:04.898399 [debug] [MainThread]: SQL status: BEGIN in 0.79 seconds
[0m09:33:04.898787 [debug] [MainThread]: On master: COMMIT
[0m09:33:04.899034 [debug] [MainThread]: Using postgres connection "master"
[0m09:33:04.899243 [debug] [MainThread]: On master: COMMIT
[0m09:33:05.214771 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m09:33:05.215390 [debug] [MainThread]: On master: Close
[0m09:33:05.216172 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:33:05.216579 [info ] [MainThread]: 
[0m09:33:05.224153 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m09:33:05.224567 [info ] [Thread-1  ]: 1 of 1 START view model dbt_greg.customers ..................................... [RUN]
[0m09:33:05.225146 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.customers"
[0m09:33:05.225337 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m09:33:05.225506 [debug] [Thread-1  ]: Compiling model.jaffle_shop.customers
[0m09:33:05.228343 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m09:33:05.229262 [debug] [Thread-1  ]: finished collecting timing info
[0m09:33:05.229473 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m09:33:05.273222 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.customers"
[0m09:33:05.273836 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:33:05.273998 [debug] [Thread-1  ]: On model.jaffle_shop.customers: BEGIN
[0m09:33:05.274129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:33:08.393818 [debug] [Thread-1  ]: SQL status: BEGIN in 3.12 seconds
[0m09:33:08.394421 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:33:08.394578 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "rdw"."dbt_greg"."customers__dbt_tmp" as (
    

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from dbt.jaffle_shop_customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from dbt.jaffle_shop_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m09:33:08.557671 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.16 seconds
[0m09:33:08.563465 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:33:08.563654 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "rdw"."dbt_greg"."customers" rename to "customers__dbt_backup"
[0m09:33:08.875498 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.31 seconds
[0m09:33:08.880320 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:33:08.880528 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "rdw"."dbt_greg"."customers__dbt_tmp" rename to "customers"
[0m09:33:09.192682 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.31 seconds
[0m09:33:09.215325 [debug] [Thread-1  ]: On model.jaffle_shop.customers: COMMIT
[0m09:33:09.215559 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:33:09.215706 [debug] [Thread-1  ]: On model.jaffle_shop.customers: COMMIT
[0m09:33:09.511979 [debug] [Thread-1  ]: SQL status: COMMIT in 0.3 seconds
[0m09:33:09.519207 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:33:09.519396 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop table if exists "rdw"."dbt_greg"."customers__dbt_backup" cascade
[0m09:33:09.831209 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.31 seconds
[0m09:33:09.833329 [debug] [Thread-1  ]: finished collecting timing info
[0m09:33:09.833613 [debug] [Thread-1  ]: On model.jaffle_shop.customers: Close
[0m09:33:09.834389 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67b81559-dee1-4516-996f-ff6be56f56df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc37b80>]}
[0m09:33:09.834810 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_greg.customers ................................ [[32mCREATE VIEW[0m in 4.61s]
[0m09:33:09.835294 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m09:33:09.837472 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:33:09.837716 [debug] [MainThread]: Using postgres connection "master"
[0m09:33:09.837887 [debug] [MainThread]: On master: BEGIN
[0m09:33:09.838044 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:33:13.113835 [debug] [MainThread]: SQL status: BEGIN in 3.28 seconds
[0m09:33:13.114400 [debug] [MainThread]: On master: COMMIT
[0m09:33:13.114752 [debug] [MainThread]: Using postgres connection "master"
[0m09:33:13.114960 [debug] [MainThread]: On master: COMMIT
[0m09:33:13.433249 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m09:33:13.433517 [debug] [MainThread]: On master: Close
[0m09:33:13.434009 [info ] [MainThread]: 
[0m09:33:13.434253 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 20.44 seconds (20.44s).
[0m09:33:13.434471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:33:13.434589 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m09:33:13.440181 [info ] [MainThread]: 
[0m09:33:13.440457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:33:13.440765 [info ] [MainThread]: 
[0m09:33:13.440981 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:33:13.441283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc7d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc7d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b98aaf0>]}


============================== 2022-07-27 09:33:43.293184 | 4e235afc-fa21-4a75-b289-9ab01623c3a5 ==============================
[0m09:33:43.293255 [info ] [MainThread]: Running with dbt=1.2.0
[0m09:33:43.294215 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:33:43.294422 [debug] [MainThread]: Tracking: tracking
[0m09:33:43.327849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f0ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f0c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f0cfd0>]}
[0m09:33:43.392283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:33:43.392559 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:33:43.392933 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example

[0m09:33:43.400412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e235afc-fa21-4a75-b289-9ab01623c3a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0430d0>]}
[0m09:33:43.407408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e235afc-fa21-4a75-b289-9ab01623c3a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fa8730>]}
[0m09:33:43.407780 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:33:43.408064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e235afc-fa21-4a75-b289-9ab01623c3a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a010d30>]}
[0m09:33:43.409404 [info ] [MainThread]: 
[0m09:33:43.409919 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:33:43.410697 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw"
[0m09:33:43.422326 [debug] [ThreadPool]: Using postgres connection "list_rdw"
[0m09:33:43.422581 [debug] [ThreadPool]: On list_rdw: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw"} */

    select distinct nspname from pg_namespace
  
[0m09:33:43.422743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:33:46.252249 [debug] [ThreadPool]: SQL status: SELECT 85 in 2.83 seconds
[0m09:33:46.254372 [debug] [ThreadPool]: On list_rdw: Close
[0m09:33:46.255541 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw_dbt_greg"
[0m09:33:46.262275 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m09:33:46.262482 [debug] [ThreadPool]: On list_rdw_dbt_greg: BEGIN
[0m09:33:46.262631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:33:49.390924 [debug] [ThreadPool]: SQL status: BEGIN in 3.13 seconds
[0m09:33:49.391304 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m09:33:49.391567 [debug] [ThreadPool]: On list_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw_dbt_greg"} */
select
      'rdw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_greg'
    union all
    select
      'rdw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_greg'
  
[0m09:33:49.711014 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.32 seconds
[0m09:33:49.713004 [debug] [ThreadPool]: On list_rdw_dbt_greg: ROLLBACK
[0m09:33:50.026864 [debug] [ThreadPool]: On list_rdw_dbt_greg: Close
[0m09:33:50.031678 [debug] [MainThread]: Using postgres connection "master"
[0m09:33:50.031894 [debug] [MainThread]: On master: BEGIN
[0m09:33:50.032025 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:33:53.215298 [debug] [MainThread]: SQL status: BEGIN in 3.18 seconds
[0m09:33:53.215618 [debug] [MainThread]: Using postgres connection "master"
[0m09:33:53.215832 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:33:54.822451 [debug] [MainThread]: SQL status: SELECT 1871 in 1.61 seconds
[0m09:33:54.865863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e235afc-fa21-4a75-b289-9ab01623c3a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0c3f10>]}
[0m09:33:54.866256 [debug] [MainThread]: On master: ROLLBACK
[0m09:33:55.139017 [debug] [MainThread]: Using postgres connection "master"
[0m09:33:55.139323 [debug] [MainThread]: On master: BEGIN
[0m09:33:55.929745 [debug] [MainThread]: SQL status: BEGIN in 0.79 seconds
[0m09:33:55.930343 [debug] [MainThread]: On master: COMMIT
[0m09:33:55.930701 [debug] [MainThread]: Using postgres connection "master"
[0m09:33:55.930926 [debug] [MainThread]: On master: COMMIT
[0m09:33:56.247617 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m09:33:56.248017 [debug] [MainThread]: On master: Close
[0m09:33:56.248727 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:33:56.249055 [info ] [MainThread]: 
[0m09:33:56.254636 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m09:33:56.255022 [info ] [Thread-1  ]: 1 of 1 START view model dbt_greg.customers ..................................... [RUN]
[0m09:33:56.255599 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.customers"
[0m09:33:56.255778 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m09:33:56.255957 [debug] [Thread-1  ]: Compiling model.jaffle_shop.customers
[0m09:33:56.258917 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m09:33:56.259420 [debug] [Thread-1  ]: finished collecting timing info
[0m09:33:56.259612 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m09:33:56.348340 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.customers"
[0m09:33:56.348967 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:33:56.349137 [debug] [Thread-1  ]: On model.jaffle_shop.customers: BEGIN
[0m09:33:56.349278 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:33:59.256996 [debug] [Thread-1  ]: SQL status: BEGIN in 2.91 seconds
[0m09:33:59.257275 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:33:59.257430 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "rdw"."dbt_greg"."customers__dbt_tmp" as (
    

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from dbt.jaffle_shop_customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from dbt.jaffle_shop_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m09:33:59.576488 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.32 seconds
[0m09:33:59.584686 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:33:59.584939 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "rdw"."dbt_greg"."customers" rename to "customers__dbt_backup"
[0m09:34:00.044046 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.46 seconds
[0m09:34:00.047492 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:34:00.047678 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "rdw"."dbt_greg"."customers__dbt_tmp" rename to "customers"
[0m09:34:00.515985 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.47 seconds
[0m09:34:00.540449 [debug] [Thread-1  ]: On model.jaffle_shop.customers: COMMIT
[0m09:34:00.540681 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:34:00.540823 [debug] [Thread-1  ]: On model.jaffle_shop.customers: COMMIT
[0m09:34:00.832203 [debug] [Thread-1  ]: SQL status: COMMIT in 0.29 seconds
[0m09:34:00.838256 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:34:00.838489 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop view if exists "rdw"."dbt_greg"."customers__dbt_backup" cascade
[0m09:34:01.154041 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.32 seconds
[0m09:34:01.155845 [debug] [Thread-1  ]: finished collecting timing info
[0m09:34:01.156156 [debug] [Thread-1  ]: On model.jaffle_shop.customers: Close
[0m09:34:01.157021 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e235afc-fa21-4a75-b289-9ab01623c3a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0764f0>]}
[0m09:34:01.157433 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_greg.customers ................................ [[32mCREATE VIEW[0m in 4.90s]
[0m09:34:01.157845 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m09:34:01.159491 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:34:01.159861 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:01.160152 [debug] [MainThread]: On master: BEGIN
[0m09:34:01.160380 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:34:04.491338 [debug] [MainThread]: SQL status: BEGIN in 3.33 seconds
[0m09:34:04.491761 [debug] [MainThread]: On master: COMMIT
[0m09:34:04.491999 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:04.492216 [debug] [MainThread]: On master: COMMIT
[0m09:34:04.809965 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m09:34:04.810262 [debug] [MainThread]: On master: Close
[0m09:34:04.811152 [info ] [MainThread]: 
[0m09:34:04.811466 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 21.40 seconds (21.40s).
[0m09:34:04.811823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:34:04.811994 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m09:34:04.820045 [info ] [MainThread]: 
[0m09:34:04.820495 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:34:04.820879 [info ] [MainThread]: 
[0m09:34:04.821275 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:34:04.821689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a027ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0c1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d98e50>]}


============================== 2022-07-27 09:42:17.533739 | 94e0b904-80ae-4018-9e27-6d499ef1c302 ==============================
[0m09:42:17.533850 [info ] [MainThread]: Running with dbt=1.2.0
[0m09:42:17.535094 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:42:17.535342 [debug] [MainThread]: Tracking: tracking
[0m09:42:17.555981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1b3e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1b3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1b3f70>]}
[0m09:42:17.583707 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:42:17.584082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '94e0b904-80ae-4018-9e27-6d499ef1c302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1dad00>]}
[0m09:42:17.622163 [debug] [MainThread]: Parsing macros/catalog.sql
[0m09:42:17.626466 [debug] [MainThread]: Parsing macros/relations.sql
[0m09:42:17.628088 [debug] [MainThread]: Parsing macros/adapters.sql
[0m09:42:17.671332 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m09:42:17.673653 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m09:42:17.674765 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m09:42:17.676862 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m09:42:17.685055 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m09:42:17.685764 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m09:42:17.687818 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m09:42:17.689316 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m09:42:17.695244 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m09:42:17.699207 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m09:42:17.701153 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m09:42:17.729483 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m09:42:17.750107 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m09:42:17.774357 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m09:42:17.779899 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m09:42:17.782235 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m09:42:17.784703 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m09:42:17.791632 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m09:42:17.818480 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m09:42:17.820701 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m09:42:17.832426 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m09:42:17.852196 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m09:42:17.858243 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m09:42:17.860988 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m09:42:17.865980 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m09:42:17.867251 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m09:42:17.870310 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m09:42:17.872441 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m09:42:17.879138 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m09:42:17.896428 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m09:42:17.897814 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m09:42:17.900035 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m09:42:17.901461 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m09:42:17.902253 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m09:42:17.902995 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m09:42:17.903625 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m09:42:17.904848 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m09:42:17.908847 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m09:42:17.916860 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m09:42:17.917962 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m09:42:17.919122 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m09:42:17.920022 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m09:42:17.920899 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m09:42:17.922088 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m09:42:17.922870 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m09:42:17.923865 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m09:42:17.925105 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m09:42:17.927327 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m09:42:17.928493 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m09:42:17.929507 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m09:42:17.930489 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m09:42:17.931444 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m09:42:17.932304 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m09:42:17.933492 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m09:42:17.934385 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m09:42:17.939938 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m09:42:17.940850 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m09:42:17.942552 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m09:42:17.944537 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m09:42:17.945565 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m09:42:17.947799 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m09:42:17.950507 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m09:42:17.965357 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m09:42:17.968433 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m09:42:17.983190 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m09:42:17.989209 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m09:42:17.997588 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m09:42:18.009291 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m09:42:18.348736 [debug] [MainThread]: 1699: static parser successfully parsed stg_customers.sql
[0m09:42:18.362284 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m09:42:18.365433 [debug] [MainThread]: 1699: static parser successfully parsed stg_orders.sql
[0m09:42:18.392412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94e0b904-80ae-4018-9e27-6d499ef1c302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a08e670>]}
[0m09:42:18.397940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94e0b904-80ae-4018-9e27-6d499ef1c302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a098070>]}
[0m09:42:18.398205 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:42:18.398413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94e0b904-80ae-4018-9e27-6d499ef1c302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1eed90>]}
[0m09:42:18.399358 [info ] [MainThread]: 
[0m09:42:18.399726 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:42:18.400403 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw"
[0m09:42:18.408922 [debug] [ThreadPool]: Using postgres connection "list_rdw"
[0m09:42:18.409098 [debug] [ThreadPool]: On list_rdw: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw"} */

    select distinct nspname from pg_namespace
  
[0m09:42:18.409212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:42:21.483171 [debug] [ThreadPool]: SQL status: SELECT 85 in 3.07 seconds
[0m09:42:21.485007 [debug] [ThreadPool]: On list_rdw: Close
[0m09:42:21.486523 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw_dbt_greg"
[0m09:42:21.493542 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m09:42:21.493762 [debug] [ThreadPool]: On list_rdw_dbt_greg: BEGIN
[0m09:42:21.493947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:42:24.607974 [debug] [ThreadPool]: SQL status: BEGIN in 3.11 seconds
[0m09:42:24.608209 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m09:42:24.608343 [debug] [ThreadPool]: On list_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw_dbt_greg"} */
select
      'rdw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_greg'
    union all
    select
      'rdw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_greg'
  
[0m09:42:24.933372 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.32 seconds
[0m09:42:24.934629 [debug] [ThreadPool]: On list_rdw_dbt_greg: ROLLBACK
[0m09:42:25.250740 [debug] [ThreadPool]: On list_rdw_dbt_greg: Close
[0m09:42:25.257427 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:25.257729 [debug] [MainThread]: On master: BEGIN
[0m09:42:25.257909 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:42:28.333673 [debug] [MainThread]: SQL status: BEGIN in 3.08 seconds
[0m09:42:28.334269 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:28.334699 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:42:30.733554 [debug] [MainThread]: SQL status: SELECT 1871 in 2.4 seconds
[0m09:42:30.780009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94e0b904-80ae-4018-9e27-6d499ef1c302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2547c0>]}
[0m09:42:30.780439 [debug] [MainThread]: On master: ROLLBACK
[0m09:42:31.045172 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:31.045390 [debug] [MainThread]: On master: BEGIN
[0m09:42:31.841132 [debug] [MainThread]: SQL status: BEGIN in 0.8 seconds
[0m09:42:31.841568 [debug] [MainThread]: On master: COMMIT
[0m09:42:31.841802 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:31.842010 [debug] [MainThread]: On master: COMMIT
[0m09:42:32.156909 [debug] [MainThread]: SQL status: COMMIT in 0.31 seconds
[0m09:42:32.157265 [debug] [MainThread]: On master: Close
[0m09:42:32.158036 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:42:32.158507 [info ] [MainThread]: 
[0m09:42:32.164380 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
[0m09:42:32.164591 [debug] [Thread-2  ]: Began running node model.jaffle_shop.stg_orders
[0m09:42:32.165063 [info ] [Thread-1  ]: 1 of 3 START table model dbt_greg.stg_customers ................................ [RUN]
[0m09:42:32.165504 [info ] [Thread-2  ]: 2 of 3 START table model dbt_greg.stg_orders ................................... [RUN]
[0m09:42:32.166175 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_customers"
[0m09:42:32.166852 [debug] [Thread-2  ]: Acquiring new postgres connection "model.jaffle_shop.stg_orders"
[0m09:42:32.167059 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
[0m09:42:32.167253 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.stg_orders
[0m09:42:32.167456 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
[0m09:42:32.167639 [debug] [Thread-2  ]: Compiling model.jaffle_shop.stg_orders
[0m09:42:32.169503 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m09:42:32.171237 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m09:42:32.171900 [debug] [Thread-1  ]: finished collecting timing info
[0m09:42:32.172200 [debug] [Thread-2  ]: finished collecting timing info
[0m09:42:32.172449 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
[0m09:42:32.172676 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.stg_orders
[0m09:42:32.239434 [debug] [Thread-2  ]: Writing runtime SQL for node "model.jaffle_shop.stg_orders"
[0m09:42:32.239686 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.stg_customers"
[0m09:42:32.240372 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:42:32.240565 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:42:32.240679 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: BEGIN
[0m09:42:32.240845 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: BEGIN
[0m09:42:32.241007 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:42:32.241190 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:42:34.860944 [debug] [Thread-1  ]: SQL status: BEGIN in 2.62 seconds
[0m09:42:34.861251 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:42:34.861431 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create  table "rdw"."dbt_greg"."stg_customers__dbt_tmp"
  as (
    select
    id as customer_id,
    first_name,
    last_name

from dbt.jaffle_shop_customers
  );
[0m09:42:35.183601 [debug] [Thread-2  ]: SQL status: BEGIN in 2.94 seconds
[0m09:42:35.183869 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:42:35.184018 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create  table "rdw"."dbt_greg"."stg_orders__dbt_tmp"
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from dbt.jaffle_shop_orders
  );
[0m09:42:35.334888 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.47 seconds
[0m09:42:35.343701 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:42:35.343921 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "rdw"."dbt_greg"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m09:42:35.497505 [debug] [Thread-2  ]: SQL status: SELECT 99 in 0.31 seconds
[0m09:42:35.500673 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:42:35.500962 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "rdw"."dbt_greg"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m09:42:35.654640 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.31 seconds
[0m09:42:35.678956 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: COMMIT
[0m09:42:35.679201 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:42:35.679351 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: COMMIT
[0m09:42:35.811816 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.31 seconds
[0m09:42:35.814289 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: COMMIT
[0m09:42:35.814499 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:42:35.814673 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: COMMIT
[0m09:42:35.983653 [debug] [Thread-1  ]: SQL status: COMMIT in 0.3 seconds
[0m09:42:35.990021 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:42:35.990250 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop table if exists "rdw"."dbt_greg"."stg_customers__dbt_backup" cascade
[0m09:42:36.133831 [debug] [Thread-2  ]: SQL status: COMMIT in 0.32 seconds
[0m09:42:36.137106 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:42:36.137310 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop table if exists "rdw"."dbt_greg"."stg_orders__dbt_backup" cascade
[0m09:42:36.284031 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.29 seconds
[0m09:42:36.285665 [debug] [Thread-1  ]: finished collecting timing info
[0m09:42:36.285952 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: Close
[0m09:42:36.286648 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94e0b904-80ae-4018-9e27-6d499ef1c302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2f37c0>]}
[0m09:42:36.287101 [info ] [Thread-1  ]: 1 of 3 OK created table model dbt_greg.stg_customers ........................... [[32mSELECT 100[0m in 4.12s]
[0m09:42:36.287566 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
[0m09:42:36.594924 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.46 seconds
[0m09:42:36.597032 [debug] [Thread-2  ]: finished collecting timing info
[0m09:42:36.597318 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: Close
[0m09:42:36.598095 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94e0b904-80ae-4018-9e27-6d499ef1c302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a41ee80>]}
[0m09:42:36.598499 [info ] [Thread-2  ]: 2 of 3 OK created table model dbt_greg.stg_orders .............................. [[32mSELECT 99[0m in 4.43s]
[0m09:42:36.598947 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.stg_orders
[0m09:42:36.599575 [debug] [Thread-4  ]: Began running node model.jaffle_shop.customers
[0m09:42:36.599983 [info ] [Thread-4  ]: 3 of 3 START table model dbt_greg.customers .................................... [RUN]
[0m09:42:36.600530 [debug] [Thread-4  ]: Acquiring new postgres connection "model.jaffle_shop.customers"
[0m09:42:36.600720 [debug] [Thread-4  ]: Began compiling node model.jaffle_shop.customers
[0m09:42:36.600899 [debug] [Thread-4  ]: Compiling model.jaffle_shop.customers
[0m09:42:36.604321 [debug] [Thread-4  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m09:42:36.604885 [debug] [Thread-4  ]: finished collecting timing info
[0m09:42:36.605079 [debug] [Thread-4  ]: Began executing node model.jaffle_shop.customers
[0m09:42:36.609947 [debug] [Thread-4  ]: Writing runtime SQL for node "model.jaffle_shop.customers"
[0m09:42:36.611980 [debug] [Thread-4  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:42:36.612178 [debug] [Thread-4  ]: On model.jaffle_shop.customers: BEGIN
[0m09:42:36.612326 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:42:40.191423 [debug] [Thread-4  ]: SQL status: BEGIN in 3.58 seconds
[0m09:42:40.191665 [debug] [Thread-4  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:42:40.191805 [debug] [Thread-4  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create  table "rdw"."dbt_greg"."customers__dbt_tmp"
  as (
    with customers as (

    select * from "rdw"."dbt_greg"."stg_customers"

),

orders as (

    select * from "rdw"."dbt_greg"."stg_orders"

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m09:42:40.513709 [debug] [Thread-4  ]: SQL status: SELECT 100 in 0.32 seconds
[0m09:42:40.517309 [debug] [Thread-4  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:42:40.517515 [debug] [Thread-4  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "rdw"."dbt_greg"."customers" rename to "customers__dbt_backup"
[0m09:42:40.833724 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.32 seconds
[0m09:42:40.836237 [debug] [Thread-4  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:42:40.836410 [debug] [Thread-4  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "rdw"."dbt_greg"."customers__dbt_tmp" rename to "customers"
[0m09:42:41.150474 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.31 seconds
[0m09:42:41.157063 [debug] [Thread-4  ]: On model.jaffle_shop.customers: COMMIT
[0m09:42:41.157267 [debug] [Thread-4  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:42:41.157413 [debug] [Thread-4  ]: On model.jaffle_shop.customers: COMMIT
[0m09:42:41.483798 [debug] [Thread-4  ]: SQL status: COMMIT in 0.33 seconds
[0m09:42:41.486749 [debug] [Thread-4  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:42:41.486977 [debug] [Thread-4  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop view if exists "rdw"."dbt_greg"."customers__dbt_backup" cascade
[0m09:42:41.804835 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.32 seconds
[0m09:42:41.806810 [debug] [Thread-4  ]: finished collecting timing info
[0m09:42:41.807371 [debug] [Thread-4  ]: On model.jaffle_shop.customers: Close
[0m09:42:41.808083 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94e0b904-80ae-4018-9e27-6d499ef1c302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3f3df0>]}
[0m09:42:41.808459 [info ] [Thread-4  ]: 3 of 3 OK created table model dbt_greg.customers ............................... [[32mSELECT 100[0m in 5.21s]
[0m09:42:41.808912 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.customers
[0m09:42:41.810121 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:42:41.810323 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:41.810471 [debug] [MainThread]: On master: BEGIN
[0m09:42:41.810604 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:42:44.859056 [debug] [MainThread]: SQL status: BEGIN in 3.05 seconds
[0m09:42:44.859373 [debug] [MainThread]: On master: COMMIT
[0m09:42:44.859555 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:44.859725 [debug] [MainThread]: On master: COMMIT
[0m09:42:45.184129 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m09:42:45.184555 [debug] [MainThread]: On master: Close
[0m09:42:45.185381 [info ] [MainThread]: 
[0m09:42:45.185782 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 26.79 seconds (26.79s).
[0m09:42:45.186152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:42:45.186464 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m09:42:45.186659 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m09:42:45.186825 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m09:42:45.195505 [info ] [MainThread]: 
[0m09:42:45.195891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:42:45.196224 [info ] [MainThread]: 
[0m09:42:45.196478 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:42:45.196793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2fefa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a54ad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a54a6d0>]}


============================== 2022-07-27 09:47:21.695259 | 1f32e385-f6fe-4ea6-a45e-ec96ce437696 ==============================
[0m09:47:21.695306 [info ] [MainThread]: Running with dbt=1.2.0
[0m09:47:21.696055 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:47:21.696212 [debug] [MainThread]: Tracking: tracking
[0m09:47:21.713482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ee9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112edd850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112edd8b0>]}
[0m09:47:21.759039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:47:21.759493 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/customers.sql
[0m09:47:21.772357 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m09:47:21.791005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f32e385-f6fe-4ea6-a45e-ec96ce437696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113008f70>]}
[0m09:47:21.797105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f32e385-f6fe-4ea6-a45e-ec96ce437696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fedf40>]}
[0m09:47:21.797437 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:47:21.797725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f32e385-f6fe-4ea6-a45e-ec96ce437696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fda9a0>]}
[0m09:47:21.799072 [info ] [MainThread]: 
[0m09:47:21.799523 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:47:21.800328 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw"
[0m09:47:21.810485 [debug] [ThreadPool]: Using postgres connection "list_rdw"
[0m09:47:21.810707 [debug] [ThreadPool]: On list_rdw: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw"} */

    select distinct nspname from pg_namespace
  
[0m09:47:21.810848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:47:25.010549 [debug] [ThreadPool]: SQL status: SELECT 85 in 3.2 seconds
[0m09:47:25.012642 [debug] [ThreadPool]: On list_rdw: Close
[0m09:47:25.013930 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw_dbt_greg"
[0m09:47:25.020418 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m09:47:25.020643 [debug] [ThreadPool]: On list_rdw_dbt_greg: BEGIN
[0m09:47:25.020786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:47:28.206030 [debug] [ThreadPool]: SQL status: BEGIN in 3.19 seconds
[0m09:47:28.206372 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m09:47:28.206597 [debug] [ThreadPool]: On list_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw_dbt_greg"} */
select
      'rdw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_greg'
    union all
    select
      'rdw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_greg'
  
[0m09:47:28.545896 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.34 seconds
[0m09:47:28.547586 [debug] [ThreadPool]: On list_rdw_dbt_greg: ROLLBACK
[0m09:47:28.894924 [debug] [ThreadPool]: On list_rdw_dbt_greg: Close
[0m09:47:28.901408 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:28.901613 [debug] [MainThread]: On master: BEGIN
[0m09:47:28.901763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:47:32.033533 [debug] [MainThread]: SQL status: BEGIN in 3.13 seconds
[0m09:47:32.033747 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:32.033870 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:47:34.436339 [debug] [MainThread]: SQL status: SELECT 1868 in 2.4 seconds
[0m09:47:34.515996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f32e385-f6fe-4ea6-a45e-ec96ce437696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d5a2e0>]}
[0m09:47:34.516391 [debug] [MainThread]: On master: ROLLBACK
[0m09:47:34.756124 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:34.756424 [debug] [MainThread]: On master: BEGIN
[0m09:47:35.556161 [debug] [MainThread]: SQL status: BEGIN in 0.8 seconds
[0m09:47:35.556549 [debug] [MainThread]: On master: COMMIT
[0m09:47:35.556842 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:35.557049 [debug] [MainThread]: On master: COMMIT
[0m09:47:35.880790 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m09:47:35.881276 [debug] [MainThread]: On master: Close
[0m09:47:35.882194 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:47:35.882707 [info ] [MainThread]: 
[0m09:47:35.888720 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
[0m09:47:35.889068 [debug] [Thread-2  ]: Began running node model.jaffle_shop.stg_orders
[0m09:47:35.889627 [info ] [Thread-1  ]: 1 of 3 START table model dbt_greg.stg_customers ................................ [RUN]
[0m09:47:35.890081 [info ] [Thread-2  ]: 2 of 3 START table model dbt_greg.stg_orders ................................... [RUN]
[0m09:47:35.890904 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_customers"
[0m09:47:35.891644 [debug] [Thread-2  ]: Acquiring new postgres connection "model.jaffle_shop.stg_orders"
[0m09:47:35.891936 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
[0m09:47:35.892194 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.stg_orders
[0m09:47:35.892473 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
[0m09:47:35.892766 [debug] [Thread-2  ]: Compiling model.jaffle_shop.stg_orders
[0m09:47:35.895304 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m09:47:35.897838 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m09:47:35.898773 [debug] [Thread-1  ]: finished collecting timing info
[0m09:47:35.899118 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
[0m09:47:35.899352 [debug] [Thread-2  ]: finished collecting timing info
[0m09:47:35.929202 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.stg_orders
[0m09:47:35.973798 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.stg_customers"
[0m09:47:35.975499 [debug] [Thread-2  ]: Writing runtime SQL for node "model.jaffle_shop.stg_orders"
[0m09:47:35.976225 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:47:35.976399 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:47:35.976617 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: BEGIN
[0m09:47:35.976784 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: BEGIN
[0m09:47:35.976931 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:47:35.977082 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:47:38.679297 [debug] [Thread-1  ]: SQL status: BEGIN in 2.7 seconds
[0m09:47:38.679658 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:47:38.679901 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create  table "rdw"."dbt_greg"."stg_customers__dbt_tmp"
  as (
    select
    id as customer_id,
    first_name,
    last_name

from dbt.jaffle_shop_customers
  );
[0m09:47:38.994883 [debug] [Thread-2  ]: SQL status: BEGIN in 3.02 seconds
[0m09:47:38.995414 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:47:38.995783 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create  table "rdw"."dbt_greg"."stg_orders__dbt_tmp"
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from dbt.jaffle_shop_orders
  );
[0m09:47:39.244661 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.56 seconds
[0m09:47:39.253512 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:47:39.253776 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "rdw"."dbt_greg"."stg_customers" rename to "stg_customers__dbt_backup"
[0m09:47:39.316281 [debug] [Thread-2  ]: SQL status: SELECT 99 in 0.32 seconds
[0m09:47:39.319574 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:47:39.319820 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "rdw"."dbt_greg"."stg_orders" rename to "stg_orders__dbt_backup"
[0m09:47:39.525014 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.27 seconds
[0m09:47:39.530904 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:47:39.531363 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "rdw"."dbt_greg"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m09:47:39.684526 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.36 seconds
[0m09:47:39.687945 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:47:39.688156 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "rdw"."dbt_greg"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m09:47:39.842300 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.31 seconds
[0m09:47:39.871421 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: COMMIT
[0m09:47:39.871708 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:47:39.871895 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: COMMIT
[0m09:47:40.006407 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.32 seconds
[0m09:47:40.009426 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: COMMIT
[0m09:47:40.009646 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:47:40.009831 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: COMMIT
[0m09:47:40.158700 [debug] [Thread-1  ]: SQL status: COMMIT in 0.29 seconds
[0m09:47:40.165275 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:47:40.165486 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop table if exists "rdw"."dbt_greg"."stg_customers__dbt_backup" cascade
[0m09:47:40.317025 [debug] [Thread-2  ]: SQL status: COMMIT in 0.31 seconds
[0m09:47:40.320323 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:47:40.320592 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop table if exists "rdw"."dbt_greg"."stg_orders__dbt_backup" cascade
[0m09:47:40.476754 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.31 seconds
[0m09:47:40.478316 [debug] [Thread-1  ]: finished collecting timing info
[0m09:47:40.478552 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: Close
[0m09:47:40.479198 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f32e385-f6fe-4ea6-a45e-ec96ce437696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11307c490>]}
[0m09:47:40.479632 [info ] [Thread-1  ]: 1 of 3 OK created table model dbt_greg.stg_customers ........................... [[32mSELECT 100[0m in 4.59s]
[0m09:47:40.480083 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
[0m09:47:40.636385 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.32 seconds
[0m09:47:40.638439 [debug] [Thread-2  ]: finished collecting timing info
[0m09:47:40.638750 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: Close
[0m09:47:40.639418 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f32e385-f6fe-4ea6-a45e-ec96ce437696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dc89a0>]}
[0m09:47:40.639844 [info ] [Thread-2  ]: 2 of 3 OK created table model dbt_greg.stg_orders .............................. [[32mSELECT 99[0m in 4.75s]
[0m09:47:40.640308 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.stg_orders
[0m09:47:40.640944 [debug] [Thread-4  ]: Began running node model.jaffle_shop.customers
[0m09:47:40.641335 [info ] [Thread-4  ]: 3 of 3 START table model dbt_greg.customers .................................... [RUN]
[0m09:47:40.641917 [debug] [Thread-4  ]: Acquiring new postgres connection "model.jaffle_shop.customers"
[0m09:47:40.642114 [debug] [Thread-4  ]: Began compiling node model.jaffle_shop.customers
[0m09:47:40.642315 [debug] [Thread-4  ]: Compiling model.jaffle_shop.customers
[0m09:47:40.645472 [debug] [Thread-4  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m09:47:40.646014 [debug] [Thread-4  ]: finished collecting timing info
[0m09:47:40.646199 [debug] [Thread-4  ]: Began executing node model.jaffle_shop.customers
[0m09:47:40.652100 [debug] [Thread-4  ]: Writing runtime SQL for node "model.jaffle_shop.customers"
[0m09:47:40.652607 [debug] [Thread-4  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:47:40.652776 [debug] [Thread-4  ]: On model.jaffle_shop.customers: BEGIN
[0m09:47:40.652921 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:47:43.920037 [debug] [Thread-4  ]: SQL status: BEGIN in 3.27 seconds
[0m09:47:43.920395 [debug] [Thread-4  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:47:43.920617 [debug] [Thread-4  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create  table "rdw"."dbt_greg"."customers__dbt_tmp"
  as (
    with customers as (

    select * from "rdw"."dbt_greg"."stg_customers"

),

orders as (

    select * from "rdw"."dbt_greg"."stg_orders"

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m09:47:44.395829 [debug] [Thread-4  ]: Postgres adapter: Postgres error: syntax error at or near "."
LINE 37:         customers.first_name,
                          ^

[0m09:47:44.396377 [debug] [Thread-4  ]: On model.jaffle_shop.customers: ROLLBACK
[0m09:47:44.713185 [debug] [Thread-4  ]: finished collecting timing info
[0m09:47:44.713690 [debug] [Thread-4  ]: On model.jaffle_shop.customers: Close
[0m09:47:44.714458 [debug] [Thread-4  ]: Database Error in model customers (models/customers.sql)
  syntax error at or near "."
  LINE 37:         customers.first_name,
                            ^
  compiled SQL at target/run/jaffle_shop/models/customers.sql
[0m09:47:44.714881 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f32e385-f6fe-4ea6-a45e-ec96ce437696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113234520>]}
[0m09:47:44.715376 [error] [Thread-4  ]: 3 of 3 ERROR creating table model dbt_greg.customers ........................... [[31mERROR[0m in 4.07s]
[0m09:47:44.715954 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.customers
[0m09:47:44.717398 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:47:44.717634 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:44.717808 [debug] [MainThread]: On master: BEGIN
[0m09:47:44.717964 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:47:48.006570 [debug] [MainThread]: SQL status: BEGIN in 3.29 seconds
[0m09:47:48.006963 [debug] [MainThread]: On master: COMMIT
[0m09:47:48.007192 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:48.007395 [debug] [MainThread]: On master: COMMIT
[0m09:47:48.324360 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m09:47:48.324749 [debug] [MainThread]: On master: Close
[0m09:47:48.325476 [info ] [MainThread]: 
[0m09:47:48.325794 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 26.53 seconds (26.53s).
[0m09:47:48.326087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:47:48.326244 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m09:47:48.326394 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m09:47:48.326539 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m09:47:48.333213 [info ] [MainThread]: 
[0m09:47:48.333472 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:47:48.333724 [info ] [MainThread]: 
[0m09:47:48.333942 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
[0m09:47:48.334164 [error] [MainThread]:   syntax error at or near "."
[0m09:47:48.334369 [error] [MainThread]:   LINE 37:         customers.first_name,
[0m09:47:48.334564 [error] [MainThread]:                             ^
[0m09:47:48.334760 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/customers.sql
[0m09:47:48.334972 [info ] [MainThread]: 
[0m09:47:48.335228 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:47:48.335669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d9ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d9e040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d9bc40>]}


============================== 2022-07-27 09:48:22.774174 | 5477a1d7-002b-439c-973a-371312cfb52d ==============================
[0m09:48:22.774206 [info ] [MainThread]: Running with dbt=1.2.0
[0m09:48:22.774774 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:48:22.774911 [debug] [MainThread]: Tracking: tracking
[0m09:48:22.792808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066caf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ca400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ca4f0>]}
[0m09:48:22.838123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:48:22.838584 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/stg_customers.sql
[0m09:48:22.838849 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/customers.sql
[0m09:48:22.851720 [debug] [MainThread]: 1699: static parser successfully parsed stg_customers.sql
[0m09:48:22.864241 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m09:48:22.875586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5477a1d7-002b-439c-973a-371312cfb52d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f2940>]}
[0m09:48:22.881609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5477a1d7-002b-439c-973a-371312cfb52d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c4bb0>]}
[0m09:48:22.881895 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:48:22.882150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5477a1d7-002b-439c-973a-371312cfb52d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c1850>]}
[0m09:48:22.883396 [info ] [MainThread]: 
[0m09:48:22.883819 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:48:22.884593 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw"
[0m09:48:22.894693 [debug] [ThreadPool]: Using postgres connection "list_rdw"
[0m09:48:22.894914 [debug] [ThreadPool]: On list_rdw: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw"} */

    select distinct nspname from pg_namespace
  
[0m09:48:22.895059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:48:25.951109 [debug] [ThreadPool]: SQL status: SELECT 85 in 3.06 seconds
[0m09:48:25.954408 [debug] [ThreadPool]: On list_rdw: Close
[0m09:48:25.956279 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw_dbt_greg"
[0m09:48:25.964186 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m09:48:25.964422 [debug] [ThreadPool]: On list_rdw_dbt_greg: BEGIN
[0m09:48:25.964573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:48:28.981734 [debug] [ThreadPool]: SQL status: BEGIN in 3.02 seconds
[0m09:48:28.982031 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m09:48:28.982214 [debug] [ThreadPool]: On list_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw_dbt_greg"} */
select
      'rdw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_greg'
    union all
    select
      'rdw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_greg'
  
[0m09:48:29.459815 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.48 seconds
[0m09:48:29.461348 [debug] [ThreadPool]: On list_rdw_dbt_greg: ROLLBACK
[0m09:48:29.778456 [debug] [ThreadPool]: On list_rdw_dbt_greg: Close
[0m09:48:29.785058 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:29.785405 [debug] [MainThread]: On master: BEGIN
[0m09:48:29.785582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:48:32.871091 [debug] [MainThread]: SQL status: BEGIN in 3.09 seconds
[0m09:48:32.871663 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:32.871907 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:48:34.431195 [debug] [MainThread]: SQL status: SELECT 1868 in 1.56 seconds
[0m09:48:34.512761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5477a1d7-002b-439c-973a-371312cfb52d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e8580>]}
[0m09:48:34.513176 [debug] [MainThread]: On master: ROLLBACK
[0m09:48:34.751491 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:34.752020 [debug] [MainThread]: On master: BEGIN
[0m09:48:35.547484 [debug] [MainThread]: SQL status: BEGIN in 0.8 seconds
[0m09:48:35.548010 [debug] [MainThread]: On master: COMMIT
[0m09:48:35.548255 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:35.548469 [debug] [MainThread]: On master: COMMIT
[0m09:48:35.866565 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m09:48:35.867235 [debug] [MainThread]: On master: Close
[0m09:48:35.868175 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:48:35.868626 [info ] [MainThread]: 
[0m09:48:35.872761 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
[0m09:48:35.872950 [debug] [Thread-2  ]: Began running node model.jaffle_shop.stg_orders
[0m09:48:35.873328 [info ] [Thread-1  ]: 1 of 3 START table model dbt_greg.stg_customers ................................ [RUN]
[0m09:48:35.873641 [info ] [Thread-2  ]: 2 of 3 START table model dbt_greg.stg_orders ................................... [RUN]
[0m09:48:35.874277 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_customers"
[0m09:48:35.874798 [debug] [Thread-2  ]: Acquiring new postgres connection "model.jaffle_shop.stg_orders"
[0m09:48:35.875034 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
[0m09:48:35.875263 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.stg_orders
[0m09:48:35.875487 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
[0m09:48:35.875699 [debug] [Thread-2  ]: Compiling model.jaffle_shop.stg_orders
[0m09:48:35.877592 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m09:48:35.879254 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m09:48:35.879899 [debug] [Thread-1  ]: finished collecting timing info
[0m09:48:35.880113 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
[0m09:48:35.880287 [debug] [Thread-2  ]: finished collecting timing info
[0m09:48:35.887017 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.stg_orders
[0m09:48:35.951497 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.stg_customers"
[0m09:48:35.953316 [debug] [Thread-2  ]: Writing runtime SQL for node "model.jaffle_shop.stg_orders"
[0m09:48:35.953929 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:48:35.954118 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:48:35.954238 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: BEGIN
[0m09:48:35.954420 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: BEGIN
[0m09:48:35.954563 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:48:35.954704 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:48:39.038010 [debug] [Thread-2  ]: SQL status: BEGIN in 3.08 seconds
[0m09:48:39.038269 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:48:39.038425 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create  table "rdw"."dbt_greg"."stg_orders__dbt_tmp"
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from dbt.jaffle_shop_orders
  );
[0m09:48:39.195868 [debug] [Thread-1  ]: SQL status: BEGIN in 3.24 seconds
[0m09:48:39.196264 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:48:39.196514 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create  table "rdw"."dbt_greg"."stg_customers__dbt_tmp"
  as (
    select
    id as customer_id,
    first_name,
    last_name

from dbt.jaffle_shop_customer
  );
[0m09:48:39.358343 [debug] [Thread-2  ]: SQL status: SELECT 99 in 0.32 seconds
[0m09:48:39.365847 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:48:39.366044 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "rdw"."dbt_greg"."stg_orders" rename to "stg_orders__dbt_backup"
[0m09:48:39.516467 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "dbt.jaffle_shop_customer" does not exist
LINE 11: from dbt.jaffle_shop_customer
              ^

[0m09:48:39.516862 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: ROLLBACK
[0m09:48:39.674618 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.31 seconds
[0m09:48:39.677646 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:48:39.677895 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "rdw"."dbt_greg"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m09:48:39.832493 [debug] [Thread-1  ]: finished collecting timing info
[0m09:48:39.832874 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: Close
[0m09:48:39.833571 [debug] [Thread-1  ]: Database Error in model stg_customers (models/stg_customers.sql)
  relation "dbt.jaffle_shop_customer" does not exist
  LINE 11: from dbt.jaffle_shop_customer
                ^
  compiled SQL at target/run/jaffle_shop/models/stg_customers.sql
[0m09:48:39.833922 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5477a1d7-002b-439c-973a-371312cfb52d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d5850>]}
[0m09:48:39.834346 [error] [Thread-1  ]: 1 of 3 ERROR creating table model dbt_greg.stg_customers ....................... [[31mERROR[0m in 3.96s]
[0m09:48:39.834845 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
[0m09:48:39.990054 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.31 seconds
[0m09:48:40.017950 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: COMMIT
[0m09:48:40.018212 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:48:40.018399 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: COMMIT
[0m09:48:40.459594 [debug] [Thread-2  ]: SQL status: COMMIT in 0.44 seconds
[0m09:48:40.466510 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:48:40.466705 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop table if exists "rdw"."dbt_greg"."stg_orders__dbt_backup" cascade
[0m09:48:40.780972 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.31 seconds
[0m09:48:40.783057 [debug] [Thread-2  ]: finished collecting timing info
[0m09:48:40.783355 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: Close
[0m09:48:40.784184 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5477a1d7-002b-439c-973a-371312cfb52d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c30310>]}
[0m09:48:40.784608 [info ] [Thread-2  ]: 2 of 3 OK created table model dbt_greg.stg_orders .............................. [[32mSELECT 99[0m in 4.91s]
[0m09:48:40.785066 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.stg_orders
[0m09:48:40.785672 [debug] [Thread-4  ]: Began running node model.jaffle_shop.customers
[0m09:48:40.785973 [info ] [Thread-4  ]: 3 of 3 SKIP relation dbt_greg.customers ........................................ [[33mSKIP[0m]
[0m09:48:40.786429 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.customers
[0m09:48:40.787748 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:48:40.788019 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:40.788179 [debug] [MainThread]: On master: BEGIN
[0m09:48:40.788321 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:48:44.139238 [debug] [MainThread]: SQL status: BEGIN in 3.35 seconds
[0m09:48:44.139620 [debug] [MainThread]: On master: COMMIT
[0m09:48:44.139840 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:44.140024 [debug] [MainThread]: On master: COMMIT
[0m09:48:44.456212 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m09:48:44.456550 [debug] [MainThread]: On master: Close
[0m09:48:44.457224 [info ] [MainThread]: 
[0m09:48:44.457546 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 21.57 seconds (21.57s).
[0m09:48:44.457880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:48:44.458061 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m09:48:44.458217 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m09:48:44.465333 [info ] [MainThread]: 
[0m09:48:44.465624 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:48:44.465898 [info ] [MainThread]: 
[0m09:48:44.466134 [error] [MainThread]: [33mDatabase Error in model stg_customers (models/stg_customers.sql)[0m
[0m09:48:44.466372 [error] [MainThread]:   relation "dbt.jaffle_shop_customer" does not exist
[0m09:48:44.466588 [error] [MainThread]:   LINE 11: from dbt.jaffle_shop_customer
[0m09:48:44.466800 [error] [MainThread]:                 ^
[0m09:48:44.467009 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/stg_customers.sql
[0m09:48:44.467238 [info ] [MainThread]: 
[0m09:48:44.467484 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m09:48:44.467801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a0700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065aa5e0>]}


============================== 2022-07-27 09:49:10.544671 | 307582ad-8196-4ef1-a484-9fdf63441f9f ==============================
[0m09:49:10.544753 [info ] [MainThread]: Running with dbt=1.2.0
[0m09:49:10.545582 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:49:10.545765 [debug] [MainThread]: Tracking: tracking
[0m09:49:10.567677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd1ae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd1a340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd1afa0>]}
[0m09:49:10.623179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:49:10.623685 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/stg_customers.sql
[0m09:49:10.637493 [debug] [MainThread]: 1699: static parser successfully parsed stg_customers.sql
[0m09:49:10.660879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '307582ad-8196-4ef1-a484-9fdf63441f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce42ee0>]}
[0m09:49:10.667561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '307582ad-8196-4ef1-a484-9fdf63441f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdb9d90>]}
[0m09:49:10.667885 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:49:10.668160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '307582ad-8196-4ef1-a484-9fdf63441f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd3a520>]}
[0m09:49:10.669315 [info ] [MainThread]: 
[0m09:49:10.669746 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:49:10.670437 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw"
[0m09:49:10.680613 [debug] [ThreadPool]: Using postgres connection "list_rdw"
[0m09:49:10.680829 [debug] [ThreadPool]: On list_rdw: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw"} */

    select distinct nspname from pg_namespace
  
[0m09:49:10.680970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:49:13.715582 [debug] [ThreadPool]: SQL status: SELECT 85 in 3.03 seconds
[0m09:49:13.718055 [debug] [ThreadPool]: On list_rdw: Close
[0m09:49:13.719556 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw_dbt_greg"
[0m09:49:13.726279 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m09:49:13.726491 [debug] [ThreadPool]: On list_rdw_dbt_greg: BEGIN
[0m09:49:13.726641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:49:17.037041 [debug] [ThreadPool]: SQL status: BEGIN in 3.31 seconds
[0m09:49:17.037554 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m09:49:17.037908 [debug] [ThreadPool]: On list_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw_dbt_greg"} */
select
      'rdw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_greg'
    union all
    select
      'rdw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_greg'
  
[0m09:49:17.358689 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.32 seconds
[0m09:49:17.360781 [debug] [ThreadPool]: On list_rdw_dbt_greg: ROLLBACK
[0m09:49:17.677567 [debug] [ThreadPool]: On list_rdw_dbt_greg: Close
[0m09:49:17.683489 [debug] [MainThread]: Using postgres connection "master"
[0m09:49:17.683725 [debug] [MainThread]: On master: BEGIN
[0m09:49:17.683874 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:49:20.636788 [debug] [MainThread]: SQL status: BEGIN in 2.95 seconds
[0m09:49:20.637119 [debug] [MainThread]: Using postgres connection "master"
[0m09:49:20.637312 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:49:22.099226 [debug] [MainThread]: SQL status: SELECT 1868 in 1.46 seconds
[0m09:49:22.179278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '307582ad-8196-4ef1-a484-9fdf63441f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb384f0>]}
[0m09:49:22.179674 [debug] [MainThread]: On master: ROLLBACK
[0m09:49:22.416975 [debug] [MainThread]: Using postgres connection "master"
[0m09:49:22.417406 [debug] [MainThread]: On master: BEGIN
[0m09:49:23.210023 [debug] [MainThread]: SQL status: BEGIN in 0.79 seconds
[0m09:49:23.210305 [debug] [MainThread]: On master: COMMIT
[0m09:49:23.210472 [debug] [MainThread]: Using postgres connection "master"
[0m09:49:23.210619 [debug] [MainThread]: On master: COMMIT
[0m09:49:23.526669 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m09:49:23.527011 [debug] [MainThread]: On master: Close
[0m09:49:23.527746 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:49:23.528038 [info ] [MainThread]: 
[0m09:49:23.531395 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m09:49:23.531760 [info ] [Thread-1  ]: 1 of 1 START table model dbt_greg.customers .................................... [RUN]
[0m09:49:23.532288 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.customers"
[0m09:49:23.532462 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m09:49:23.532634 [debug] [Thread-1  ]: Compiling model.jaffle_shop.customers
[0m09:49:23.535742 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m09:49:23.536414 [debug] [Thread-1  ]: finished collecting timing info
[0m09:49:23.536605 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m09:49:23.584294 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.customers"
[0m09:49:23.584936 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:49:23.585105 [debug] [Thread-1  ]: On model.jaffle_shop.customers: BEGIN
[0m09:49:23.585243 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:49:26.707064 [debug] [Thread-1  ]: SQL status: BEGIN in 3.12 seconds
[0m09:49:26.707600 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:49:26.707845 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create  table "rdw"."dbt_greg"."customers__dbt_tmp"
  as (
    with customers as (

    select * from "rdw"."dbt_greg"."stg_customers"

),

orders as (

    select * from "rdw"."dbt_greg"."stg_orders"

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m09:49:27.031191 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.32 seconds
[0m09:49:27.038780 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:49:27.039006 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "rdw"."dbt_greg"."customers" rename to "customers__dbt_backup"
[0m09:49:27.351119 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.31 seconds
[0m09:49:27.355150 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:49:27.355374 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "rdw"."dbt_greg"."customers__dbt_tmp" rename to "customers"
[0m09:49:27.668512 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.31 seconds
[0m09:49:27.698494 [debug] [Thread-1  ]: On model.jaffle_shop.customers: COMMIT
[0m09:49:27.698759 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:49:27.698908 [debug] [Thread-1  ]: On model.jaffle_shop.customers: COMMIT
[0m09:49:27.989234 [debug] [Thread-1  ]: SQL status: COMMIT in 0.29 seconds
[0m09:49:27.995621 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m09:49:27.995858 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop table if exists "rdw"."dbt_greg"."customers__dbt_backup" cascade
[0m09:49:28.309811 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.31 seconds
[0m09:49:28.311706 [debug] [Thread-1  ]: finished collecting timing info
[0m09:49:28.311934 [debug] [Thread-1  ]: On model.jaffle_shop.customers: Close
[0m09:49:28.312577 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '307582ad-8196-4ef1-a484-9fdf63441f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce27bb0>]}
[0m09:49:28.313002 [info ] [Thread-1  ]: 1 of 1 OK created table model dbt_greg.customers ............................... [[32mSELECT 100[0m in 4.78s]
[0m09:49:28.313472 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m09:49:28.314831 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:49:28.315068 [debug] [MainThread]: Using postgres connection "master"
[0m09:49:28.315260 [debug] [MainThread]: On master: BEGIN
[0m09:49:28.315505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:49:31.738242 [debug] [MainThread]: SQL status: BEGIN in 3.42 seconds
[0m09:49:31.738774 [debug] [MainThread]: On master: COMMIT
[0m09:49:31.739122 [debug] [MainThread]: Using postgres connection "master"
[0m09:49:31.739329 [debug] [MainThread]: On master: COMMIT
[0m09:49:32.055736 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m09:49:32.056321 [debug] [MainThread]: On master: Close
[0m09:49:32.057238 [info ] [MainThread]: 
[0m09:49:32.057651 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 21.39 seconds (21.39s).
[0m09:49:32.058020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:49:32.058221 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m09:49:32.065187 [info ] [MainThread]: 
[0m09:49:32.065506 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:49:32.065858 [info ] [MainThread]: 
[0m09:49:32.066093 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:49:32.066405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce27bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbf4730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbe99a0>]}


============================== 2022-07-27 09:54:20.309916 | 98e5e057-96d6-4a2c-b55c-c2447d12bcc2 ==============================
[0m09:54:20.309972 [info ] [MainThread]: Running with dbt=1.2.0
[0m09:54:20.311205 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/staging'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:54:20.311431 [debug] [MainThread]: Tracking: tracking
[0m09:54:20.331372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9a4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9a4f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9a4f70>]}
[0m09:54:20.359728 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:54:20.360097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '98e5e057-96d6-4a2c-b55c-c2447d12bcc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a897910>]}
[0m09:54:20.391710 [debug] [MainThread]: Parsing macros/catalog.sql
[0m09:54:20.395390 [debug] [MainThread]: Parsing macros/relations.sql
[0m09:54:20.396915 [debug] [MainThread]: Parsing macros/adapters.sql
[0m09:54:20.428781 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m09:54:20.430758 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m09:54:20.431503 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m09:54:20.433139 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m09:54:20.440904 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m09:54:20.441518 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m09:54:20.442894 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m09:54:20.444062 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m09:54:20.448324 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m09:54:20.450790 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m09:54:20.452523 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m09:54:20.469281 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m09:54:20.481200 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m09:54:20.492752 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m09:54:20.496897 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m09:54:20.498612 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m09:54:20.500202 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m09:54:20.504179 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m09:54:20.519306 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m09:54:20.520687 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m09:54:20.529363 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m09:54:20.546913 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m09:54:20.552861 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m09:54:20.555928 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m09:54:20.561616 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m09:54:20.562979 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m09:54:20.566633 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m09:54:20.568890 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m09:54:20.575167 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m09:54:20.592284 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m09:54:20.593650 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m09:54:20.595769 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m09:54:20.597323 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m09:54:20.598098 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m09:54:20.598820 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m09:54:20.599430 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m09:54:20.600612 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m09:54:20.604465 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m09:54:20.611991 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m09:54:20.612739 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m09:54:20.613834 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m09:54:20.614809 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m09:54:20.615656 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m09:54:20.616770 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m09:54:20.617513 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m09:54:20.618543 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m09:54:20.619524 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m09:54:20.621659 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m09:54:20.622744 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m09:54:20.623706 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m09:54:20.624663 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m09:54:20.625592 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m09:54:20.626423 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m09:54:20.627386 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m09:54:20.628217 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m09:54:20.633703 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m09:54:20.634541 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m09:54:20.636149 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m09:54:20.637974 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m09:54:20.639017 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m09:54:20.641403 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m09:54:20.643758 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m09:54:20.657082 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m09:54:20.659640 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m09:54:20.672343 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m09:54:20.676326 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m09:54:20.682967 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m09:54:20.691964 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m09:54:20.963685 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m09:54:20.973801 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers.sql
[0m09:54:20.975848 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
[0m09:54:21.006223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98e5e057-96d6-4a2c-b55c-c2447d12bcc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa3afa0>]}
[0m09:54:21.012867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98e5e057-96d6-4a2c-b55c-c2447d12bcc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa92820>]}
[0m09:54:21.013216 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:54:21.013489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98e5e057-96d6-4a2c-b55c-c2447d12bcc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9a4fa0>]}
[0m09:54:21.014948 [info ] [MainThread]: 
[0m09:54:21.015438 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:54:21.016209 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw"
[0m09:54:21.026938 [debug] [ThreadPool]: Using postgres connection "list_rdw"
[0m09:54:21.027181 [debug] [ThreadPool]: On list_rdw: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw"} */

    select distinct nspname from pg_namespace
  
[0m09:54:21.027345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:24.069428 [debug] [ThreadPool]: SQL status: SELECT 85 in 3.04 seconds
[0m09:54:24.073427 [debug] [ThreadPool]: On list_rdw: Close
[0m09:54:24.075656 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw_dbt_greg"
[0m09:54:24.082795 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m09:54:24.083030 [debug] [ThreadPool]: On list_rdw_dbt_greg: BEGIN
[0m09:54:24.083182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:54:27.040580 [debug] [ThreadPool]: SQL status: BEGIN in 2.96 seconds
[0m09:54:27.040937 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m09:54:27.041259 [debug] [ThreadPool]: On list_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw_dbt_greg"} */
select
      'rdw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_greg'
    union all
    select
      'rdw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_greg'
  
[0m09:54:27.362742 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.32 seconds
[0m09:54:27.364902 [debug] [ThreadPool]: On list_rdw_dbt_greg: ROLLBACK
[0m09:54:27.684013 [debug] [ThreadPool]: On list_rdw_dbt_greg: Close
[0m09:54:27.690336 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:27.690618 [debug] [MainThread]: On master: BEGIN
[0m09:54:27.690861 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:54:30.866476 [debug] [MainThread]: SQL status: BEGIN in 3.18 seconds
[0m09:54:30.866829 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:30.867051 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:54:32.170128 [debug] [MainThread]: SQL status: SELECT 1868 in 1.3 seconds
[0m09:54:32.211986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98e5e057-96d6-4a2c-b55c-c2447d12bcc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa0fe50>]}
[0m09:54:32.212384 [debug] [MainThread]: On master: ROLLBACK
[0m09:54:32.487488 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:32.488051 [debug] [MainThread]: On master: BEGIN
[0m09:54:33.124086 [debug] [MainThread]: SQL status: BEGIN in 0.64 seconds
[0m09:54:33.124424 [debug] [MainThread]: On master: COMMIT
[0m09:54:33.124636 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:33.124819 [debug] [MainThread]: On master: COMMIT
[0m09:54:33.440905 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m09:54:33.441196 [debug] [MainThread]: On master: Close
[0m09:54:33.441735 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:54:33.442025 [info ] [MainThread]: 
[0m09:54:33.447006 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
[0m09:54:33.447328 [info ] [Thread-1  ]: 1 of 2 START view model dbt_greg.stg_customers ................................. [RUN]
[0m09:54:33.447672 [debug] [Thread-2  ]: Began running node model.jaffle_shop.stg_orders
[0m09:54:33.448013 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_customers"
[0m09:54:33.448284 [info ] [Thread-2  ]: 2 of 2 START view model dbt_greg.stg_orders .................................... [RUN]
[0m09:54:33.448486 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
[0m09:54:33.448960 [debug] [Thread-2  ]: Acquiring new postgres connection "model.jaffle_shop.stg_orders"
[0m09:54:33.449182 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
[0m09:54:33.449357 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.stg_orders
[0m09:54:33.450915 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m09:54:33.451107 [debug] [Thread-2  ]: Compiling model.jaffle_shop.stg_orders
[0m09:54:33.452622 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m09:54:33.453019 [debug] [Thread-1  ]: finished collecting timing info
[0m09:54:33.453191 [debug] [Thread-2  ]: finished collecting timing info
[0m09:54:33.453328 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
[0m09:54:33.453509 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.stg_orders
[0m09:54:33.517636 [debug] [Thread-2  ]: Writing runtime SQL for node "model.jaffle_shop.stg_orders"
[0m09:54:33.518115 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.stg_customers"
[0m09:54:33.518695 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:54:33.518859 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:54:33.518954 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: BEGIN
[0m09:54:33.519082 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: BEGIN
[0m09:54:33.519215 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:54:33.519334 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:54:36.456262 [debug] [Thread-2  ]: SQL status: BEGIN in 2.94 seconds
[0m09:54:36.456649 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:54:36.456881 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "rdw"."dbt_greg"."stg_orders__dbt_tmp" as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from dbt.jaffle_shop_orders
  );
[0m09:54:36.776500 [debug] [Thread-1  ]: SQL status: BEGIN in 3.26 seconds
[0m09:54:36.776761 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:54:36.776914 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "rdw"."dbt_greg"."stg_customers__dbt_tmp" as (
    select
    id as customer_id,
    first_name,
    last_name

from dbt.jaffle_shop_customers
  );
[0m09:54:36.934717 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.48 seconds
[0m09:54:36.943730 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:54:36.943952 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "rdw"."dbt_greg"."stg_orders" rename to "stg_orders__dbt_backup"
[0m09:54:37.095009 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.32 seconds
[0m09:54:37.098717 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:54:37.098936 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "rdw"."dbt_greg"."stg_customers" rename to "stg_customers__dbt_backup"
[0m09:54:37.252886 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.31 seconds
[0m09:54:37.256334 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:54:37.256570 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "rdw"."dbt_greg"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m09:54:37.566753 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.47 seconds
[0m09:54:37.570358 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:54:37.570596 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "rdw"."dbt_greg"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m09:54:37.724616 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.47 seconds
[0m09:54:37.748168 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: COMMIT
[0m09:54:37.748415 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:54:37.748577 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: COMMIT
[0m09:54:37.884021 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.31 seconds
[0m09:54:37.886970 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: COMMIT
[0m09:54:37.887199 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:54:37.887379 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: COMMIT
[0m09:54:38.042387 [debug] [Thread-2  ]: SQL status: COMMIT in 0.29 seconds
[0m09:54:38.048702 [debug] [Thread-2  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:54:38.048904 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop table if exists "rdw"."dbt_greg"."stg_orders__dbt_backup" cascade
[0m09:54:38.200513 [debug] [Thread-1  ]: SQL status: COMMIT in 0.31 seconds
[0m09:54:38.203371 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:54:38.203597 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop table if exists "rdw"."dbt_greg"."stg_customers__dbt_backup" cascade
[0m09:54:38.514312 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.47 seconds
[0m09:54:38.515725 [debug] [Thread-2  ]: finished collecting timing info
[0m09:54:38.515979 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: Close
[0m09:54:38.516575 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98e5e057-96d6-4a2c-b55c-c2447d12bcc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac89fd0>]}
[0m09:54:38.516952 [info ] [Thread-2  ]: 2 of 2 OK created view model dbt_greg.stg_orders ............................... [[32mCREATE VIEW[0m in 5.07s]
[0m09:54:38.517373 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.stg_orders
[0m09:54:38.672676 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.47 seconds
[0m09:54:38.674857 [debug] [Thread-1  ]: finished collecting timing info
[0m09:54:38.675149 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: Close
[0m09:54:38.675931 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98e5e057-96d6-4a2c-b55c-c2447d12bcc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab0e910>]}
[0m09:54:38.676374 [info ] [Thread-1  ]: 1 of 2 OK created view model dbt_greg.stg_customers ............................ [[32mCREATE VIEW[0m in 5.23s]
[0m09:54:38.676962 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
[0m09:54:38.679351 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:54:38.679665 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:38.679848 [debug] [MainThread]: On master: BEGIN
[0m09:54:38.680014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:54:42.225094 [debug] [MainThread]: SQL status: BEGIN in 3.55 seconds
[0m09:54:42.225482 [debug] [MainThread]: On master: COMMIT
[0m09:54:42.225753 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:42.225986 [debug] [MainThread]: On master: COMMIT
[0m09:54:42.542946 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m09:54:42.543278 [debug] [MainThread]: On master: Close
[0m09:54:42.544032 [info ] [MainThread]: 
[0m09:54:42.544429 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 21.53 seconds (21.53s).
[0m09:54:42.544744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:54:42.544911 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m09:54:42.545069 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m09:54:42.551840 [info ] [MainThread]: 
[0m09:54:42.552136 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:54:42.552433 [info ] [MainThread]: 
[0m09:54:42.552686 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:54:42.553020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa3a670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa3a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac212b0>]}


============================== 2022-07-27 09:58:05.294113 | dc5a4dc7-c099-493a-a265-03296f4a163e ==============================
[0m09:58:05.294153 [info ] [MainThread]: Running with dbt=1.2.0
[0m09:58:05.295855 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m09:58:05.296065 [debug] [MainThread]: Tracking: tracking
[0m09:58:05.317242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf3bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf3bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf3bf40>]}
[0m09:58:05.387218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:58:05.387731 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/schema.yml
[0m09:58:05.475023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc5a4dc7-c099-493a-a265-03296f4a163e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d11fac0>]}
[0m09:58:05.482399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc5a4dc7-c099-493a-a265-03296f4a163e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfdbc40>]}
[0m09:58:05.482716 [info ] [MainThread]: Found 3 models, 9 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:58:05.482982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc5a4dc7-c099-493a-a265-03296f4a163e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce2f700>]}
[0m09:58:05.484881 [info ] [MainThread]: 
[0m09:58:05.485582 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:58:05.486502 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw_dbt_greg"
[0m09:58:05.496604 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m09:58:05.496823 [debug] [ThreadPool]: On list_rdw_dbt_greg: BEGIN
[0m09:58:05.496967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:08.555421 [debug] [ThreadPool]: SQL status: BEGIN in 3.06 seconds
[0m09:58:08.555717 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m09:58:08.555894 [debug] [ThreadPool]: On list_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw_dbt_greg"} */
select
      'rdw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_greg'
    union all
    select
      'rdw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_greg'
  
[0m09:58:08.876755 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.32 seconds
[0m09:58:08.879139 [debug] [ThreadPool]: On list_rdw_dbt_greg: ROLLBACK
[0m09:58:09.193998 [debug] [ThreadPool]: On list_rdw_dbt_greg: Close
[0m09:58:09.199944 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:09.200157 [debug] [MainThread]: On master: BEGIN
[0m09:58:09.200305 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:58:12.544976 [debug] [MainThread]: SQL status: BEGIN in 3.34 seconds
[0m09:58:12.545218 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:12.545404 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:58:13.852868 [debug] [MainThread]: SQL status: SELECT 1870 in 1.31 seconds
[0m09:58:13.929291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc5a4dc7-c099-493a-a265-03296f4a163e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd61460>]}
[0m09:58:13.929659 [debug] [MainThread]: On master: ROLLBACK
[0m09:58:14.175235 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:14.175496 [debug] [MainThread]: On master: BEGIN
[0m09:58:14.975294 [debug] [MainThread]: SQL status: BEGIN in 0.8 seconds
[0m09:58:14.975557 [debug] [MainThread]: On master: COMMIT
[0m09:58:14.975706 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:14.975815 [debug] [MainThread]: On master: COMMIT
[0m09:58:15.292834 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m09:58:15.293404 [debug] [MainThread]: On master: Close
[0m09:58:15.294227 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:58:15.294622 [info ] [MainThread]: 
[0m09:58:15.301678 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m09:58:15.301982 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m09:58:15.302176 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:58:15.302353 [info ] [Thread-1  ]: 1 of 9 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m09:58:15.302517 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m09:58:15.302750 [info ] [Thread-2  ]: 2 of 9 START test not_null_customers_customer_id ............................... [RUN]
[0m09:58:15.302967 [info ] [Thread-3  ]: 3 of 9 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m09:58:15.303491 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m09:58:15.303685 [info ] [Thread-4  ]: 4 of 9 START test not_null_stg_orders_customer_id .............................. [RUN]
[0m09:58:15.304136 [debug] [Thread-2  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m09:58:15.304984 [debug] [Thread-3  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:58:15.305189 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m09:58:15.305668 [debug] [Thread-4  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m09:58:15.305858 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m09:58:15.306043 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:58:15.306244 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m09:58:15.306415 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m09:58:15.306582 [debug] [Thread-2  ]: Compiling test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m09:58:15.306741 [debug] [Thread-3  ]: Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:58:15.313488 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m09:58:15.313673 [debug] [Thread-4  ]: Compiling test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m09:58:15.323335 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m09:58:15.327216 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:58:15.331457 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m09:58:15.332343 [debug] [Thread-2  ]: finished collecting timing info
[0m09:58:15.332523 [debug] [Thread-3  ]: finished collecting timing info
[0m09:58:15.332643 [debug] [Thread-1  ]: finished collecting timing info
[0m09:58:15.332806 [debug] [Thread-4  ]: finished collecting timing info
[0m09:58:15.332973 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m09:58:15.333181 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:58:15.333370 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m09:58:15.333573 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m09:58:15.349553 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m09:58:15.351643 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:58:15.353630 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m09:58:15.355582 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m09:58:15.356545 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:58:15.356789 [debug] [Thread-2  ]: Using postgres connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m09:58:15.357032 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m09:58:15.357190 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m09:58:15.357338 [debug] [Thread-4  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m09:58:15.357482 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: BEGIN
[0m09:58:15.357635 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: BEGIN
[0m09:58:15.357799 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:58:15.357960 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m09:58:15.358102 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:58:15.358252 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:58:15.358552 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:58:18.792982 [debug] [Thread-2  ]: SQL status: BEGIN in 3.43 seconds
[0m09:58:18.793482 [debug] [Thread-3  ]: SQL status: BEGIN in 3.44 seconds
[0m09:58:18.793678 [debug] [Thread-2  ]: Using postgres connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m09:58:18.793920 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:58:18.794193 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "rdw"."dbt_greg"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m09:58:18.794466 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "rdw"."dbt_greg"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m09:58:18.951434 [debug] [Thread-1  ]: SQL status: BEGIN in 3.59 seconds
[0m09:58:18.951775 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m09:58:18.951991 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "rdw"."dbt_greg"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m09:58:19.109723 [debug] [Thread-4  ]: SQL status: BEGIN in 3.75 seconds
[0m09:58:19.110077 [debug] [Thread-4  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m09:58:19.110306 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "rdw"."dbt_greg"."stg_orders"
where customer_id is null



      
    ) dbt_internal_test
[0m09:58:19.275453 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.48 seconds
[0m09:58:19.275667 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.48 seconds
[0m09:58:19.278502 [debug] [Thread-2  ]: finished collecting timing info
[0m09:58:19.279882 [debug] [Thread-3  ]: finished collecting timing info
[0m09:58:19.280088 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
[0m09:58:19.280264 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m09:58:19.428006 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.48 seconds
[0m09:58:19.429613 [debug] [Thread-1  ]: finished collecting timing info
[0m09:58:19.429823 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: ROLLBACK
[0m09:58:19.586053 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.48 seconds
[0m09:58:19.587880 [debug] [Thread-4  ]: finished collecting timing info
[0m09:58:19.588110 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m09:58:19.746891 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: Close
[0m09:58:19.747125 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m09:58:19.747980 [info ] [Thread-2  ]: 2 of 9 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 4.44s]
[0m09:58:19.748411 [info ] [Thread-3  ]: 3 of 9 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 4.44s]
[0m09:58:19.748928 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m09:58:19.749372 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:58:19.749691 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:58:19.750127 [debug] [Thread-3  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:58:19.750463 [info ] [Thread-2  ]: 5 of 9 START test not_null_stg_orders_order_id ................................. [RUN]
[0m09:58:19.750726 [info ] [Thread-3  ]: 6 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m09:58:19.751448 [debug] [Thread-2  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:58:19.752016 [debug] [Thread-3  ]: Acquiring new postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:58:19.752242 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:58:19.752460 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:58:19.752701 [debug] [Thread-2  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:58:19.752926 [debug] [Thread-3  ]: Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:58:19.759372 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:58:19.765733 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:58:19.766387 [debug] [Thread-2  ]: finished collecting timing info
[0m09:58:19.766609 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:58:19.766781 [debug] [Thread-3  ]: finished collecting timing info
[0m09:58:19.769158 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:58:19.769380 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:58:19.771831 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:58:19.772309 [debug] [Thread-2  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:58:19.772527 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m09:58:19.772726 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:58:19.772954 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:58:19.773305 [debug] [Thread-3  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m09:58:19.773471 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:58:19.905030 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
[0m09:58:19.906137 [info ] [Thread-1  ]: 1 of 9 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 4.60s]
[0m09:58:19.906675 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m09:58:19.906913 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m09:58:19.907198 [info ] [Thread-1  ]: 7 of 9 START test unique_customers_customer_id ................................. [RUN]
[0m09:58:19.907712 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m09:58:19.907941 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m09:58:19.908146 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m09:58:19.915477 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m09:58:19.916010 [debug] [Thread-1  ]: finished collecting timing info
[0m09:58:19.916206 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m09:58:19.918291 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m09:58:19.918794 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m09:58:19.918957 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: BEGIN
[0m09:58:19.919095 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:58:20.063230 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m09:58:20.064402 [info ] [Thread-4  ]: 4 of 9 PASS not_null_stg_orders_customer_id .................................... [[32mPASS[0m in 4.76s]
[0m09:58:20.065054 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m09:58:20.065352 [debug] [Thread-4  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:58:20.065776 [info ] [Thread-4  ]: 8 of 9 START test unique_stg_customers_customer_id ............................. [RUN]
[0m09:58:20.066508 [debug] [Thread-4  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:58:20.066764 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:58:20.066945 [debug] [Thread-4  ]: Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:58:20.071564 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:58:20.072090 [debug] [Thread-4  ]: finished collecting timing info
[0m09:58:20.072265 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:58:20.074339 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:58:20.074800 [debug] [Thread-4  ]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:58:20.074955 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m09:58:20.075087 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m09:58:22.775665 [debug] [Thread-3  ]: SQL status: BEGIN in 3.0 seconds
[0m09:58:22.776036 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:58:22.776329 [debug] [Thread-3  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "rdw"."dbt_greg"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "rdw"."dbt_greg"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:58:22.926322 [debug] [Thread-2  ]: SQL status: BEGIN in 3.15 seconds
[0m09:58:22.926835 [debug] [Thread-2  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:58:22.927069 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "rdw"."dbt_greg"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m09:58:23.084658 [debug] [Thread-4  ]: SQL status: BEGIN in 3.01 seconds
[0m09:58:23.084950 [debug] [Thread-1  ]: SQL status: BEGIN in 3.17 seconds
[0m09:58:23.085266 [debug] [Thread-4  ]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:58:23.085520 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m09:58:23.085745 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "rdw"."dbt_greg"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:58:23.085962 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "rdw"."dbt_greg"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:58:23.242801 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.47 seconds
[0m09:58:23.245076 [debug] [Thread-3  ]: finished collecting timing info
[0m09:58:23.245282 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.32 seconds
[0m09:58:23.245506 [debug] [Thread-3  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m09:58:23.247006 [debug] [Thread-2  ]: finished collecting timing info
[0m09:58:23.247365 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m09:58:23.403192 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.32 seconds
[0m09:58:23.403498 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.32 seconds
[0m09:58:23.405758 [debug] [Thread-4  ]: finished collecting timing info
[0m09:58:23.407289 [debug] [Thread-1  ]: finished collecting timing info
[0m09:58:23.407522 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m09:58:23.407724 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
[0m09:58:23.562541 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m09:58:23.563714 [info ] [Thread-2  ]: 5 of 9 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 3.81s]
[0m09:58:23.564361 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:58:23.564675 [debug] [Thread-2  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:58:23.565050 [info ] [Thread-2  ]: 9 of 9 START test unique_stg_orders_order_id ................................... [RUN]
[0m09:58:23.565727 [debug] [Thread-2  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:58:23.565937 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:58:23.566112 [debug] [Thread-2  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:58:23.570863 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:58:23.571431 [debug] [Thread-2  ]: finished collecting timing info
[0m09:58:23.571619 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:58:23.573851 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:58:23.574337 [debug] [Thread-2  ]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:58:23.574498 [debug] [Thread-2  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m09:58:23.574637 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:58:23.725638 [debug] [Thread-3  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m09:58:23.726417 [info ] [Thread-3  ]: 6 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 3.97s]
[0m09:58:23.726923 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:58:23.881162 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m09:58:23.881520 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: Close
[0m09:58:23.882341 [info ] [Thread-4  ]: 8 of 9 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 3.82s]
[0m09:58:23.882886 [info ] [Thread-1  ]: 7 of 9 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 3.98s]
[0m09:58:23.883339 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:58:23.884033 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m09:58:27.225834 [debug] [Thread-2  ]: SQL status: BEGIN in 3.65 seconds
[0m09:58:27.226125 [debug] [Thread-2  ]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:58:27.226305 [debug] [Thread-2  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "rdw"."dbt_greg"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:58:27.396193 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.17 seconds
[0m09:58:27.398640 [debug] [Thread-2  ]: finished collecting timing info
[0m09:58:27.398931 [debug] [Thread-2  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m09:58:27.714130 [debug] [Thread-2  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m09:58:27.715107 [info ] [Thread-2  ]: 9 of 9 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 4.15s]
[0m09:58:27.715694 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:58:27.717094 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:58:27.717328 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:27.717501 [debug] [MainThread]: On master: BEGIN
[0m09:58:27.717657 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:58:30.728955 [debug] [MainThread]: SQL status: BEGIN in 3.01 seconds
[0m09:58:30.729330 [debug] [MainThread]: On master: COMMIT
[0m09:58:30.729614 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:30.729829 [debug] [MainThread]: On master: COMMIT
[0m09:58:30.896199 [debug] [MainThread]: SQL status: COMMIT in 0.17 seconds
[0m09:58:30.896785 [debug] [MainThread]: On master: Close
[0m09:58:30.897690 [info ] [MainThread]: 
[0m09:58:30.898081 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 25.41 seconds (25.41s).
[0m09:58:30.898437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:58:30.898633 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m09:58:30.898820 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m09:58:30.899002 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m09:58:30.899182 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m09:58:30.908516 [info ] [MainThread]: 
[0m09:58:30.908831 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:58:30.909118 [info ] [MainThread]: 
[0m09:58:30.909341 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m09:58:30.909654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce17400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce17430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdfb340>]}


============================== 2022-07-27 10:03:28.396567 | 6b1edd6b-9e61-4073-9f19-6e6e88a335d4 ==============================
[0m10:03:28.396653 [info ] [MainThread]: Running with dbt=1.2.0
[0m10:03:28.397797 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m10:03:28.398210 [debug] [MainThread]: Tracking: tracking
[0m10:03:28.420578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f0dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f0ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f0f10>]}
[0m10:03:28.492945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:03:28.493932 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/schema.yml
[0m10:03:28.510171 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
[0m10:03:28.526256 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers.sql
[0m10:03:28.529726 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m10:03:28.603476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b1edd6b-9e61-4073-9f19-6e6e88a335d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123cb0d0>]}
[0m10:03:28.611592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b1edd6b-9e61-4073-9f19-6e6e88a335d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f0250>]}
[0m10:03:28.611922 [info ] [MainThread]: Found 3 models, 9 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:03:28.612198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b1edd6b-9e61-4073-9f19-6e6e88a335d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121e7a90>]}
[0m10:03:28.613917 [info ] [MainThread]: 
[0m10:03:28.614413 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:03:28.615154 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw_dbt_greg"
[0m10:03:28.663723 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m10:03:28.663951 [debug] [ThreadPool]: On list_rdw_dbt_greg: BEGIN
[0m10:03:28.664103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:31.659659 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m10:03:31.659964 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m10:03:31.660146 [debug] [ThreadPool]: On list_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw_dbt_greg"} */
select
      'rdw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_greg'
    union all
    select
      'rdw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_greg'
  
[0m10:03:31.998428 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.34 seconds
[0m10:03:32.000205 [debug] [ThreadPool]: On list_rdw_dbt_greg: ROLLBACK
[0m10:03:32.303216 [debug] [ThreadPool]: On list_rdw_dbt_greg: Close
[0m10:03:32.308775 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:32.308991 [debug] [MainThread]: On master: BEGIN
[0m10:03:32.309139 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:03:35.448519 [debug] [MainThread]: SQL status: BEGIN in 3.14 seconds
[0m10:03:35.448889 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:35.449115 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:03:36.905062 [debug] [MainThread]: SQL status: SELECT 1870 in 1.46 seconds
[0m10:03:36.945908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b1edd6b-9e61-4073-9f19-6e6e88a335d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f00a0>]}
[0m10:03:36.946343 [debug] [MainThread]: On master: ROLLBACK
[0m10:03:37.223019 [debug] [MainThread]: On master: Close
[0m10:03:37.223733 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:03:37.224020 [info ] [MainThread]: 
[0m10:03:37.229059 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
[0m10:03:37.229230 [debug] [Thread-2  ]: Began running node model.jaffle_shop.stg_orders
[0m10:03:37.229759 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_customers"
[0m10:03:37.230125 [debug] [Thread-2  ]: Acquiring new postgres connection "model.jaffle_shop.stg_orders"
[0m10:03:37.230316 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
[0m10:03:37.230498 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.stg_orders
[0m10:03:37.230678 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
[0m10:03:37.230831 [debug] [Thread-2  ]: Compiling model.jaffle_shop.stg_orders
[0m10:03:37.232889 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m10:03:37.234551 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m10:03:37.235664 [debug] [Thread-2  ]: finished collecting timing info
[0m10:03:37.235800 [debug] [Thread-1  ]: finished collecting timing info
[0m10:03:37.236025 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.stg_orders
[0m10:03:37.236214 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
[0m10:03:37.236412 [debug] [Thread-2  ]: finished collecting timing info
[0m10:03:37.236642 [debug] [Thread-1  ]: finished collecting timing info
[0m10:03:37.237136 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.stg_orders
[0m10:03:37.237541 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
[0m10:03:37.238020 [debug] [Thread-4  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m10:03:37.238163 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m10:03:37.238288 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m10:03:37.238538 [debug] [Thread-2  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m10:03:37.239112 [debug] [Thread-4  ]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m10:03:37.239443 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m10:03:37.239790 [debug] [Thread-3  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:03:37.240098 [debug] [Thread-2  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m10:03:37.240268 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m10:03:37.240467 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m10:03:37.240653 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m10:03:37.240821 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m10:03:37.240997 [debug] [Thread-4  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m10:03:37.241153 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m10:03:37.241313 [debug] [Thread-3  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m10:03:37.241453 [debug] [Thread-2  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m10:03:37.247859 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m10:03:37.256739 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m10:03:37.260373 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:03:37.266361 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m10:03:37.267569 [debug] [Thread-1  ]: finished collecting timing info
[0m10:03:37.267734 [debug] [Thread-4  ]: finished collecting timing info
[0m10:03:37.267881 [debug] [Thread-3  ]: finished collecting timing info
[0m10:03:37.268073 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m10:03:37.268244 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m10:03:37.268351 [debug] [Thread-2  ]: finished collecting timing info
[0m10:03:37.268487 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m10:03:37.268633 [debug] [Thread-1  ]: finished collecting timing info
[0m10:03:37.268799 [debug] [Thread-4  ]: finished collecting timing info
[0m10:03:37.268955 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m10:03:37.269104 [debug] [Thread-3  ]: finished collecting timing info
[0m10:03:37.269503 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m10:03:37.269851 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m10:03:37.270003 [debug] [Thread-2  ]: finished collecting timing info
[0m10:03:37.270347 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m10:03:37.270526 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m10:03:37.270777 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:03:37.271163 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m10:03:37.271353 [debug] [Thread-3  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m10:03:37.271654 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.customers"
[0m10:03:37.271918 [debug] [Thread-4  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m10:03:37.272086 [debug] [Thread-2  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m10:03:37.272388 [debug] [Thread-3  ]: Acquiring new postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m10:03:37.272521 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m10:03:37.272661 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:03:37.273856 [debug] [Thread-2  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m10:03:37.273993 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m10:03:37.274127 [debug] [Thread-1  ]: Compiling model.jaffle_shop.customers
[0m10:03:37.274248 [debug] [Thread-4  ]: Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:03:37.274381 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m10:03:37.274622 [debug] [Thread-3  ]: Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m10:03:37.276789 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m10:03:37.280065 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m10:03:37.280225 [debug] [Thread-2  ]: Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m10:03:37.284000 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m10:03:37.287123 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m10:03:37.287779 [debug] [Thread-4  ]: finished collecting timing info
[0m10:03:37.288024 [debug] [Thread-1  ]: finished collecting timing info
[0m10:03:37.288206 [debug] [Thread-3  ]: finished collecting timing info
[0m10:03:37.288498 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:03:37.288732 [debug] [Thread-2  ]: finished collecting timing info
[0m10:03:37.288860 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m10:03:37.288989 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m10:03:37.289120 [debug] [Thread-4  ]: finished collecting timing info
[0m10:03:37.289239 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m10:03:37.289359 [debug] [Thread-1  ]: finished collecting timing info
[0m10:03:37.289475 [debug] [Thread-3  ]: finished collecting timing info
[0m10:03:37.289816 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:03:37.289950 [debug] [Thread-2  ]: finished collecting timing info
[0m10:03:37.290343 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m10:03:37.290651 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m10:03:37.291092 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m10:03:37.291583 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7
[0m10:03:37.291692 [debug] [Thread-2  ]: Began running node test.jaffle_shop.unique_customers_first_order_date.3e69458fec
[0m10:03:37.292107 [debug] [Thread-4  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7"
[0m10:03:37.292403 [debug] [Thread-2  ]: Acquiring new postgres connection "test.jaffle_shop.unique_customers_first_order_date.3e69458fec"
[0m10:03:37.292533 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7
[0m10:03:37.292653 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.unique_customers_first_order_date.3e69458fec
[0m10:03:37.292770 [debug] [Thread-4  ]: Compiling test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7
[0m10:03:37.292910 [debug] [Thread-2  ]: Compiling test.jaffle_shop.unique_customers_first_order_date.3e69458fec
[0m10:03:37.296386 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7"
[0m10:03:37.299376 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.unique_customers_first_order_date.3e69458fec"
[0m10:03:37.299794 [debug] [Thread-4  ]: finished collecting timing info
[0m10:03:37.299904 [debug] [Thread-2  ]: finished collecting timing info
[0m10:03:37.300037 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7
[0m10:03:37.300245 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.unique_customers_first_order_date.3e69458fec
[0m10:03:37.300430 [debug] [Thread-4  ]: finished collecting timing info
[0m10:03:37.300568 [debug] [Thread-2  ]: finished collecting timing info
[0m10:03:37.300900 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7
[0m10:03:37.301226 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.unique_customers_first_order_date.3e69458fec
[0m10:03:37.302164 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:37.302285 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m10:03:37.302384 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_customers_first_order_date.3e69458fec' was properly closed.
[0m10:03:37.302478 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7' was properly closed.
[0m10:03:37.302570 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m10:03:37.307648 [info ] [MainThread]: Done.
[0m10:03:37.310842 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
[0m10:03:37.311046 [info ] [MainThread]: Building catalog
[0m10:03:37.312027 [debug] [ThreadPool]: Acquiring new postgres connection "rdw.information_schema"
[0m10:03:37.317931 [debug] [ThreadPool]: Using postgres connection "rdw.information_schema"
[0m10:03:37.318069 [debug] [ThreadPool]: On rdw.information_schema: BEGIN
[0m10:03:37.318173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:40.162025 [debug] [ThreadPool]: SQL status: BEGIN in 2.84 seconds
[0m10:03:40.162341 [debug] [ThreadPool]: Using postgres connection "rdw.information_schema"
[0m10:03:40.162520 [debug] [ThreadPool]: On rdw.information_schema: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "rdw.information_schema"} */

    
    

    select
        'rdw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('dbt_greg'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m10:03:40.502180 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.34 seconds
[0m10:03:40.518777 [debug] [ThreadPool]: On rdw.information_schema: ROLLBACK
[0m10:03:40.820622 [debug] [ThreadPool]: On rdw.information_schema: Close
[0m10:03:40.830118 [info ] [MainThread]: Catalog written to /Users/gpeinke/jaffle_shop/target/catalog.json
[0m10:03:40.830528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f0dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112080ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112080f70>]}
[0m10:03:41.735621 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m10:03:41.735917 [debug] [MainThread]: Connection 'rdw.information_schema' was properly closed.


============================== 2022-07-27 10:03:49.627530 | 5e852c30-b6e0-4ab8-ac01-5c6a5207942d ==============================
[0m10:03:49.627597 [info ] [MainThread]: Running with dbt=1.2.0
[0m10:03:49.628291 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m10:03:49.628491 [debug] [MainThread]: Tracking: tracking
[0m10:03:49.646477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10440ad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10440acd0>]}
[0m10:03:49.650032 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m10:03:49.650414 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m10:03:49.650680 [info ] [MainThread]: 
[0m10:03:49.650910 [info ] [MainThread]: 
[0m10:03:49.651134 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-07-27 10:06:54.788546 | ec5587ca-4658-4de6-a142-22634c8c24eb ==============================
[0m10:06:54.788598 [info ] [MainThread]: Running with dbt=1.2.0
[0m10:06:54.789304 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m10:06:54.789487 [debug] [MainThread]: Tracking: tracking
[0m10:06:54.806544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f5ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f5e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f5efd0>]}
[0m10:06:54.858176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:06:54.858862 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/schema.yml
[0m10:06:54.872647 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
[0m10:06:54.940606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec5587ca-4658-4de6-a142-22634c8c24eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10614a0d0>]}
[0m10:06:54.948007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec5587ca-4658-4de6-a142-22634c8c24eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f84790>]}
[0m10:06:54.948356 [info ] [MainThread]: Found 3 models, 9 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:06:54.948681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec5587ca-4658-4de6-a142-22634c8c24eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e52880>]}
[0m10:06:54.950685 [info ] [MainThread]: 
[0m10:06:54.951248 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:06:54.952301 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw_dbt_greg"
[0m10:06:54.963297 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m10:06:54.963504 [debug] [ThreadPool]: On list_rdw_dbt_greg: BEGIN
[0m10:06:54.963674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:06:58.432702 [debug] [ThreadPool]: SQL status: BEGIN in 3.47 seconds
[0m10:06:58.433256 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m10:06:58.433579 [debug] [ThreadPool]: On list_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw_dbt_greg"} */
select
      'rdw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_greg'
    union all
    select
      'rdw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_greg'
  
[0m10:06:58.758070 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.32 seconds
[0m10:06:58.760401 [debug] [ThreadPool]: On list_rdw_dbt_greg: ROLLBACK
[0m10:06:59.074682 [debug] [ThreadPool]: On list_rdw_dbt_greg: Close
[0m10:06:59.080779 [debug] [MainThread]: Using postgres connection "master"
[0m10:06:59.081021 [debug] [MainThread]: On master: BEGIN
[0m10:06:59.081177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:07:02.136173 [debug] [MainThread]: SQL status: BEGIN in 3.05 seconds
[0m10:07:02.136612 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:02.136863 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:07:04.586728 [debug] [MainThread]: SQL status: SELECT 1870 in 2.45 seconds
[0m10:07:04.667504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec5587ca-4658-4de6-a142-22634c8c24eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615d100>]}
[0m10:07:04.667953 [debug] [MainThread]: On master: ROLLBACK
[0m10:07:04.908111 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:04.908481 [debug] [MainThread]: On master: BEGIN
[0m10:07:05.716022 [debug] [MainThread]: SQL status: BEGIN in 0.81 seconds
[0m10:07:05.716406 [debug] [MainThread]: On master: COMMIT
[0m10:07:05.716659 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:05.716871 [debug] [MainThread]: On master: COMMIT
[0m10:07:06.032867 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m10:07:06.033458 [debug] [MainThread]: On master: Close
[0m10:07:06.034316 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:07:06.034804 [info ] [MainThread]: 
[0m10:07:06.039199 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__completed__return_pending__returned.5e3c5095d1
[0m10:07:06.039460 [info ] [Thread-1  ]: 1 of 9 START test accepted_values_stg_orders_status__placed__completed__return_pending__returned  [RUN]
[0m10:07:06.039970 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__completed__return_pending__returned.5e3c5095d1"
[0m10:07:06.040164 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7
[0m10:07:06.040301 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__completed__return_pending__returned.5e3c5095d1
[0m10:07:06.040420 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:07:06.040591 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m10:07:06.040771 [info ] [Thread-2  ]: 2 of 9 START test not_null_customers_first_order_date .......................... [RUN]
[0m10:07:06.040971 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__completed__return_pending__returned.5e3c5095d1
[0m10:07:06.041139 [info ] [Thread-3  ]: 3 of 9 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m10:07:06.041310 [info ] [Thread-4  ]: 4 of 9 START test not_null_stg_orders_customer_id .............................. [RUN]
[0m10:07:06.041870 [debug] [Thread-2  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7"
[0m10:07:06.048275 [debug] [Thread-3  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m10:07:06.048931 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__completed__return_pending__returned.5e3c5095d1"
[0m10:07:06.049326 [debug] [Thread-4  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m10:07:06.049509 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7
[0m10:07:06.049669 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:07:06.049973 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m10:07:06.050175 [debug] [Thread-2  ]: Compiling test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7
[0m10:07:06.050404 [debug] [Thread-3  ]: Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:07:06.050628 [debug] [Thread-1  ]: finished collecting timing info
[0m10:07:06.050769 [debug] [Thread-4  ]: Compiling test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m10:07:06.060702 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7"
[0m10:07:06.064541 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m10:07:06.064749 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__completed__return_pending__returned.5e3c5095d1
[0m10:07:06.068617 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m10:07:06.085086 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__completed__return_pending__returned.5e3c5095d1"
[0m10:07:06.085435 [debug] [Thread-2  ]: finished collecting timing info
[0m10:07:06.085619 [debug] [Thread-3  ]: finished collecting timing info
[0m10:07:06.085910 [debug] [Thread-4  ]: finished collecting timing info
[0m10:07:06.086152 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7
[0m10:07:06.086383 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:07:06.086596 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__completed__return_pending__returned.5e3c5095d1"
[0m10:07:06.086773 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m10:07:06.088881 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7"
[0m10:07:06.090788 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m10:07:06.090983 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__completed__return_pending__returned.5e3c5095d1: BEGIN
[0m10:07:06.093869 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m10:07:06.094273 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:07:06.094597 [debug] [Thread-2  ]: Using postgres connection "test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7"
[0m10:07:06.095091 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m10:07:06.095263 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7: BEGIN
[0m10:07:06.095399 [debug] [Thread-4  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m10:07:06.095556 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m10:07:06.095753 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:07:06.095908 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m10:07:06.096080 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:07:06.096416 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:07:09.163258 [debug] [Thread-2  ]: SQL status: BEGIN in 3.07 seconds
[0m10:07:09.163566 [debug] [Thread-3  ]: SQL status: BEGIN in 3.07 seconds
[0m10:07:09.163733 [debug] [Thread-2  ]: Using postgres connection "test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7"
[0m10:07:09.163948 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m10:07:09.164135 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_order_date
from "rdw"."dbt_greg"."customers"
where first_order_date is null



      
    ) dbt_internal_test
[0m10:07:09.164306 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "rdw"."dbt_greg"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m10:07:09.320649 [debug] [Thread-1  ]: SQL status: BEGIN in 3.23 seconds
[0m10:07:09.321000 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__completed__return_pending__returned.5e3c5095d1"
[0m10:07:09.321215 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__completed__return_pending__returned.5e3c5095d1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__completed__return_pending__returned.5e3c5095d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "rdw"."dbt_greg"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m10:07:09.479455 [debug] [Thread-4  ]: SQL status: BEGIN in 3.38 seconds
[0m10:07:09.480005 [debug] [Thread-4  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m10:07:09.480342 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "rdw"."dbt_greg"."stg_orders"
where customer_id is null



      
    ) dbt_internal_test
[0m10:07:09.637886 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.47 seconds
[0m10:07:09.638195 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.47 seconds
[0m10:07:09.640997 [debug] [Thread-2  ]: finished collecting timing info
[0m10:07:09.642761 [debug] [Thread-3  ]: finished collecting timing info
[0m10:07:09.642977 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7: ROLLBACK
[0m10:07:09.643155 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m10:07:09.808294 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.49 seconds
[0m10:07:09.810200 [debug] [Thread-1  ]: finished collecting timing info
[0m10:07:09.810487 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__completed__return_pending__returned.5e3c5095d1: ROLLBACK
[0m10:07:09.958310 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.48 seconds
[0m10:07:09.960321 [debug] [Thread-4  ]: finished collecting timing info
[0m10:07:09.960567 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m10:07:10.113335 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7: Close
[0m10:07:10.113687 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m10:07:10.114666 [error] [Thread-2  ]: 2 of 9 FAIL 38 not_null_customers_first_order_date ............................. [[31mFAIL 38[0m in 4.07s]
[0m10:07:10.115097 [info ] [Thread-3  ]: 3 of 9 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 4.07s]
[0m10:07:10.116379 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7
[0m10:07:10.116751 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:07:10.117017 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m10:07:10.117858 [debug] [Thread-3  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m10:07:10.119744 [info ] [Thread-2  ]: 5 of 9 START test not_null_stg_orders_order_id ................................. [RUN]
[0m10:07:10.120889 [info ] [Thread-3  ]: 6 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m10:07:10.121509 [debug] [Thread-2  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:07:10.122103 [debug] [Thread-3  ]: Acquiring new postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m10:07:10.122338 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m10:07:10.122536 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m10:07:10.122714 [debug] [Thread-2  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m10:07:10.122886 [debug] [Thread-3  ]: Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m10:07:10.127120 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:07:10.132603 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m10:07:10.133209 [debug] [Thread-2  ]: finished collecting timing info
[0m10:07:10.133412 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m10:07:10.133583 [debug] [Thread-3  ]: finished collecting timing info
[0m10:07:10.135625 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:07:10.135828 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m10:07:10.137918 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m10:07:10.138340 [debug] [Thread-2  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:07:10.138515 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m10:07:10.138682 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:07:10.139039 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m10:07:10.139217 [debug] [Thread-3  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m10:07:10.139361 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m10:07:10.271339 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__completed__return_pending__returned.5e3c5095d1: Close
[0m10:07:10.272322 [error] [Thread-1  ]: 1 of 9 FAIL 1 accepted_values_stg_orders_status__placed__completed__return_pending__returned  [[31mFAIL 1[0m in 4.23s]
[0m10:07:10.272924 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__completed__return_pending__returned.5e3c5095d1
[0m10:07:10.273234 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_customers_first_order_date.3e69458fec
[0m10:07:10.273567 [info ] [Thread-1  ]: 7 of 9 START test unique_customers_first_order_date ............................ [RUN]
[0m10:07:10.274102 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_customers_first_order_date.3e69458fec"
[0m10:07:10.274294 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_customers_first_order_date.3e69458fec
[0m10:07:10.274472 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_customers_first_order_date.3e69458fec
[0m10:07:10.282041 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_customers_first_order_date.3e69458fec"
[0m10:07:10.282623 [debug] [Thread-1  ]: finished collecting timing info
[0m10:07:10.282801 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_customers_first_order_date.3e69458fec
[0m10:07:10.284865 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.unique_customers_first_order_date.3e69458fec"
[0m10:07:10.285398 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_customers_first_order_date.3e69458fec"
[0m10:07:10.285585 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_first_order_date.3e69458fec: BEGIN
[0m10:07:10.285743 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:07:10.428915 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m10:07:10.430139 [info ] [Thread-4  ]: 4 of 9 PASS not_null_stg_orders_customer_id .................................... [[32mPASS[0m in 4.38s]
[0m10:07:10.430751 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m10:07:10.431052 [debug] [Thread-4  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m10:07:10.431409 [info ] [Thread-4  ]: 8 of 9 START test unique_stg_customers_customer_id ............................. [RUN]
[0m10:07:10.432070 [debug] [Thread-4  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m10:07:10.432326 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m10:07:10.432524 [debug] [Thread-4  ]: Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m10:07:10.437085 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m10:07:10.437596 [debug] [Thread-4  ]: finished collecting timing info
[0m10:07:10.437772 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m10:07:10.439842 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m10:07:10.440324 [debug] [Thread-4  ]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m10:07:10.440490 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m10:07:10.440628 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m10:07:13.908456 [debug] [Thread-3  ]: SQL status: BEGIN in 3.77 seconds
[0m10:07:13.908826 [debug] [Thread-1  ]: SQL status: BEGIN in 3.62 seconds
[0m10:07:13.909031 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m10:07:13.909317 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_customers_first_order_date.3e69458fec"
[0m10:07:13.909507 [debug] [Thread-3  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "rdw"."dbt_greg"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "rdw"."dbt_greg"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:07:13.909683 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_first_order_date.3e69458fec: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_first_order_date.3e69458fec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    first_order_date as unique_field,
    count(*) as n_records

from "rdw"."dbt_greg"."customers"
where first_order_date is not null
group by first_order_date
having count(*) > 1



      
    ) dbt_internal_test
[0m10:07:14.063754 [debug] [Thread-4  ]: SQL status: BEGIN in 3.62 seconds
[0m10:07:14.064022 [debug] [Thread-4  ]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m10:07:14.064183 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "rdw"."dbt_greg"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:07:14.068497 [debug] [Thread-2  ]: SQL status: BEGIN in 3.93 seconds
[0m10:07:14.068773 [debug] [Thread-2  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:07:14.068974 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "rdw"."dbt_greg"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m10:07:14.234299 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.32 seconds
[0m10:07:14.234675 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.32 seconds
[0m10:07:14.236702 [debug] [Thread-3  ]: finished collecting timing info
[0m10:07:14.238364 [debug] [Thread-1  ]: finished collecting timing info
[0m10:07:14.238635 [debug] [Thread-3  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m10:07:14.238859 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_first_order_date.3e69458fec: ROLLBACK
[0m10:07:14.408365 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.34 seconds
[0m10:07:14.410367 [debug] [Thread-4  ]: finished collecting timing info
[0m10:07:14.410608 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m10:07:14.568621 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.5 seconds
[0m10:07:14.571008 [debug] [Thread-2  ]: finished collecting timing info
[0m10:07:14.571304 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m10:07:14.725899 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_first_order_date.3e69458fec: Close
[0m10:07:14.726226 [debug] [Thread-3  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m10:07:14.727089 [error] [Thread-1  ]: 7 of 9 FAIL 13 unique_customers_first_order_date ............................... [[31mFAIL 13[0m in 4.45s]
[0m10:07:14.727749 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_customers_first_order_date.3e69458fec
[0m10:07:14.728166 [info ] [Thread-3  ]: 6 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 4.61s]
[0m10:07:14.728380 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m10:07:14.729001 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m10:07:14.729164 [info ] [Thread-1  ]: 9 of 9 START test unique_stg_orders_order_id ................................... [RUN]
[0m10:07:14.729860 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m10:07:14.730058 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m10:07:14.730242 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m10:07:14.736153 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m10:07:14.736735 [debug] [Thread-1  ]: finished collecting timing info
[0m10:07:14.736921 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m10:07:14.739076 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m10:07:14.739617 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m10:07:14.739783 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m10:07:14.739925 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:07:14.883245 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m10:07:14.884242 [info ] [Thread-4  ]: 8 of 9 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 4.45s]
[0m10:07:14.884857 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m10:07:15.058435 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m10:07:15.059338 [info ] [Thread-2  ]: 5 of 9 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 4.94s]
[0m10:07:15.059830 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m10:07:18.032456 [debug] [Thread-1  ]: SQL status: BEGIN in 3.29 seconds
[0m10:07:18.032982 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m10:07:18.033224 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "rdw"."dbt_greg"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:07:18.358657 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.33 seconds
[0m10:07:18.361056 [debug] [Thread-1  ]: finished collecting timing info
[0m10:07:18.361349 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m10:07:18.676003 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m10:07:18.676998 [info ] [Thread-1  ]: 9 of 9 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 3.95s]
[0m10:07:18.677600 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m10:07:18.679026 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:07:18.679275 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:18.679454 [debug] [MainThread]: On master: BEGIN
[0m10:07:18.679618 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:07:21.732065 [debug] [MainThread]: SQL status: BEGIN in 3.05 seconds
[0m10:07:21.732634 [debug] [MainThread]: On master: COMMIT
[0m10:07:21.732951 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:21.733161 [debug] [MainThread]: On master: COMMIT
[0m10:07:22.058631 [debug] [MainThread]: SQL status: COMMIT in 0.33 seconds
[0m10:07:22.059044 [debug] [MainThread]: On master: Close
[0m10:07:22.059880 [info ] [MainThread]: 
[0m10:07:22.060251 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 27.11 seconds (27.11s).
[0m10:07:22.060544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:07:22.060706 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m10:07:22.060861 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m10:07:22.061031 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m10:07:22.061193 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m10:07:22.068599 [info ] [MainThread]: 
[0m10:07:22.068899 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:07:22.069204 [info ] [MainThread]: 
[0m10:07:22.069441 [error] [MainThread]: [31mFailure in test not_null_customers_first_order_date (models/schema.yml)[0m
[0m10:07:22.069685 [error] [MainThread]:   Got 38 results, configured to fail if != 0
[0m10:07:22.069906 [info ] [MainThread]: 
[0m10:07:22.070129 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/schema.yml/not_null_customers_first_order_date.sql
[0m10:07:22.070353 [info ] [MainThread]: 
[0m10:07:22.070573 [error] [MainThread]: [31mFailure in test accepted_values_stg_orders_status__placed__completed__return_pending__returned (models/schema.yml)[0m
[0m10:07:22.070803 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m10:07:22.071025 [info ] [MainThread]: 
[0m10:07:22.071244 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/schema.yml/accepted_values_stg_orders_a66eab964f1cf5f6babf515912d58fa9.sql
[0m10:07:22.071470 [info ] [MainThread]: 
[0m10:07:22.071685 [error] [MainThread]: [31mFailure in test unique_customers_first_order_date (models/schema.yml)[0m
[0m10:07:22.071915 [error] [MainThread]:   Got 13 results, configured to fail if != 0
[0m10:07:22.072130 [info ] [MainThread]: 
[0m10:07:22.072344 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/schema.yml/unique_customers_first_order_date.sql
[0m10:07:22.072580 [info ] [MainThread]: 
[0m10:07:22.072807 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=3 SKIP=0 TOTAL=9
[0m10:07:22.073119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e353d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e35520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3c2e0>]}


============================== 2022-07-27 11:25:51.254034 | e730f9c8-5f15-4b2c-be6f-5936d5961346 ==============================
[0m11:25:51.254085 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:25:51.255287 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m11:25:51.255446 [debug] [MainThread]: Tracking: tracking
[0m11:25:51.278106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10419bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10419fa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10419fa00>]}
[0m11:25:51.348624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:25:51.349306 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/schema.yml
[0m11:25:51.364582 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
[0m11:25:51.439872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e730f9c8-5f15-4b2c-be6f-5936d5961346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043820d0>]}
[0m11:25:51.448430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e730f9c8-5f15-4b2c-be6f-5936d5961346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041c1eb0>]}
[0m11:25:51.448895 [info ] [MainThread]: Found 3 models, 9 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:25:51.449357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e730f9c8-5f15-4b2c-be6f-5936d5961346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041c1f10>]}
[0m11:25:51.451141 [info ] [MainThread]: 
[0m11:25:51.451591 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:25:51.452512 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw_dbt_greg"
[0m11:25:51.462612 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m11:25:51.462804 [debug] [ThreadPool]: On list_rdw_dbt_greg: BEGIN
[0m11:25:51.462941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:54.511771 [debug] [ThreadPool]: SQL status: BEGIN in 3.05 seconds
[0m11:25:54.512316 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m11:25:54.512550 [debug] [ThreadPool]: On list_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw_dbt_greg"} */
select
      'rdw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_greg'
    union all
    select
      'rdw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_greg'
  
[0m11:25:54.834667 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.32 seconds
[0m11:25:54.836838 [debug] [ThreadPool]: On list_rdw_dbt_greg: ROLLBACK
[0m11:25:55.151980 [debug] [ThreadPool]: On list_rdw_dbt_greg: Close
[0m11:25:55.159627 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:55.159852 [debug] [MainThread]: On master: BEGIN
[0m11:25:55.159996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:25:58.335176 [debug] [MainThread]: SQL status: BEGIN in 3.18 seconds
[0m11:25:58.335410 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:58.335557 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:26:00.117979 [debug] [MainThread]: SQL status: SELECT 1870 in 1.78 seconds
[0m11:26:00.195765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e730f9c8-5f15-4b2c-be6f-5936d5961346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc23a0>]}
[0m11:26:00.196167 [debug] [MainThread]: On master: ROLLBACK
[0m11:26:00.434600 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:00.434958 [debug] [MainThread]: On master: BEGIN
[0m11:26:01.227344 [debug] [MainThread]: SQL status: BEGIN in 0.79 seconds
[0m11:26:01.227677 [debug] [MainThread]: On master: COMMIT
[0m11:26:01.227878 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:01.228047 [debug] [MainThread]: On master: COMMIT
[0m11:26:01.545619 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m11:26:01.546019 [debug] [MainThread]: On master: Close
[0m11:26:01.546859 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:26:01.547250 [info ] [MainThread]: 
[0m11:26:01.553790 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:26:01.554054 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7
[0m11:26:01.554307 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:26:01.554490 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:26:01.554636 [info ] [Thread-1  ]: 1 of 9 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m11:26:01.554883 [info ] [Thread-2  ]: 2 of 9 START test not_null_customers_first_order_date .......................... [RUN]
[0m11:26:01.555098 [info ] [Thread-3  ]: 3 of 9 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m11:26:01.555332 [info ] [Thread-4  ]: 4 of 9 START test not_null_stg_orders_customer_id .............................. [RUN]
[0m11:26:01.555851 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:26:01.556435 [debug] [Thread-2  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7"
[0m11:26:01.556960 [debug] [Thread-3  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:26:01.557453 [debug] [Thread-4  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:26:01.557646 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:26:01.557836 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7
[0m11:26:01.558008 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:26:01.558196 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:26:01.558402 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:26:01.558566 [debug] [Thread-2  ]: Compiling test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7
[0m11:26:01.558720 [debug] [Thread-3  ]: Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:26:01.558896 [debug] [Thread-4  ]: Compiling test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:26:01.565988 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:26:01.576128 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7"
[0m11:26:01.580110 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:26:01.584111 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:26:01.585378 [debug] [Thread-2  ]: finished collecting timing info
[0m11:26:01.585599 [debug] [Thread-3  ]: finished collecting timing info
[0m11:26:01.585764 [debug] [Thread-1  ]: finished collecting timing info
[0m11:26:01.585914 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7
[0m11:26:01.586119 [debug] [Thread-4  ]: finished collecting timing info
[0m11:26:01.586254 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:26:01.586451 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:26:01.603078 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7"
[0m11:26:01.603325 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:26:01.605509 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:26:01.607515 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:26:01.610999 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:26:01.611819 [debug] [Thread-2  ]: Using postgres connection "test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7"
[0m11:26:01.612234 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:26:01.612402 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7: BEGIN
[0m11:26:01.612626 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m11:26:01.612790 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:26:01.612982 [debug] [Thread-4  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:26:01.613142 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:26:01.613289 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:26:01.613695 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m11:26:01.614043 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: BEGIN
[0m11:26:01.614210 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:26:01.614417 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:26:04.241077 [debug] [Thread-3  ]: SQL status: BEGIN in 2.63 seconds
[0m11:26:04.241371 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:26:04.241548 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "rdw"."dbt_greg"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m11:26:04.249521 [debug] [Thread-2  ]: SQL status: BEGIN in 2.64 seconds
[0m11:26:04.250027 [debug] [Thread-2  ]: Using postgres connection "test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7"
[0m11:26:04.250323 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_order_date
from "rdw"."dbt_greg"."customers"
where first_order_date is null



      
    ) dbt_internal_test
[0m11:26:04.399416 [debug] [Thread-1  ]: SQL status: BEGIN in 2.78 seconds
[0m11:26:04.399772 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:26:04.399994 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "rdw"."dbt_greg"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m11:26:04.407577 [debug] [Thread-4  ]: SQL status: BEGIN in 2.79 seconds
[0m11:26:04.407932 [debug] [Thread-4  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:26:04.408153 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "rdw"."dbt_greg"."stg_orders"
where customer_id is null



      
    ) dbt_internal_test
[0m11:26:04.557848 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.32 seconds
[0m11:26:04.560668 [debug] [Thread-3  ]: finished collecting timing info
[0m11:26:04.560901 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m11:26:04.566109 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.32 seconds
[0m11:26:04.568075 [debug] [Thread-2  ]: finished collecting timing info
[0m11:26:04.568315 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7: ROLLBACK
[0m11:26:04.716501 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.32 seconds
[0m11:26:04.718547 [debug] [Thread-1  ]: finished collecting timing info
[0m11:26:04.718779 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: ROLLBACK
[0m11:26:04.719899 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.31 seconds
[0m11:26:04.722136 [debug] [Thread-4  ]: finished collecting timing info
[0m11:26:04.722386 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m11:26:04.874221 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m11:26:04.875224 [info ] [Thread-3  ]: 3 of 9 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 3.32s]
[0m11:26:04.875829 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:26:04.876069 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:26:04.876403 [info ] [Thread-3  ]: 5 of 9 START test not_null_stg_orders_order_id ................................. [RUN]
[0m11:26:04.876928 [debug] [Thread-3  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:26:04.877125 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:26:04.877309 [debug] [Thread-3  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:26:04.881863 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:26:04.882025 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7: Close
[0m11:26:04.882769 [error] [Thread-2  ]: 2 of 9 FAIL 38 not_null_customers_first_order_date ............................. [[31mFAIL 38[0m in 3.33s]
[0m11:26:04.882993 [debug] [Thread-3  ]: finished collecting timing info
[0m11:26:04.883353 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_customers_first_order_date.85f4e381c7
[0m11:26:04.883583 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:26:04.883809 [debug] [Thread-2  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:26:04.886174 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:26:04.886398 [info ] [Thread-2  ]: 6 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m11:26:04.887111 [debug] [Thread-2  ]: Acquiring new postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m11:26:04.887311 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:26:04.887556 [debug] [Thread-2  ]: Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:26:04.893052 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:26:04.894242 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m11:26:04.894388 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m11:26:04.894732 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:26:04.895289 [debug] [Thread-2  ]: finished collecting timing info
[0m11:26:04.895552 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:26:04.897910 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m11:26:04.898462 [debug] [Thread-2  ]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m11:26:04.898627 [debug] [Thread-2  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m11:26:04.898769 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:26:05.032439 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
[0m11:26:05.033228 [info ] [Thread-1  ]: 1 of 9 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 3.48s]
[0m11:26:05.033732 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:26:05.033969 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_customers_first_order_date.3e69458fec
[0m11:26:05.034254 [info ] [Thread-1  ]: 7 of 9 START test unique_customers_first_order_date ............................ [RUN]
[0m11:26:05.034742 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_customers_first_order_date.3e69458fec"
[0m11:26:05.034931 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_customers_first_order_date.3e69458fec
[0m11:26:05.035108 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_customers_first_order_date.3e69458fec
[0m11:26:05.042759 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m11:26:05.043098 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_customers_first_order_date.3e69458fec"
[0m11:26:05.043708 [info ] [Thread-4  ]: 4 of 9 PASS not_null_stg_orders_customer_id .................................... [[32mPASS[0m in 3.49s]
[0m11:26:05.044069 [debug] [Thread-1  ]: finished collecting timing info
[0m11:26:05.044316 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:26:05.044506 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_customers_first_order_date.3e69458fec
[0m11:26:05.044733 [debug] [Thread-4  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:26:05.046955 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.unique_customers_first_order_date.3e69458fec"
[0m11:26:05.047158 [info ] [Thread-4  ]: 8 of 9 START test unique_stg_customers_customer_id ............................. [RUN]
[0m11:26:05.047769 [debug] [Thread-4  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:26:05.047956 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:26:05.048108 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_customers_first_order_date.3e69458fec"
[0m11:26:05.048278 [debug] [Thread-4  ]: Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:26:05.048442 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_first_order_date.3e69458fec: BEGIN
[0m11:26:05.052435 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:26:05.052644 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:26:05.053191 [debug] [Thread-4  ]: finished collecting timing info
[0m11:26:05.053374 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:26:05.055634 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:26:05.056189 [debug] [Thread-4  ]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:26:05.056353 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m11:26:05.056491 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:26:07.574993 [debug] [Thread-3  ]: SQL status: BEGIN in 2.68 seconds
[0m11:26:07.575295 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:26:07.575477 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "rdw"."dbt_greg"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m11:26:07.739330 [debug] [Thread-2  ]: SQL status: BEGIN in 2.84 seconds
[0m11:26:07.739839 [debug] [Thread-2  ]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m11:26:07.740074 [debug] [Thread-2  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "rdw"."dbt_greg"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "rdw"."dbt_greg"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:26:07.891667 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.32 seconds
[0m11:26:07.893725 [debug] [Thread-3  ]: finished collecting timing info
[0m11:26:07.893968 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m11:26:07.897585 [debug] [Thread-4  ]: SQL status: BEGIN in 2.84 seconds
[0m11:26:07.897803 [debug] [Thread-4  ]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:26:07.897978 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "rdw"."dbt_greg"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:26:08.050276 [debug] [Thread-1  ]: SQL status: BEGIN in 3.0 seconds
[0m11:26:08.050636 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_customers_first_order_date.3e69458fec"
[0m11:26:08.050886 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_first_order_date.3e69458fec: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_first_order_date.3e69458fec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    first_order_date as unique_field,
    count(*) as n_records

from "rdw"."dbt_greg"."customers"
where first_order_date is not null
group by first_order_date
having count(*) > 1



      
    ) dbt_internal_test
[0m11:26:08.057315 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.32 seconds
[0m11:26:08.059131 [debug] [Thread-2  ]: finished collecting timing info
[0m11:26:08.059371 [debug] [Thread-2  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m11:26:08.208372 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m11:26:08.209359 [info ] [Thread-3  ]: 5 of 9 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 3.33s]
[0m11:26:08.210000 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:26:08.210247 [debug] [Thread-3  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:26:08.210540 [info ] [Thread-3  ]: 9 of 9 START test unique_stg_orders_order_id ................................... [RUN]
[0m11:26:08.211095 [debug] [Thread-3  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:26:08.211302 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:26:08.211487 [debug] [Thread-3  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:26:08.217991 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:26:08.218172 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.32 seconds
[0m11:26:08.219780 [debug] [Thread-4  ]: finished collecting timing info
[0m11:26:08.220075 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m11:26:08.220207 [debug] [Thread-3  ]: finished collecting timing info
[0m11:26:08.220501 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:26:08.222740 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:26:08.223247 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:26:08.223410 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m11:26:08.223551 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:26:08.255915 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.2 seconds
[0m11:26:08.258257 [debug] [Thread-1  ]: finished collecting timing info
[0m11:26:08.258567 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_first_order_date.3e69458fec: ROLLBACK
[0m11:26:08.373417 [debug] [Thread-2  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m11:26:08.374382 [info ] [Thread-2  ]: 6 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 3.49s]
[0m11:26:08.375334 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:26:08.524691 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m11:26:08.525717 [info ] [Thread-4  ]: 8 of 9 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 3.48s]
[0m11:26:08.526256 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:26:08.531226 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_first_order_date.3e69458fec: Close
[0m11:26:08.531979 [error] [Thread-1  ]: 7 of 9 FAIL 13 unique_customers_first_order_date ............................... [[31mFAIL 13[0m in 3.50s]
[0m11:26:08.532536 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_customers_first_order_date.3e69458fec
[0m11:26:11.554173 [debug] [Thread-3  ]: SQL status: BEGIN in 3.33 seconds
[0m11:26:11.554703 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:26:11.555037 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "rdw"."dbt_greg"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:26:11.873328 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.32 seconds
[0m11:26:11.875707 [debug] [Thread-3  ]: finished collecting timing info
[0m11:26:11.875987 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m11:26:12.191879 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m11:26:12.192956 [info ] [Thread-3  ]: 9 of 9 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 3.98s]
[0m11:26:12.193766 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:26:12.195249 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:26:12.195474 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:12.195619 [debug] [MainThread]: On master: BEGIN
[0m11:26:12.195748 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:26:15.377002 [debug] [MainThread]: SQL status: BEGIN in 3.18 seconds
[0m11:26:15.377311 [debug] [MainThread]: On master: COMMIT
[0m11:26:15.377489 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:15.377648 [debug] [MainThread]: On master: COMMIT
[0m11:26:15.695359 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m11:26:15.695751 [debug] [MainThread]: On master: Close
[0m11:26:15.696513 [info ] [MainThread]: 
[0m11:26:15.696824 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 24.25 seconds (24.25s).
[0m11:26:15.697183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:26:15.697339 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_customers_first_order_date.3e69458fec' was properly closed.
[0m11:26:15.697486 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m11:26:15.697630 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m11:26:15.697771 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m11:26:15.705307 [info ] [MainThread]: 
[0m11:26:15.705589 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:26:15.705862 [info ] [MainThread]: 
[0m11:26:15.706093 [error] [MainThread]: [31mFailure in test not_null_customers_first_order_date (models/schema.yml)[0m
[0m11:26:15.706333 [error] [MainThread]:   Got 38 results, configured to fail if != 0
[0m11:26:15.706551 [info ] [MainThread]: 
[0m11:26:15.706765 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/schema.yml/not_null_customers_first_order_date.sql
[0m11:26:15.706983 [info ] [MainThread]: 
[0m11:26:15.707195 [error] [MainThread]: [31mFailure in test unique_customers_first_order_date (models/schema.yml)[0m
[0m11:26:15.707417 [error] [MainThread]:   Got 13 results, configured to fail if != 0
[0m11:26:15.707624 [info ] [MainThread]: 
[0m11:26:15.707833 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/schema.yml/unique_customers_first_order_date.sql
[0m11:26:15.708059 [info ] [MainThread]: 
[0m11:26:15.708276 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m11:26:15.708575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10406e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10406e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10407a6d0>]}


============================== 2022-07-27 11:31:20.135673 | 57177364-9a65-4bef-ad17-fb6fb334fd0e ==============================
[0m11:31:20.135793 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:31:20.136998 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m11:31:20.137179 [debug] [MainThread]: Tracking: tracking
[0m11:31:20.156996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112da7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112da72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112da7fd0>]}
[0m11:31:20.226262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:31:20.226873 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/schema.yml
[0m11:31:20.241547 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m11:31:20.286520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57177364-9a65-4bef-ad17-fb6fb334fd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f81fd0>]}
[0m11:31:20.294001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57177364-9a65-4bef-ad17-fb6fb334fd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112da7f10>]}
[0m11:31:20.294315 [info ] [MainThread]: Found 3 models, 9 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:31:20.294581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57177364-9a65-4bef-ad17-fb6fb334fd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112daa880>]}
[0m11:31:20.296330 [info ] [MainThread]: 
[0m11:31:20.296820 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:31:20.297719 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw_dbt_greg"
[0m11:31:20.307539 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m11:31:20.307725 [debug] [ThreadPool]: On list_rdw_dbt_greg: BEGIN
[0m11:31:20.307865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:23.374497 [debug] [ThreadPool]: SQL status: BEGIN in 3.07 seconds
[0m11:31:23.374776 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m11:31:23.374941 [debug] [ThreadPool]: On list_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw_dbt_greg"} */
select
      'rdw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_greg'
    union all
    select
      'rdw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_greg'
  
[0m11:31:23.545696 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.17 seconds
[0m11:31:23.547868 [debug] [ThreadPool]: On list_rdw_dbt_greg: ROLLBACK
[0m11:31:23.874476 [debug] [ThreadPool]: On list_rdw_dbt_greg: Close
[0m11:31:23.879460 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:23.879659 [debug] [MainThread]: On master: BEGIN
[0m11:31:23.879829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:31:27.274499 [debug] [MainThread]: SQL status: BEGIN in 3.39 seconds
[0m11:31:27.274797 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:27.275035 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:31:29.048352 [debug] [MainThread]: SQL status: SELECT 1870 in 1.77 seconds
[0m11:31:29.131306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57177364-9a65-4bef-ad17-fb6fb334fd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c30df0>]}
[0m11:31:29.131669 [debug] [MainThread]: On master: ROLLBACK
[0m11:31:29.374577 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:29.374939 [debug] [MainThread]: On master: BEGIN
[0m11:31:30.157004 [debug] [MainThread]: SQL status: BEGIN in 0.78 seconds
[0m11:31:30.157386 [debug] [MainThread]: On master: COMMIT
[0m11:31:30.157626 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:30.157932 [debug] [MainThread]: On master: COMMIT
[0m11:31:30.476880 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m11:31:30.477184 [debug] [MainThread]: On master: Close
[0m11:31:30.477685 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:31:30.477950 [info ] [MainThread]: 
[0m11:31:30.482084 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:31:30.482249 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m11:31:30.482368 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:31:30.482484 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:31:30.482654 [info ] [Thread-1  ]: 1 of 9 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m11:31:30.482816 [info ] [Thread-2  ]: 2 of 9 START test not_null_customers_customer_id ............................... [RUN]
[0m11:31:30.482979 [info ] [Thread-3  ]: 3 of 9 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m11:31:30.483157 [info ] [Thread-4  ]: 4 of 9 START test not_null_stg_orders_customer_id .............................. [RUN]
[0m11:31:30.483576 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:31:30.483947 [debug] [Thread-2  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m11:31:30.484387 [debug] [Thread-3  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:31:30.484752 [debug] [Thread-4  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:31:30.484900 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:31:30.485064 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m11:31:30.485209 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:31:30.485347 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:31:30.485504 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:31:30.485644 [debug] [Thread-2  ]: Compiling test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m11:31:30.485776 [debug] [Thread-3  ]: Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:31:30.485900 [debug] [Thread-4  ]: Compiling test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:31:30.498650 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:31:30.506387 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m11:31:30.509925 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:31:30.513191 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:31:30.513955 [debug] [Thread-1  ]: finished collecting timing info
[0m11:31:30.514146 [debug] [Thread-2  ]: finished collecting timing info
[0m11:31:30.514278 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:31:30.514521 [debug] [Thread-3  ]: finished collecting timing info
[0m11:31:30.514623 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m11:31:30.514712 [debug] [Thread-4  ]: finished collecting timing info
[0m11:31:30.529245 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:31:30.529450 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:31:30.531276 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m11:31:30.531445 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:31:30.533292 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:31:30.535330 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:31:30.535553 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:31:30.535837 [debug] [Thread-2  ]: Using postgres connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m11:31:30.536203 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: BEGIN
[0m11:31:30.536385 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:31:30.536590 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: BEGIN
[0m11:31:30.536724 [debug] [Thread-4  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:31:30.536873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:31:30.537027 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m11:31:30.537171 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:31:30.537304 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m11:31:30.537667 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:31:30.538008 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:31:33.500843 [debug] [Thread-3  ]: SQL status: BEGIN in 2.96 seconds
[0m11:31:33.501171 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:31:33.501375 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "rdw"."dbt_greg"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m11:31:33.674620 [debug] [Thread-1  ]: SQL status: BEGIN in 3.14 seconds
[0m11:31:33.674996 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:31:33.675270 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "rdw"."dbt_greg"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m11:31:33.824583 [debug] [Thread-4  ]: SQL status: BEGIN in 3.29 seconds
[0m11:31:33.824922 [debug] [Thread-4  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:31:33.825139 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "rdw"."dbt_greg"."stg_orders"
where customer_id is null



      
    ) dbt_internal_test
[0m11:31:33.976426 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.47 seconds
[0m11:31:33.976663 [debug] [Thread-2  ]: SQL status: BEGIN in 3.44 seconds
[0m11:31:33.980239 [debug] [Thread-3  ]: finished collecting timing info
[0m11:31:33.980564 [debug] [Thread-2  ]: Using postgres connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m11:31:33.980795 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m11:31:33.980995 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "rdw"."dbt_greg"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m11:31:34.134422 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.46 seconds
[0m11:31:34.136844 [debug] [Thread-1  ]: finished collecting timing info
[0m11:31:34.137138 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: ROLLBACK
[0m11:31:34.292156 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.47 seconds
[0m11:31:34.293859 [debug] [Thread-4  ]: finished collecting timing info
[0m11:31:34.294087 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m11:31:34.453579 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m11:31:34.453744 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.47 seconds
[0m11:31:34.455513 [debug] [Thread-2  ]: finished collecting timing info
[0m11:31:34.455881 [info ] [Thread-3  ]: 3 of 9 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 3.97s]
[0m11:31:34.456083 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
[0m11:31:34.456500 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:31:34.456848 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:31:34.457147 [info ] [Thread-3  ]: 5 of 9 START test not_null_stg_orders_order_id ................................. [RUN]
[0m11:31:34.457727 [debug] [Thread-3  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:31:34.457879 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:31:34.458058 [debug] [Thread-3  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:31:34.462056 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:31:34.462581 [debug] [Thread-3  ]: finished collecting timing info
[0m11:31:34.462778 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:31:34.466141 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:31:34.466652 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:31:34.466796 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m11:31:34.466918 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:31:34.624538 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
[0m11:31:34.625644 [info ] [Thread-1  ]: 1 of 9 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 4.14s]
[0m11:31:34.626250 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:31:34.626500 [debug] [Thread-1  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:31:34.626816 [info ] [Thread-1  ]: 6 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m11:31:34.627478 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m11:31:34.627685 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:31:34.627878 [debug] [Thread-1  ]: Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:31:34.637590 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m11:31:34.638112 [debug] [Thread-1  ]: finished collecting timing info
[0m11:31:34.638289 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:31:34.640329 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m11:31:34.640818 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m11:31:34.640979 [debug] [Thread-1  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m11:31:34.641117 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:31:34.774567 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m11:31:34.775493 [info ] [Thread-4  ]: 4 of 9 PASS not_null_stg_orders_customer_id .................................... [[32mPASS[0m in 4.29s]
[0m11:31:34.776089 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:31:34.776480 [debug] [Thread-4  ]: Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m11:31:34.776896 [info ] [Thread-4  ]: 7 of 9 START test unique_customers_customer_id ................................. [RUN]
[0m11:31:34.777500 [debug] [Thread-4  ]: Acquiring new postgres connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m11:31:34.777709 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m11:31:34.777891 [debug] [Thread-4  ]: Compiling test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m11:31:34.785921 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m11:31:34.787297 [debug] [Thread-4  ]: finished collecting timing info
[0m11:31:34.787516 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m11:31:34.790000 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m11:31:34.790663 [debug] [Thread-4  ]: Using postgres connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m11:31:34.790843 [debug] [Thread-4  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: BEGIN
[0m11:31:34.790987 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:31:34.928165 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: Close
[0m11:31:34.928972 [info ] [Thread-2  ]: 2 of 9 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 4.45s]
[0m11:31:34.929717 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m11:31:34.929959 [debug] [Thread-2  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:31:34.930274 [info ] [Thread-2  ]: 8 of 9 START test unique_stg_customers_customer_id ............................. [RUN]
[0m11:31:34.930820 [debug] [Thread-2  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:31:34.930989 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:31:34.931142 [debug] [Thread-2  ]: Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:31:34.935560 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:31:34.936142 [debug] [Thread-2  ]: finished collecting timing info
[0m11:31:34.936379 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:31:34.938902 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:31:34.939576 [debug] [Thread-2  ]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:31:34.939752 [debug] [Thread-2  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m11:31:34.939894 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:31:37.824408 [debug] [Thread-3  ]: SQL status: BEGIN in 3.36 seconds
[0m11:31:37.824627 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:31:37.824754 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "rdw"."dbt_greg"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m11:31:37.979042 [debug] [Thread-1  ]: SQL status: BEGIN in 3.34 seconds
[0m11:31:37.979310 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m11:31:37.979474 [debug] [Thread-1  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "rdw"."dbt_greg"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "rdw"."dbt_greg"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:31:38.137048 [debug] [Thread-4  ]: SQL status: BEGIN in 3.35 seconds
[0m11:31:38.137263 [debug] [Thread-4  ]: Using postgres connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m11:31:38.137382 [debug] [Thread-4  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "rdw"."dbt_greg"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:31:38.294913 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.47 seconds
[0m11:31:38.295165 [debug] [Thread-2  ]: SQL status: BEGIN in 3.36 seconds
[0m11:31:38.296695 [debug] [Thread-3  ]: finished collecting timing info
[0m11:31:38.296890 [debug] [Thread-2  ]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:31:38.297127 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m11:31:38.297300 [debug] [Thread-2  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "rdw"."dbt_greg"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:31:38.452950 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.47 seconds
[0m11:31:38.455841 [debug] [Thread-1  ]: finished collecting timing info
[0m11:31:38.456108 [debug] [Thread-1  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m11:31:38.582950 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.45 seconds
[0m11:31:38.584524 [debug] [Thread-4  ]: finished collecting timing info
[0m11:31:38.584730 [debug] [Thread-4  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
[0m11:31:38.628091 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m11:31:38.628542 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.33 seconds
[0m11:31:38.631434 [debug] [Thread-2  ]: finished collecting timing info
[0m11:31:38.632878 [debug] [Thread-2  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m11:31:38.632246 [info ] [Thread-3  ]: 5 of 9 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 4.17s]
[0m11:31:38.634294 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:31:38.634931 [debug] [Thread-3  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:31:38.635509 [info ] [Thread-3  ]: 9 of 9 START test unique_stg_orders_order_id ................................... [RUN]
[0m11:31:38.636768 [debug] [Thread-3  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:31:38.637130 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:31:38.637446 [debug] [Thread-3  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:31:38.645141 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:31:38.645905 [debug] [Thread-3  ]: finished collecting timing info
[0m11:31:38.646279 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:31:38.649748 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:31:38.650644 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:31:38.650929 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m11:31:38.651278 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:31:38.774489 [debug] [Thread-1  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m11:31:38.775545 [info ] [Thread-1  ]: 6 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 4.15s]
[0m11:31:38.776149 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:31:38.898970 [debug] [Thread-4  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: Close
[0m11:31:38.899975 [info ] [Thread-4  ]: 7 of 9 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 4.12s]
[0m11:31:38.900609 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m11:31:39.074558 [debug] [Thread-2  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m11:31:39.075718 [info ] [Thread-2  ]: 8 of 9 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 4.15s]
[0m11:31:39.076302 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:31:42.282511 [debug] [Thread-3  ]: SQL status: BEGIN in 3.63 seconds
[0m11:31:42.283647 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:31:42.283988 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "rdw"."dbt_greg"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:31:42.602145 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.32 seconds
[0m11:31:42.603938 [debug] [Thread-3  ]: finished collecting timing info
[0m11:31:42.604172 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m11:31:42.924416 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m11:31:42.924999 [info ] [Thread-3  ]: 9 of 9 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 4.29s]
[0m11:31:42.925340 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:31:42.927134 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:31:42.927331 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:42.927451 [debug] [MainThread]: On master: BEGIN
[0m11:31:42.927556 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:31:45.924563 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m11:31:45.924937 [debug] [MainThread]: On master: COMMIT
[0m11:31:45.925147 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:45.925405 [debug] [MainThread]: On master: COMMIT
[0m11:31:46.091608 [debug] [MainThread]: SQL status: COMMIT in 0.17 seconds
[0m11:31:46.091957 [debug] [MainThread]: On master: Close
[0m11:31:46.092800 [info ] [MainThread]: 
[0m11:31:46.093478 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 25.80 seconds (25.80s).
[0m11:31:46.093958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:31:46.094137 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m11:31:46.094354 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m11:31:46.094490 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m11:31:46.094619 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m11:31:46.103177 [info ] [MainThread]: 
[0m11:31:46.103470 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:31:46.103753 [info ] [MainThread]: 
[0m11:31:46.103979 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m11:31:46.104325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113146f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113146e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113146f10>]}


============================== 2022-07-27 11:32:08.502908 | 3cd47fbd-fabf-471e-a231-a128e0b0c2cd ==============================
[0m11:32:08.502954 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:32:08.504007 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['models/staging'], 'which': 'test', 'rpc_method': 'test'}
[0m11:32:08.504180 [debug] [MainThread]: Tracking: tracking
[0m11:32:08.524175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fae4c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fad4850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fad4820>]}
[0m11:32:08.594809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:32:08.595009 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:32:08.602588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cd47fbd-fabf-471e-a231-a128e0b0c2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc340d0>]}
[0m11:32:08.611973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cd47fbd-fabf-471e-a231-a128e0b0c2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb40190>]}
[0m11:32:08.612382 [info ] [MainThread]: Found 3 models, 9 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:32:08.612681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cd47fbd-fabf-471e-a231-a128e0b0c2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb400a0>]}
[0m11:32:08.615006 [info ] [MainThread]: 
[0m11:32:08.615563 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:32:08.616609 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw_dbt_greg"
[0m11:32:08.629854 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m11:32:08.630288 [debug] [ThreadPool]: On list_rdw_dbt_greg: BEGIN
[0m11:32:08.630455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:11.850461 [debug] [ThreadPool]: SQL status: BEGIN in 3.22 seconds
[0m11:32:11.850754 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m11:32:11.850932 [debug] [ThreadPool]: On list_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw_dbt_greg"} */
select
      'rdw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_greg'
    union all
    select
      'rdw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_greg'
  
[0m11:32:12.024615 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.17 seconds
[0m11:32:12.027157 [debug] [ThreadPool]: On list_rdw_dbt_greg: ROLLBACK
[0m11:32:12.351777 [debug] [ThreadPool]: On list_rdw_dbt_greg: Close
[0m11:32:12.359397 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:12.359704 [debug] [MainThread]: On master: BEGIN
[0m11:32:12.359915 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:32:15.349784 [debug] [MainThread]: SQL status: BEGIN in 2.99 seconds
[0m11:32:15.350003 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:15.350119 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:32:16.674384 [debug] [MainThread]: SQL status: SELECT 1870 in 1.32 seconds
[0m11:32:16.708014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cd47fbd-fabf-471e-a231-a128e0b0c2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcf4460>]}
[0m11:32:16.708590 [debug] [MainThread]: On master: ROLLBACK
[0m11:32:16.977568 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:16.977826 [debug] [MainThread]: On master: BEGIN
[0m11:32:17.782819 [debug] [MainThread]: SQL status: BEGIN in 0.8 seconds
[0m11:32:17.783152 [debug] [MainThread]: On master: COMMIT
[0m11:32:17.783369 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:17.783550 [debug] [MainThread]: On master: COMMIT
[0m11:32:18.100442 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m11:32:18.100779 [debug] [MainThread]: On master: Close
[0m11:32:18.101405 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:32:18.101738 [info ] [MainThread]: 
[0m11:32:18.107075 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:32:18.107342 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m11:32:18.107503 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:32:18.107745 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:32:18.107896 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:32:18.108341 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:32:18.108536 [info ] [Thread-2  ]: 2 of 7 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m11:32:18.108739 [info ] [Thread-3  ]: 3 of 7 START test not_null_stg_orders_customer_id .............................. [RUN]
[0m11:32:18.108932 [info ] [Thread-4  ]: 4 of 7 START test not_null_stg_orders_order_id ................................. [RUN]
[0m11:32:18.109119 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:32:18.109616 [debug] [Thread-2  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:32:18.110123 [debug] [Thread-3  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:32:18.110591 [debug] [Thread-4  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:32:18.110814 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:32:18.111026 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:32:18.111218 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:32:18.111397 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:32:18.167654 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:32:18.167889 [debug] [Thread-2  ]: Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:32:18.168074 [debug] [Thread-3  ]: Compiling test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:32:18.168236 [debug] [Thread-4  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:32:18.178629 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:32:18.182726 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:32:18.182969 [debug] [Thread-1  ]: finished collecting timing info
[0m11:32:18.186734 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:32:18.187224 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:32:18.187571 [debug] [Thread-2  ]: finished collecting timing info
[0m11:32:18.194173 [debug] [Thread-3  ]: finished collecting timing info
[0m11:32:18.200456 [debug] [Thread-4  ]: finished collecting timing info
[0m11:32:18.200628 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:32:18.204540 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:32:18.204747 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:32:18.204917 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:32:18.206933 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:32:18.208924 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:32:18.210789 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:32:18.211278 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:32:18.211670 [debug] [Thread-2  ]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:32:18.211866 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:32:18.212152 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: BEGIN
[0m11:32:18.212379 [debug] [Thread-4  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:32:18.212480 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m11:32:18.212624 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m11:32:18.212762 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:32:18.212931 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m11:32:18.213086 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:32:18.213231 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:32:18.213686 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:32:21.281252 [debug] [Thread-1  ]: SQL status: BEGIN in 3.07 seconds
[0m11:32:21.281521 [debug] [Thread-4  ]: SQL status: BEGIN in 3.07 seconds
[0m11:32:21.281818 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:32:21.282094 [debug] [Thread-4  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:32:21.282417 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "rdw"."dbt_greg"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m11:32:21.282640 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "rdw"."dbt_greg"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m11:32:21.439437 [debug] [Thread-3  ]: SQL status: BEGIN in 3.23 seconds
[0m11:32:21.439822 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:32:21.440071 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "rdw"."dbt_greg"."stg_orders"
where customer_id is null



      
    ) dbt_internal_test
[0m11:32:21.441860 [debug] [Thread-2  ]: SQL status: BEGIN in 3.23 seconds
[0m11:32:21.442080 [debug] [Thread-2  ]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:32:21.442254 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "rdw"."dbt_greg"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m11:32:21.599718 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.32 seconds
[0m11:32:21.599894 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.32 seconds
[0m11:32:21.601768 [debug] [Thread-4  ]: finished collecting timing info
[0m11:32:21.602862 [debug] [Thread-1  ]: finished collecting timing info
[0m11:32:21.603054 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m11:32:21.603220 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: ROLLBACK
[0m11:32:21.774495 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.33 seconds
[0m11:32:21.776696 [debug] [Thread-3  ]: finished collecting timing info
[0m11:32:21.776972 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m11:32:21.924567 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.48 seconds
[0m11:32:21.926754 [debug] [Thread-2  ]: finished collecting timing info
[0m11:32:21.927015 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m11:32:22.081743 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m11:32:22.081917 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
[0m11:32:22.082604 [info ] [Thread-4  ]: 4 of 7 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 3.97s]
[0m11:32:22.082951 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 3.97s]
[0m11:32:22.083432 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:32:22.083834 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:32:22.084067 [debug] [Thread-4  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:32:22.084352 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:32:22.084563 [info ] [Thread-4  ]: 5 of 7 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m11:32:22.084747 [info ] [Thread-1  ]: 6 of 7 START test unique_stg_customers_customer_id ............................. [RUN]
[0m11:32:22.085182 [debug] [Thread-4  ]: Acquiring new postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m11:32:22.085615 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:32:22.085799 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:32:22.085973 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:32:22.086139 [debug] [Thread-4  ]: Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:32:22.086301 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:32:22.097024 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m11:32:22.103952 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:32:22.104507 [debug] [Thread-4  ]: finished collecting timing info
[0m11:32:22.104687 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:32:22.104856 [debug] [Thread-1  ]: finished collecting timing info
[0m11:32:22.107074 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m11:32:22.107356 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:32:22.109652 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:32:22.110169 [debug] [Thread-4  ]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m11:32:22.110376 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:32:22.110497 [debug] [Thread-4  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m11:32:22.110658 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m11:32:22.110810 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:32:22.110962 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:32:22.239447 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m11:32:22.240272 [info ] [Thread-3  ]: 3 of 7 PASS not_null_stg_orders_customer_id .................................... [[32mPASS[0m in 4.13s]
[0m11:32:22.240711 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:32:22.240914 [debug] [Thread-3  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:32:22.241191 [info ] [Thread-3  ]: 7 of 7 START test unique_stg_orders_order_id ................................... [RUN]
[0m11:32:22.241879 [debug] [Thread-3  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:32:22.242116 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:32:22.242310 [debug] [Thread-3  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:32:22.246538 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:32:22.247154 [debug] [Thread-3  ]: finished collecting timing info
[0m11:32:22.247356 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:32:22.249476 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:32:22.249977 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:32:22.250137 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m11:32:22.250274 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:32:22.397565 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m11:32:22.398700 [info ] [Thread-2  ]: 2 of 7 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 4.29s]
[0m11:32:22.399313 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:32:25.734427 [debug] [Thread-4  ]: SQL status: BEGIN in 3.62 seconds
[0m11:32:25.735800 [debug] [Thread-4  ]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m11:32:25.736060 [debug] [Thread-4  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "rdw"."dbt_greg"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "rdw"."dbt_greg"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:32:25.892371 [debug] [Thread-1  ]: SQL status: BEGIN in 3.78 seconds
[0m11:32:25.892734 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:32:25.893041 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "rdw"."dbt_greg"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:32:26.050315 [debug] [Thread-3  ]: SQL status: BEGIN in 3.8 seconds
[0m11:32:26.050601 [debug] [Thread-3  ]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:32:26.050771 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "rdw"."dbt_greg"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:32:26.224418 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.49 seconds
[0m11:32:26.226282 [debug] [Thread-4  ]: finished collecting timing info
[0m11:32:26.226518 [debug] [Thread-4  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m11:32:26.374468 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.48 seconds
[0m11:32:26.376300 [debug] [Thread-1  ]: finished collecting timing info
[0m11:32:26.376540 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m11:32:26.524898 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.47 seconds
[0m11:32:26.526902 [debug] [Thread-3  ]: finished collecting timing info
[0m11:32:26.527128 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m11:32:26.684494 [debug] [Thread-4  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m11:32:26.685653 [info ] [Thread-4  ]: 5 of 7 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 4.60s]
[0m11:32:26.686267 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:32:26.842257 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m11:32:26.843177 [info ] [Thread-1  ]: 6 of 7 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 4.76s]
[0m11:32:26.843718 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:32:27.003846 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m11:32:27.004630 [info ] [Thread-3  ]: 7 of 7 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 4.76s]
[0m11:32:27.005212 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:32:27.006587 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:32:27.006827 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:27.006998 [debug] [MainThread]: On master: BEGIN
[0m11:32:27.007153 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:32:30.451051 [debug] [MainThread]: SQL status: BEGIN in 3.44 seconds
[0m11:32:30.451621 [debug] [MainThread]: On master: COMMIT
[0m11:32:30.451867 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:30.452080 [debug] [MainThread]: On master: COMMIT
[0m11:32:30.774453 [debug] [MainThread]: SQL status: COMMIT in 0.32 seconds
[0m11:32:30.774835 [debug] [MainThread]: On master: Close
[0m11:32:30.775759 [info ] [MainThread]: 
[0m11:32:30.776113 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 22.16 seconds (22.16s).
[0m11:32:30.776395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:30.776550 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m11:32:30.776696 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa' was properly closed.
[0m11:32:30.776908 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m11:32:30.777105 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m11:32:30.784637 [info ] [MainThread]: 
[0m11:32:30.784940 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:32:30.785224 [info ] [MainThread]: 
[0m11:32:30.785457 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m11:32:30.785765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb4acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcfedf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcd3760>]}


============================== 2022-07-27 11:36:19.990191 | a185421d-4dfb-47bf-a5e1-a88a8831c7d4 ==============================
[0m11:36:19.990347 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:36:19.996093 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m11:36:19.997704 [debug] [MainThread]: Tracking: tracking
[0m11:36:20.033047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee4ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee4f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee4f490>]}
[0m11:36:20.114463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:36:20.114884 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customers_model.md
[0m11:36:20.115342 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/schema.yml
[0m11:36:20.131189 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m11:36:20.181055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a185421d-4dfb-47bf-a5e1-a88a8831c7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0310d0>]}
[0m11:36:20.188402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a185421d-4dfb-47bf-a5e1-a88a8831c7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee4f040>]}
[0m11:36:20.188698 [info ] [MainThread]: Found 3 models, 9 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:36:20.188964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a185421d-4dfb-47bf-a5e1-a88a8831c7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed23c70>]}
[0m11:36:20.190573 [info ] [MainThread]: 
[0m11:36:20.191013 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:36:20.191745 [debug] [ThreadPool]: Acquiring new postgres connection "list_rdw_dbt_greg"
[0m11:36:20.201740 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m11:36:20.201960 [debug] [ThreadPool]: On list_rdw_dbt_greg: BEGIN
[0m11:36:20.202101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:23.245131 [debug] [ThreadPool]: SQL status: BEGIN in 3.04 seconds
[0m11:36:23.245492 [debug] [ThreadPool]: Using postgres connection "list_rdw_dbt_greg"
[0m11:36:23.245711 [debug] [ThreadPool]: On list_rdw_dbt_greg: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_rdw_dbt_greg"} */
select
      'rdw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_greg'
    union all
    select
      'rdw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_greg'
  
[0m11:36:23.569285 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.32 seconds
[0m11:36:23.571580 [debug] [ThreadPool]: On list_rdw_dbt_greg: ROLLBACK
[0m11:36:23.887728 [debug] [ThreadPool]: On list_rdw_dbt_greg: Close
[0m11:36:23.893122 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:23.893336 [debug] [MainThread]: On master: BEGIN
[0m11:36:23.893483 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:36:26.945237 [debug] [MainThread]: SQL status: BEGIN in 3.05 seconds
[0m11:36:26.945715 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:26.945957 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:36:28.514236 [debug] [MainThread]: SQL status: SELECT 1870 in 1.57 seconds
[0m11:36:28.593890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a185421d-4dfb-47bf-a5e1-a88a8831c7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee4f280>]}
[0m11:36:28.594272 [debug] [MainThread]: On master: ROLLBACK
[0m11:36:28.891356 [debug] [MainThread]: On master: Close
[0m11:36:28.892286 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:36:28.892709 [info ] [MainThread]: 
[0m11:36:28.898892 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
[0m11:36:28.899102 [debug] [Thread-2  ]: Began running node model.jaffle_shop.stg_orders
[0m11:36:28.899602 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_customers"
[0m11:36:28.900082 [debug] [Thread-2  ]: Acquiring new postgres connection "model.jaffle_shop.stg_orders"
[0m11:36:28.900322 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
[0m11:36:28.900508 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.stg_orders
[0m11:36:28.900711 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
[0m11:36:28.900876 [debug] [Thread-2  ]: Compiling model.jaffle_shop.stg_orders
[0m11:36:28.902794 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m11:36:28.904440 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m11:36:28.905386 [debug] [Thread-1  ]: finished collecting timing info
[0m11:36:28.905515 [debug] [Thread-2  ]: finished collecting timing info
[0m11:36:28.905709 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
[0m11:36:28.905894 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.stg_orders
[0m11:36:28.906080 [debug] [Thread-1  ]: finished collecting timing info
[0m11:36:28.906250 [debug] [Thread-2  ]: finished collecting timing info
[0m11:36:28.906741 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
[0m11:36:28.907187 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.stg_orders
[0m11:36:28.907674 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:36:28.907837 [debug] [Thread-2  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:36:28.908372 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m11:36:28.908665 [debug] [Thread-4  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:36:28.908802 [debug] [Thread-3  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:36:28.909141 [debug] [Thread-2  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:36:28.909511 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.customers"
[0m11:36:28.909695 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:36:28.910053 [debug] [Thread-3  ]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:36:28.910230 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:36:28.910399 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m11:36:28.910567 [debug] [Thread-4  ]: Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:36:28.910730 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:36:28.910888 [debug] [Thread-2  ]: Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:36:28.911060 [debug] [Thread-1  ]: Compiling model.jaffle_shop.customers
[0m11:36:28.925527 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:36:28.925734 [debug] [Thread-3  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:36:28.932873 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:36:28.935789 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m11:36:28.947358 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:36:28.947689 [debug] [Thread-4  ]: finished collecting timing info
[0m11:36:28.948299 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:36:28.948481 [debug] [Thread-2  ]: finished collecting timing info
[0m11:36:28.948658 [debug] [Thread-4  ]: finished collecting timing info
[0m11:36:28.948870 [debug] [Thread-1  ]: finished collecting timing info
[0m11:36:28.948992 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:36:28.949115 [debug] [Thread-3  ]: finished collecting timing info
[0m11:36:28.949599 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:36:28.949782 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m11:36:28.949947 [debug] [Thread-2  ]: finished collecting timing info
[0m11:36:28.950113 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:36:28.950305 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:36:28.950532 [debug] [Thread-1  ]: finished collecting timing info
[0m11:36:28.950931 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:36:28.951102 [debug] [Thread-3  ]: finished collecting timing info
[0m11:36:28.951401 [debug] [Thread-4  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:36:28.951838 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m11:36:28.952047 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:36:28.952515 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:36:28.952700 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:36:28.952903 [debug] [Thread-1  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:36:28.953391 [debug] [Thread-2  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:36:28.953602 [debug] [Thread-3  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:36:28.953815 [debug] [Thread-4  ]: Compiling test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:36:28.954108 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m11:36:28.954273 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:36:28.954584 [debug] [Thread-3  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:36:28.958575 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:36:28.958791 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:36:28.958959 [debug] [Thread-2  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:36:28.959124 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:36:28.959428 [debug] [Thread-1  ]: Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:36:28.963270 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:36:28.963468 [debug] [Thread-3  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:36:28.963582 [debug] [Thread-4  ]: finished collecting timing info
[0m11:36:28.972942 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m11:36:28.976443 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:36:28.976679 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:36:28.976895 [debug] [Thread-2  ]: finished collecting timing info
[0m11:36:28.977311 [debug] [Thread-4  ]: finished collecting timing info
[0m11:36:28.977567 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:36:28.977672 [debug] [Thread-1  ]: finished collecting timing info
[0m11:36:28.977835 [debug] [Thread-3  ]: finished collecting timing info
[0m11:36:28.978207 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:36:28.978445 [debug] [Thread-2  ]: finished collecting timing info
[0m11:36:28.978607 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:36:28.978758 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:36:28.978960 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m11:36:28.979398 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:36:28.979560 [debug] [Thread-1  ]: finished collecting timing info
[0m11:36:28.979706 [debug] [Thread-3  ]: finished collecting timing info
[0m11:36:28.979979 [debug] [Thread-4  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m11:36:28.980158 [debug] [Thread-2  ]: Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m11:36:28.980592 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:36:28.980989 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:36:28.981148 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m11:36:28.981424 [debug] [Thread-2  ]: Acquiring new postgres connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m11:36:28.981849 [debug] [Thread-4  ]: Compiling test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m11:36:28.982018 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m11:36:28.985566 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m11:36:28.985737 [debug] [Thread-2  ]: Compiling test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m11:36:28.989269 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m11:36:28.989659 [debug] [Thread-4  ]: finished collecting timing info
[0m11:36:28.989821 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m11:36:28.989972 [debug] [Thread-4  ]: finished collecting timing info
[0m11:36:28.990105 [debug] [Thread-2  ]: finished collecting timing info
[0m11:36:28.990466 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m11:36:28.990640 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m11:36:28.990972 [debug] [Thread-2  ]: finished collecting timing info
[0m11:36:28.991355 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m11:36:28.992212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:28.992382 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m11:36:28.992513 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m11:36:28.992649 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m11:36:28.992764 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m11:36:28.999405 [info ] [MainThread]: Done.
[0m11:36:29.002564 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
[0m11:36:29.002732 [info ] [MainThread]: Building catalog
[0m11:36:29.003940 [debug] [ThreadPool]: Acquiring new postgres connection "rdw.information_schema"
[0m11:36:29.011134 [debug] [ThreadPool]: Using postgres connection "rdw.information_schema"
[0m11:36:29.011326 [debug] [ThreadPool]: On rdw.information_schema: BEGIN
[0m11:36:29.011459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:32.083894 [debug] [ThreadPool]: SQL status: BEGIN in 3.07 seconds
[0m11:36:32.084174 [debug] [ThreadPool]: Using postgres connection "rdw.information_schema"
[0m11:36:32.084357 [debug] [ThreadPool]: On rdw.information_schema: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "rdw.information_schema"} */

    
    

    select
        'rdw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('dbt_greg'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m11:36:32.406768 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.32 seconds
[0m11:36:32.416749 [debug] [ThreadPool]: On rdw.information_schema: ROLLBACK
[0m11:36:32.724149 [debug] [ThreadPool]: On rdw.information_schema: Close
[0m11:36:32.734415 [info ] [MainThread]: Catalog written to /Users/gpeinke/jaffle_shop/target/catalog.json
[0m11:36:32.734810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee4ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f19ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f19a430>]}
[0m11:36:34.119233 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:36:34.119517 [debug] [MainThread]: Connection 'rdw.information_schema' was properly closed.


============================== 2022-07-27 11:36:40.533462 | 883eebe2-c680-4e57-ba66-34f52fb2eb62 ==============================
[0m11:36:40.533494 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:36:40.534272 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/gpeinke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m11:36:40.534606 [debug] [MainThread]: Tracking: tracking
[0m11:36:40.551130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a9ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a93d0>]}
[0m11:36:40.554372 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m11:36:40.554727 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m11:36:40.554965 [info ] [MainThread]: 
[0m11:36:40.555182 [info ] [MainThread]: 
[0m11:36:40.555379 [info ] [MainThread]: Press Ctrl+C to exit.
